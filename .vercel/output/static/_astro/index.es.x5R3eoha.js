import{u as q_,v as F_,w as z_,x as H_,y as B_,z as V_,A as k_,C as K_,D as G_,E as W_,F as Mo,G as qo,J as Fo,K as zo,L as Ho,M as oe,N as J_,O as rd,P as Bo,Q as nd,R as Q_,S as Vo,T as id,U as sd,V as ko,W as Y_,X as Hr,e as od,Y as X_,_ as Z_}from"./mint.Rz8Ab1_Y.js";import{e as Cr,$ as gu}from"./events.rtc_PtEz.js";import"./index.LFf77hJu.js";function yu(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function ad(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?yu(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function kc(i,t){t||(t=i.reduce((o,c)=>o+c.length,0));const r=ad(t);let s=0;for(const o of i)r.set(o,s),s+=o.length;return yu(r)}const Ah={...q_,...F_,...z_,...H_,...B_,...V_,...k_,...K_,...G_,...W_};function cd(i,t,r,s){return{name:i,prefix:t,encoder:{name:i,prefix:t,encode:r},decoder:{decode:s}}}const Ch=cd("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Sc=cd("ascii","a",i=>{let t="a";for(let r=0;r<i.length;r++)t+=String.fromCharCode(i[r]);return t},i=>{i=i.substring(1);const t=ad(i.length);for(let r=0;r<i.length;r++)t[r]=i.charCodeAt(r);return t}),ud={utf8:Ch,"utf-8":Ch,hex:Ah.base16,latin1:Sc,ascii:Sc,binary:Sc,...Ah};function ir(i,t="utf8"){const r=ud[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?yu(globalThis.Buffer.from(i,"utf-8")):r.decoder.decode(`${r.prefix}${i}`)}function Qt(i,t="utf8"){const r=ud[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):r.encoder.encode(i).substring(1)}var $h=function(i,t,r){if(r||arguments.length===2)for(var s=0,o=t.length,c;s<o;s++)(c||!(s in t))&&(c||(c=Array.prototype.slice.call(t,0,s)),c[s]=t[s]);return i.concat(c||Array.prototype.slice.call(t))},eb=function(){function i(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return i}(),tb=function(){function i(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return i}(),rb=function(){function i(t,r,s,o){this.name=t,this.version=r,this.os=s,this.bot=o,this.type="bot-device"}return i}(),nb=function(){function i(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return i}(),ib=function(){function i(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return i}(),sb=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,ob=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Dh=3,ab=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",sb]],Uh=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function cb(i){return i?jh(i):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new ib:typeof navigator<"u"?jh(navigator.userAgent):hb()}function ub(i){return i!==""&&ab.reduce(function(t,r){var s=r[0],o=r[1];if(t)return t;var c=o.exec(i);return!!c&&[s,c]},!1)}function jh(i){var t=ub(i);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new nb;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<Dh&&(o=$h($h([],o,!0),fb(Dh-o.length),!0)):o=[];var c=o.join("."),f=lb(i),v=ob.exec(i);return v&&v[1]?new rb(r,c,f,v[1]):new eb(r,c,f)}function lb(i){for(var t=0,r=Uh.length;t<r;t++){var s=Uh[t],o=s[0],c=s[1],f=c.exec(i);if(f)return o}return null}function hb(){var i=typeof process<"u"&&process.version;return i?new tb(process.version.slice(1)):null}function fb(i){for(var t=[],r=0;r<i;r++)t.push("0");return t}const db={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};var pb={};(function(i){const t=Fo,r=zo,s=Mo,o=qo,c=l=>l==null,f=Symbol("encodeFragmentIdentifier");function v(l){switch(l.arrayFormat){case"index":return p=>(_,m)=>{const y=_.length;return m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,[w(p,l),"[",y,"]"].join("")]:[..._,[w(p,l),"[",w(y,l),"]=",w(m,l)].join("")]};case"bracket":return p=>(_,m)=>m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,[w(p,l),"[]"].join("")]:[..._,[w(p,l),"[]=",w(m,l)].join("")];case"colon-list-separator":return p=>(_,m)=>m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,[w(p,l),":list="].join("")]:[..._,[w(p,l),":list=",w(m,l)].join("")];case"comma":case"separator":case"bracket-separator":{const p=l.arrayFormat==="bracket-separator"?"[]=":"=";return _=>(m,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?m:(y=y===null?"":y,m.length===0?[[w(_,l),p,w(y,l)].join("")]:[[m,w(y,l)].join(l.arrayFormatSeparator)])}default:return p=>(_,m)=>m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,w(p,l)]:[..._,[w(p,l),"=",w(m,l)].join("")]}}function O(l){let p;switch(l.arrayFormat){case"index":return(_,m,y)=>{if(p=/\[(\d*)\]$/.exec(_),_=_.replace(/\[\d*\]$/,""),!p){y[_]=m;return}y[_]===void 0&&(y[_]={}),y[_][p[1]]=m};case"bracket":return(_,m,y)=>{if(p=/(\[\])$/.exec(_),_=_.replace(/\[\]$/,""),!p){y[_]=m;return}if(y[_]===void 0){y[_]=[m];return}y[_]=[].concat(y[_],m)};case"colon-list-separator":return(_,m,y)=>{if(p=/(:list)$/.exec(_),_=_.replace(/:list$/,""),!p){y[_]=m;return}if(y[_]===void 0){y[_]=[m];return}y[_]=[].concat(y[_],m)};case"comma":case"separator":return(_,m,y)=>{const N=typeof m=="string"&&m.includes(l.arrayFormatSeparator),x=typeof m=="string"&&!N&&T(m,l).includes(l.arrayFormatSeparator);m=x?T(m,l):m;const Q=N||x?m.split(l.arrayFormatSeparator).map(se=>T(se,l)):m===null?m:T(m,l);y[_]=Q};case"bracket-separator":return(_,m,y)=>{const N=/(\[\])$/.test(_);if(_=_.replace(/\[\]$/,""),!N){y[_]=m&&T(m,l);return}const x=m===null?[]:m.split(l.arrayFormatSeparator).map(Q=>T(Q,l));if(y[_]===void 0){y[_]=x;return}y[_]=[].concat(y[_],x)};default:return(_,m,y)=>{if(y[_]===void 0){y[_]=m;return}y[_]=[].concat(y[_],m)}}}function g(l){if(typeof l!="string"||l.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function w(l,p){return p.encode?p.strict?t(l):encodeURIComponent(l):l}function T(l,p){return p.decode?r(l):l}function A(l){return Array.isArray(l)?l.sort():typeof l=="object"?A(Object.keys(l)).sort((p,_)=>Number(p)-Number(_)).map(p=>l[p]):l}function q(l){const p=l.indexOf("#");return p!==-1&&(l=l.slice(0,p)),l}function L(l){let p="";const _=l.indexOf("#");return _!==-1&&(p=l.slice(_)),p}function K(l){l=q(l);const p=l.indexOf("?");return p===-1?"":l.slice(p+1)}function te(l,p){return p.parseNumbers&&!Number.isNaN(Number(l))&&typeof l=="string"&&l.trim()!==""?l=Number(l):p.parseBooleans&&l!==null&&(l.toLowerCase()==="true"||l.toLowerCase()==="false")&&(l=l.toLowerCase()==="true"),l}function ue(l,p){p=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},p),g(p.arrayFormatSeparator);const _=O(p),m=Object.create(null);if(typeof l!="string"||(l=l.trim().replace(/^[?#&]/,""),!l))return m;for(const y of l.split("&")){if(y==="")continue;let[N,x]=s(p.decode?y.replace(/\+/g," "):y,"=");x=x===void 0?null:["comma","separator","bracket-separator"].includes(p.arrayFormat)?x:T(x,p),_(T(N,p),x,m)}for(const y of Object.keys(m)){const N=m[y];if(typeof N=="object"&&N!==null)for(const x of Object.keys(N))N[x]=te(N[x],p);else m[y]=te(N,p)}return p.sort===!1?m:(p.sort===!0?Object.keys(m).sort():Object.keys(m).sort(p.sort)).reduce((y,N)=>{const x=m[N];return x&&typeof x=="object"&&!Array.isArray(x)?y[N]=A(x):y[N]=x,y},Object.create(null))}i.extract=K,i.parse=ue,i.stringify=(l,p)=>{if(!l)return"";p=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},p),g(p.arrayFormatSeparator);const _=x=>p.skipNull&&c(l[x])||p.skipEmptyString&&l[x]==="",m=v(p),y={};for(const x of Object.keys(l))_(x)||(y[x]=l[x]);const N=Object.keys(y);return p.sort!==!1&&N.sort(p.sort),N.map(x=>{const Q=l[x];return Q===void 0?"":Q===null?w(x,p):Array.isArray(Q)?Q.length===0&&p.arrayFormat==="bracket-separator"?w(x,p)+"[]":Q.reduce(m(x),[]).join("&"):w(x,p)+"="+w(Q,p)}).filter(x=>x.length>0).join("&")},i.parseUrl=(l,p)=>{p=Object.assign({decode:!0},p);const[_,m]=s(l,"#");return Object.assign({url:_.split("?")[0]||"",query:ue(K(l),p)},p&&p.parseFragmentIdentifier&&m?{fragmentIdentifier:T(m,p)}:{})},i.stringifyUrl=(l,p)=>{p=Object.assign({encode:!0,strict:!0,[f]:!0},p);const _=q(l.url).split("?")[0]||"",m=i.extract(l.url),y=i.parse(m,{sort:!1}),N=Object.assign(y,l.query);let x=i.stringify(N,p);x&&(x=`?${x}`);let Q=L(l.url);return l.fragmentIdentifier&&(Q=`#${p[f]?w(l.fragmentIdentifier,p):l.fragmentIdentifier}`),`${_}${x}${Q}`},i.pick=(l,p,_)=>{_=Object.assign({parseFragmentIdentifier:!0,[f]:!1},_);const{url:m,query:y,fragmentIdentifier:N}=i.parseUrl(l,_);return i.stringifyUrl({url:m,query:o(y,p),fragmentIdentifier:N},_)},i.exclude=(l,p,_)=>{const m=Array.isArray(p)?y=>!p.includes(y):(y,N)=>!p(y,N);return i.pick(l,m,_)}})(pb);function gb(i,t=[]){const r=[];return Object.keys(i).forEach(s=>{if(t.length&&!t.includes(s))return;const o=i[s];r.push(...o.accounts)}),r}const yb={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function mb(i,t){const{message:r,code:s}=yb[i];return{message:t?`${r} ${t}`:r,code:s}}function Kc(i,t){return Array.isArray(i)?typeof t<"u"&&i.length?i.every(t):!0:!1}const vb=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,_b=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,bb=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function wb(i,t){if(i==="__proto__"||i==="constructor"&&t&&typeof t=="object"&&"prototype"in t){Eb(i);return}return t}function Eb(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function wo(i,t={}){if(typeof i!="string")return i;const r=i.trim();if(i[0]==='"'&&i.at(-1)==='"'&&!i.includes("\\"))return r.slice(1,-1);if(r.length<=9){const s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!bb.test(i)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(vb.test(i)||_b.test(i)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,wb)}return JSON.parse(i)}catch(s){if(t.strict)throw s;return i}}function Ib(i){return!i||typeof i.then!="function"?Promise.resolve(i):i}function Ft(i,...t){try{return Ib(i(...t))}catch(r){return Promise.reject(r)}}function Sb(i){const t=typeof i;return i===null||t!=="object"&&t!=="function"}function Ob(i){const t=Object.getPrototypeOf(i);return!t||t.isPrototypeOf(Object)}function Po(i){if(Sb(i))return String(i);if(Ob(i)||Array.isArray(i))return JSON.stringify(i);if(typeof i.toJSON=="function")return Po(i.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function ld(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Gc="base64:";function xb(i){if(typeof i=="string")return i;ld();const t=Buffer.from(i).toString("base64");return Gc+t}function Pb(i){return typeof i!="string"||!i.startsWith(Gc)?i:(ld(),Buffer.from(i.slice(Gc.length),"base64"))}function dr(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Tb(...i){return dr(i.join(":"))}function Eo(i){return i=dr(i),i?i+":":""}const Nb="memory",Rb=()=>{const i=new Map;return{name:Nb,options:{},hasItem(t){return i.has(t)},getItem(t){return i.get(t)??null},getItemRaw(t){return i.get(t)??null},setItem(t,r){i.set(t,r)},setItemRaw(t,r){i.set(t,r)},removeItem(t){i.delete(t)},getKeys(){return Array.from(i.keys())},clear(){i.clear()},dispose(){i.clear()}}};function Ab(i={}){const t={mounts:{"":i.driver||Rb()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=g=>{for(const w of t.mountpoints)if(g.startsWith(w))return{base:w,relativeKey:g.slice(w.length),driver:t.mounts[w]};return{base:"",relativeKey:g,driver:t.mounts[""]}},s=(g,w)=>t.mountpoints.filter(T=>T.startsWith(g)||w&&g.startsWith(T)).map(T=>({relativeBase:g.length>T.length?g.slice(T.length):void 0,mountpoint:T,driver:t.mounts[T]})),o=(g,w)=>{if(t.watching){w=dr(w);for(const T of t.watchListeners)T(g,w)}},c=async()=>{if(!t.watching){t.watching=!0;for(const g in t.mounts)t.unwatch[g]=await Lh(t.mounts[g],o,g)}},f=async()=>{if(t.watching){for(const g in t.unwatch)await t.unwatch[g]();t.unwatch={},t.watching=!1}},v=(g,w,T)=>{const A=new Map,q=L=>{let K=A.get(L.base);return K||(K={driver:L.driver,base:L.base,items:[]},A.set(L.base,K)),K};for(const L of g){const K=typeof L=="string",te=dr(K?L:L.key),ue=K?void 0:L.value,l=K||!L.options?w:{...w,...L.options},p=r(te);q(p).items.push({key:te,value:ue,relativeKey:p.relativeKey,options:l})}return Promise.all([...A.values()].map(L=>T(L))).then(L=>L.flat())},O={hasItem(g,w={}){g=dr(g);const{relativeKey:T,driver:A}=r(g);return Ft(A.hasItem,T,w)},getItem(g,w={}){g=dr(g);const{relativeKey:T,driver:A}=r(g);return Ft(A.getItem,T,w).then(q=>wo(q))},getItems(g,w){return v(g,w,T=>T.driver.getItems?Ft(T.driver.getItems,T.items.map(A=>({key:A.relativeKey,options:A.options})),w).then(A=>A.map(q=>({key:Tb(T.base,q.key),value:wo(q.value)}))):Promise.all(T.items.map(A=>Ft(T.driver.getItem,A.relativeKey,A.options).then(q=>({key:A.key,value:wo(q)})))))},getItemRaw(g,w={}){g=dr(g);const{relativeKey:T,driver:A}=r(g);return A.getItemRaw?Ft(A.getItemRaw,T,w):Ft(A.getItem,T,w).then(q=>Pb(q))},async setItem(g,w,T={}){if(w===void 0)return O.removeItem(g);g=dr(g);const{relativeKey:A,driver:q}=r(g);q.setItem&&(await Ft(q.setItem,A,Po(w),T),q.watch||o("update",g))},async setItems(g,w){await v(g,w,async T=>{T.driver.setItems&&await Ft(T.driver.setItems,T.items.map(A=>({key:A.relativeKey,value:Po(A.value),options:A.options})),w),T.driver.setItem&&await Promise.all(T.items.map(A=>Ft(T.driver.setItem,A.relativeKey,Po(A.value),A.options)))})},async setItemRaw(g,w,T={}){if(w===void 0)return O.removeItem(g,T);g=dr(g);const{relativeKey:A,driver:q}=r(g);if(q.setItemRaw)await Ft(q.setItemRaw,A,w,T);else if(q.setItem)await Ft(q.setItem,A,xb(w),T);else return;q.watch||o("update",g)},async removeItem(g,w={}){typeof w=="boolean"&&(w={removeMeta:w}),g=dr(g);const{relativeKey:T,driver:A}=r(g);A.removeItem&&(await Ft(A.removeItem,T,w),(w.removeMeta||w.removeMata)&&await Ft(A.removeItem,T+"$",w),A.watch||o("remove",g))},async getMeta(g,w={}){typeof w=="boolean"&&(w={nativeOnly:w}),g=dr(g);const{relativeKey:T,driver:A}=r(g),q=Object.create(null);if(A.getMeta&&Object.assign(q,await Ft(A.getMeta,T,w)),!w.nativeOnly){const L=await Ft(A.getItem,T+"$",w).then(K=>wo(K));L&&typeof L=="object"&&(typeof L.atime=="string"&&(L.atime=new Date(L.atime)),typeof L.mtime=="string"&&(L.mtime=new Date(L.mtime)),Object.assign(q,L))}return q},setMeta(g,w,T={}){return this.setItem(g+"$",w,T)},removeMeta(g,w={}){return this.removeItem(g+"$",w)},async getKeys(g,w={}){g=Eo(g);const T=s(g,!0);let A=[];const q=[];for(const L of T){const te=(await Ft(L.driver.getKeys,L.relativeBase,w)).map(ue=>L.mountpoint+dr(ue)).filter(ue=>!A.some(l=>ue.startsWith(l)));q.push(...te),A=[L.mountpoint,...A.filter(ue=>!ue.startsWith(L.mountpoint))]}return g?q.filter(L=>L.startsWith(g)&&!L.endsWith("$")):q.filter(L=>!L.endsWith("$"))},async clear(g,w={}){g=Eo(g),await Promise.all(s(g,!1).map(async T=>{if(T.driver.clear)return Ft(T.driver.clear,T.relativeBase,w);if(T.driver.removeItem){const A=await T.driver.getKeys(T.relativeBase||"",w);return Promise.all(A.map(q=>T.driver.removeItem(q,w)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(g=>Mh(g)))},async watch(g){return await c(),t.watchListeners.push(g),async()=>{t.watchListeners=t.watchListeners.filter(w=>w!==g),t.watchListeners.length===0&&await f()}},async unwatch(){t.watchListeners=[],await f()},mount(g,w){if(g=Eo(g),g&&t.mounts[g])throw new Error(`already mounted at ${g}`);return g&&(t.mountpoints.push(g),t.mountpoints.sort((T,A)=>A.length-T.length)),t.mounts[g]=w,t.watching&&Promise.resolve(Lh(w,o,g)).then(T=>{t.unwatch[g]=T}).catch(console.error),O},async unmount(g,w=!0){g=Eo(g),!(!g||!t.mounts[g])&&(t.watching&&g in t.unwatch&&(t.unwatch[g](),delete t.unwatch[g]),w&&await Mh(t.mounts[g]),t.mountpoints=t.mountpoints.filter(T=>T!==g),delete t.mounts[g])},getMount(g=""){g=dr(g)+":";const w=r(g);return{driver:w.driver,base:w.base}},getMounts(g="",w={}){return g=dr(g),s(g,w.parents).map(A=>({driver:A.driver,base:A.mountpoint}))}};return O}function Lh(i,t,r){return i.watch?i.watch((s,o)=>t(s,r+o)):()=>{}}async function Mh(i){typeof i.dispose=="function"&&await Ft(i.dispose)}function Yn(i){return new Promise((t,r)=>{i.oncomplete=i.onsuccess=()=>t(i.result),i.onabort=i.onerror=()=>r(i.error)})}function hd(i,t){const r=indexedDB.open(i);r.onupgradeneeded=()=>r.result.createObjectStore(t);const s=Yn(r);return(o,c)=>s.then(f=>c(f.transaction(t,o).objectStore(t)))}let Oc;function fs(){return Oc||(Oc=hd("keyval-store","keyval")),Oc}function qh(i,t=fs()){return t("readonly",r=>Yn(r.get(i)))}function Cb(i,t,r=fs()){return r("readwrite",s=>(s.put(t,i),Yn(s.transaction)))}function $b(i,t=fs()){return t("readwrite",r=>(r.delete(i),Yn(r.transaction)))}function Db(i=fs()){return i("readwrite",t=>(t.clear(),Yn(t.transaction)))}function Ub(i,t){return i.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Yn(i.transaction)}function jb(i=fs()){return i("readonly",t=>{if(t.getAllKeys)return Yn(t.getAllKeys());const r=[];return Ub(t,s=>r.push(s.key)).then(()=>r)})}const Lb=i=>JSON.stringify(i,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Mb=i=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=i.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function ds(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return Mb(i)}catch{return i}}function Qn(i){return typeof i=="string"?i:Lb(i)||""}const qb="idb-keyval";var Fb=(i={})=>{const t=i.base&&i.base.length>0?`${i.base}:`:"",r=o=>t+o;let s;return i.dbName&&i.storeName&&(s=hd(i.dbName,i.storeName)),{name:qb,options:i,async hasItem(o){return!(typeof await qh(r(o),s)>"u")},async getItem(o){return await qh(r(o),s)??null},setItem(o,c){return Cb(r(o),c,s)},removeItem(o){return $b(r(o),s)},getKeys(){return jb(s)},clear(){return Db(s)}}};const zb="WALLET_CONNECT_V2_INDEXED_DB",Hb="keyvaluestorage";let Bb=class{constructor(){this.indexedDb=Ab({driver:Fb({dbName:zb,storeName:Hb})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Qn(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var xc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},To={exports:{}};(function(){let i;function t(){}i=t,i.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},i.prototype.setItem=function(r,s){this[r]=String(s)},i.prototype.removeItem=function(r){delete this[r]},i.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},i.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof xc<"u"&&xc.localStorage?To.exports=xc.localStorage:typeof window<"u"&&window.localStorage?To.exports=window.localStorage:To.exports=new t})();function Vb(i){var t;return[i[0],ds((t=i[1])!=null?t:"")]}let kb=class{constructor(){this.localStorage=To.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Vb)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return ds(r)}async setItem(t,r){this.localStorage.setItem(t,Qn(r))}async removeItem(t){this.localStorage.removeItem(t)}};const Kb="wc_storage_version",Fh=1,Gb=async(i,t,r)=>{const s=Kb,o=await t.getItem(s);if(o&&o>=Fh){r(t);return}const c=await i.getKeys();if(!c.length){r(t);return}const f=[];for(;c.length;){const v=c.shift();if(!v)continue;const O=v.toLowerCase();if(O.includes("wc@")||O.includes("walletconnect")||O.includes("wc_")||O.includes("wallet_connect")){const g=await i.getItem(v);await t.setItem(v,g),f.push(v)}}await t.setItem(s,Fh),r(t),Wb(i,f)},Wb=async(i,t)=>{t.length&&t.forEach(async r=>{await i.removeItem(r)})};let Jb=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new kb;this.storage=t;try{const r=new Bb;Gb(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var Si={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Wc=function(i,t){return Wc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)s.hasOwnProperty(o)&&(r[o]=s[o])},Wc(i,t)};function Qb(i,t){Wc(i,t);function r(){this.constructor=i}i.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Jc=function(){return Jc=Object.assign||function(t){for(var r,s=1,o=arguments.length;s<o;s++){r=arguments[s];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},Jc.apply(this,arguments)};function Yb(i,t){var r={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&t.indexOf(s)<0&&(r[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(r[s[o]]=i[s[o]]);return r}function Xb(i,t,r,s){var o=arguments.length,c=o<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,t,r,s);else for(var v=i.length-1;v>=0;v--)(f=i[v])&&(c=(o<3?f(c):o>3?f(t,r,c):f(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c}function Zb(i,t){return function(r,s){t(r,s,i)}}function ew(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)}function tw(i,t,r,s){function o(c){return c instanceof r?c:new r(function(f){f(c)})}return new(r||(r=Promise))(function(c,f){function v(w){try{g(s.next(w))}catch(T){f(T)}}function O(w){try{g(s.throw(w))}catch(T){f(T)}}function g(w){w.done?c(w.value):o(w.value).then(v,O)}g((s=s.apply(i,t||[])).next())})}function rw(i,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,f;return f={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function v(g){return function(w){return O([g,w])}}function O(g){if(s)throw new TypeError("Generator is already executing.");for(;r;)try{if(s=1,o&&(c=g[0]&2?o.return:g[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,g[1])).done)return c;switch(o=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,o=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){r=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){r.label=g[1];break}if(g[0]===6&&r.label<c[1]){r.label=c[1],c=g;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(g);break}c[2]&&r.ops.pop(),r.trys.pop();continue}g=t.call(i,r)}catch(w){g=[6,w],o=0}finally{s=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function nw(i,t,r,s){s===void 0&&(s=r),i[s]=t[r]}function iw(i,t){for(var r in i)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=i[r])}function Qc(i){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&i[t],s=0;if(r)return r.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function fd(i,t){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var s=r.call(i),o,c=[],f;try{for(;(t===void 0||t-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(v){f={error:v}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(f)throw f.error}}return c}function sw(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(fd(arguments[t]));return i}function ow(){for(var i=0,t=0,r=arguments.length;t<r;t++)i+=arguments[t].length;for(var s=Array(i),o=0,t=0;t<r;t++)for(var c=arguments[t],f=0,v=c.length;f<v;f++,o++)s[o]=c[f];return s}function as(i){return this instanceof as?(this.v=i,this):new as(i)}function aw(i,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(i,t||[]),o,c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(A){s[A]&&(o[A]=function(q){return new Promise(function(L,K){c.push([A,q,L,K])>1||v(A,q)})})}function v(A,q){try{O(s[A](q))}catch(L){T(c[0][3],L)}}function O(A){A.value instanceof as?Promise.resolve(A.value.v).then(g,w):T(c[0][2],A)}function g(A){v("next",A)}function w(A){v("throw",A)}function T(A,q){A(q),c.shift(),c.length&&v(c[0][0],c[0][1])}}function cw(i){var t,r;return t={},s("next"),s("throw",function(o){throw o}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(o,c){t[o]=i[o]?function(f){return(r=!r)?{value:as(i[o](f)),done:o==="return"}:c?c(f):f}:c}}function uw(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],r;return t?t.call(i):(i=typeof Qc=="function"?Qc(i):i[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(c){r[c]=i[c]&&function(f){return new Promise(function(v,O){f=i[c](f),o(v,O,f.done,f.value)})}}function o(c,f,v,O){Promise.resolve(O).then(function(g){c({value:g,done:v})},f)}}function lw(i,t){return Object.defineProperty?Object.defineProperty(i,"raw",{value:t}):i.raw=t,i}function hw(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var r in i)Object.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t.default=i,t}function fw(i){return i&&i.__esModule?i:{default:i}}function dw(i,t){if(!t.has(i))throw new TypeError("attempted to get private field on non-instance");return t.get(i)}function pw(i,t,r){if(!t.has(i))throw new TypeError("attempted to set private field on non-instance");return t.set(i,r),r}const gw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Jc},__asyncDelegator:cw,__asyncGenerator:aw,__asyncValues:uw,__await:as,__awaiter:tw,__classPrivateFieldGet:dw,__classPrivateFieldSet:pw,__createBinding:nw,__decorate:Xb,__exportStar:iw,__extends:Qb,__generator:rw,__importDefault:fw,__importStar:hw,__makeTemplateObject:lw,__metadata:ew,__param:Zb,__read:fd,__rest:Yb,__spread:sw,__spreadArrays:ow,__values:Qc},Symbol.toStringTag,{value:"Module"})),Ko=Ho(gw);var Gi={},Pc={},Wi={};let Xn=class{};const yw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Xn},Symbol.toStringTag,{value:"Module"})),mw=Ho(yw);var zh;function vw(){if(zh)return Wi;zh=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.IHeartBeat=void 0;const i=mw;class t extends i.IEvents{constructor(s){super()}}return Wi.IHeartBeat=t,Wi}var Hh;function dd(){return Hh||(Hh=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ko.__exportStar(vw(),i)}(Pc)),Pc}var Tc={},Kn={},Bh;function _w(){if(Bh)return Kn;Bh=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.HEARTBEAT_EVENTS=Kn.HEARTBEAT_INTERVAL=void 0;const i=oe;return Kn.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,Kn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Kn}var Vh;function pd(){return Vh||(Vh=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ko.__exportStar(_w(),i)}(Tc)),Tc}var kh;function bw(){if(kh)return Gi;kh=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.HeartBeat=void 0;const i=Ko,t=Cr,r=oe,s=dd(),o=pd();class c extends s.IHeartBeat{constructor(v){super(v),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=v?.interval||o.HEARTBEAT_INTERVAL}static init(v){return i.__awaiter(this,void 0,void 0,function*(){const O=new c(v);return yield O.init(),O})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(v,O){this.events.on(v,O)}once(v,O){this.events.once(v,O)}off(v,O){this.events.off(v,O)}removeListener(v,O){this.events.removeListener(v,O)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Gi.HeartBeat=c,Gi}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=Ko;t.__exportStar(bw(),i),t.__exportStar(dd(),i),t.__exportStar(pd(),i)})(Si);var Re={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Yc=function(i,t){return Yc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)s.hasOwnProperty(o)&&(r[o]=s[o])},Yc(i,t)};function ww(i,t){Yc(i,t);function r(){this.constructor=i}i.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Xc=function(){return Xc=Object.assign||function(t){for(var r,s=1,o=arguments.length;s<o;s++){r=arguments[s];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},Xc.apply(this,arguments)};function Ew(i,t){var r={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&t.indexOf(s)<0&&(r[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(r[s[o]]=i[s[o]]);return r}function Iw(i,t,r,s){var o=arguments.length,c=o<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,t,r,s);else for(var v=i.length-1;v>=0;v--)(f=i[v])&&(c=(o<3?f(c):o>3?f(t,r,c):f(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c}function Sw(i,t){return function(r,s){t(r,s,i)}}function Ow(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)}function xw(i,t,r,s){function o(c){return c instanceof r?c:new r(function(f){f(c)})}return new(r||(r=Promise))(function(c,f){function v(w){try{g(s.next(w))}catch(T){f(T)}}function O(w){try{g(s.throw(w))}catch(T){f(T)}}function g(w){w.done?c(w.value):o(w.value).then(v,O)}g((s=s.apply(i,t||[])).next())})}function Pw(i,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,f;return f={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function v(g){return function(w){return O([g,w])}}function O(g){if(s)throw new TypeError("Generator is already executing.");for(;r;)try{if(s=1,o&&(c=g[0]&2?o.return:g[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,g[1])).done)return c;switch(o=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,o=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){r=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){r.label=g[1];break}if(g[0]===6&&r.label<c[1]){r.label=c[1],c=g;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(g);break}c[2]&&r.ops.pop(),r.trys.pop();continue}g=t.call(i,r)}catch(w){g=[6,w],o=0}finally{s=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function Tw(i,t,r,s){s===void 0&&(s=r),i[s]=t[r]}function Nw(i,t){for(var r in i)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=i[r])}function Zc(i){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&i[t],s=0;if(r)return r.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function gd(i,t){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var s=r.call(i),o,c=[],f;try{for(;(t===void 0||t-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(v){f={error:v}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(f)throw f.error}}return c}function Rw(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(gd(arguments[t]));return i}function Aw(){for(var i=0,t=0,r=arguments.length;t<r;t++)i+=arguments[t].length;for(var s=Array(i),o=0,t=0;t<r;t++)for(var c=arguments[t],f=0,v=c.length;f<v;f++,o++)s[o]=c[f];return s}function cs(i){return this instanceof cs?(this.v=i,this):new cs(i)}function Cw(i,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(i,t||[]),o,c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(A){s[A]&&(o[A]=function(q){return new Promise(function(L,K){c.push([A,q,L,K])>1||v(A,q)})})}function v(A,q){try{O(s[A](q))}catch(L){T(c[0][3],L)}}function O(A){A.value instanceof cs?Promise.resolve(A.value.v).then(g,w):T(c[0][2],A)}function g(A){v("next",A)}function w(A){v("throw",A)}function T(A,q){A(q),c.shift(),c.length&&v(c[0][0],c[0][1])}}function $w(i){var t,r;return t={},s("next"),s("throw",function(o){throw o}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(o,c){t[o]=i[o]?function(f){return(r=!r)?{value:cs(i[o](f)),done:o==="return"}:c?c(f):f}:c}}function Dw(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],r;return t?t.call(i):(i=typeof Zc=="function"?Zc(i):i[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(c){r[c]=i[c]&&function(f){return new Promise(function(v,O){f=i[c](f),o(v,O,f.done,f.value)})}}function o(c,f,v,O){Promise.resolve(O).then(function(g){c({value:g,done:v})},f)}}function Uw(i,t){return Object.defineProperty?Object.defineProperty(i,"raw",{value:t}):i.raw=t,i}function jw(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var r in i)Object.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t.default=i,t}function Lw(i){return i&&i.__esModule?i:{default:i}}function Mw(i,t){if(!t.has(i))throw new TypeError("attempted to get private field on non-instance");return t.get(i)}function qw(i,t,r){if(!t.has(i))throw new TypeError("attempted to set private field on non-instance");return t.set(i,r),r}const Fw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Xc},__asyncDelegator:$w,__asyncGenerator:Cw,__asyncValues:Dw,__await:cs,__awaiter:xw,__classPrivateFieldGet:Mw,__classPrivateFieldSet:qw,__createBinding:Tw,__decorate:Iw,__exportStar:Nw,__extends:ww,__generator:Pw,__importDefault:Lw,__importStar:jw,__makeTemplateObject:Uw,__metadata:Ow,__param:Sw,__read:gd,__rest:Ew,__spread:Rw,__spreadArrays:Aw,__values:Zc},Symbol.toStringTag,{value:"Module"})),zw=Ho(Fw);var Nc,Kh;function Hw(){if(Kh)return Nc;Kh=1;function i(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Nc=t;function t(r,s,o){var c=o&&o.stringify||i,f=1;if(typeof r=="object"&&r!==null){var v=s.length+f;if(v===1)return r;var O=new Array(v);O[0]=c(r);for(var g=1;g<v;g++)O[g]=c(s[g]);return O.join(" ")}if(typeof r!="string")return r;var w=s.length;if(w===0)return r;for(var T="",A=1-f,q=-1,L=r&&r.length||0,K=0;K<L;){if(r.charCodeAt(K)===37&&K+1<L){switch(q=q>-1?q:0,r.charCodeAt(K+1)){case 100:case 102:if(A>=w||s[A]==null)break;q<K&&(T+=r.slice(q,K)),T+=Number(s[A]),q=K+2,K++;break;case 105:if(A>=w||s[A]==null)break;q<K&&(T+=r.slice(q,K)),T+=Math.floor(Number(s[A])),q=K+2,K++;break;case 79:case 111:case 106:if(A>=w||s[A]===void 0)break;q<K&&(T+=r.slice(q,K));var te=typeof s[A];if(te==="string"){T+="'"+s[A]+"'",q=K+2,K++;break}if(te==="function"){T+=s[A].name||"<anonymous>",q=K+2,K++;break}T+=c(s[A]),q=K+2,K++;break;case 115:if(A>=w)break;q<K&&(T+=r.slice(q,K)),T+=String(s[A]),q=K+2,K++;break;case 37:q<K&&(T+=r.slice(q,K)),T+="%",q=K+2,K++,A--;break}++A}++K}return q===-1?r:(q<L&&(T+=r.slice(q)),T)}return Nc}var Rc,Gh;function Bw(){if(Gh)return Rc;Gh=1;const i=Hw();Rc=o;const t=m().console||{},r={mapHttpRequest:L,mapHttpResponse:L,wrapRequestSerializer:K,wrapResponseSerializer:K,wrapErrorSerializer:K,req:L,res:L,err:A};function s(y,N){return Array.isArray(y)?y.filter(function(Q){return Q!=="!stdSerializers.err"}):y===!0?Object.keys(N):!1}function o(y){y=y||{},y.browser=y.browser||{};const N=y.browser.transmit;if(N&&typeof N.send!="function")throw Error("pino: transmit option must have a send function");const x=y.browser.write||t;y.browser.write&&(y.browser.asObject=!0);const Q=y.serializers||{},se=s(y.browser.serialize,Q);let pe=y.browser.serialize;Array.isArray(y.browser.serialize)&&y.browser.serialize.indexOf("!stdSerializers.err")>-1&&(pe=!1);const Ae=["error","fatal","warn","info","debug","trace"];typeof x=="function"&&(x.error=x.fatal=x.warn=x.info=x.debug=x.trace=x),y.enabled===!1&&(y.level="silent");const Fe=y.level||"info",S=Object.create(x);S.log||(S.log=te),Object.defineProperty(S,"levelVal",{get:ne}),Object.defineProperty(S,"level",{get:de,set:X});const $={transmit:N,serialize:se,asObject:y.browser.asObject,levels:Ae,timestamp:q(y)};S.levels=o.levels,S.level=Fe,S.setMaxListeners=S.getMaxListeners=S.emit=S.addListener=S.on=S.prependListener=S.once=S.prependOnceListener=S.removeListener=S.removeAllListeners=S.listeners=S.listenerCount=S.eventNames=S.write=S.flush=te,S.serializers=Q,S._serialize=se,S._stdErrSerialize=pe,S.child=W,N&&(S._logEvent=T());function ne(){return this.level==="silent"?1/0:this.levels.values[this.level]}function de(){return this._level}function X(Y){if(Y!=="silent"&&!this.levels.values[Y])throw Error("unknown level "+Y);this._level=Y,c($,S,"error","log"),c($,S,"fatal","error"),c($,S,"warn","error"),c($,S,"info","log"),c($,S,"debug","log"),c($,S,"trace","log")}function W(Y,Z){if(!Y)throw new Error("missing bindings for child Pino");Z=Z||{},se&&Y.serializers&&(Z.serializers=Y.serializers);const Qe=Z.serializers;if(se&&Qe){var Ve=Object.assign({},Q,Qe),Vr=y.browser.serialize===!0?Object.keys(Ve):se;delete Y.serializers,O([Y],Vr,Ve,this._stdErrSerialize)}function Ie(St){this._childLevel=(St._childLevel|0)+1,this.error=g(St,Y,"error"),this.fatal=g(St,Y,"fatal"),this.warn=g(St,Y,"warn"),this.info=g(St,Y,"info"),this.debug=g(St,Y,"debug"),this.trace=g(St,Y,"trace"),Ve&&(this.serializers=Ve,this._serialize=Vr),N&&(this._logEvent=T([].concat(St._logEvent.bindings,Y)))}return Ie.prototype=this,new Ie(this)}return S}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:ue,epochTime:l,unixTime:p,isoTime:_});function c(y,N,x,Q){const se=Object.getPrototypeOf(N);N[x]=N.levelVal>N.levels.values[x]?te:se[x]?se[x]:t[x]||t[Q]||te,f(y,N,x)}function f(y,N,x){!y.transmit&&N[x]===te||(N[x]=function(Q){return function(){const pe=y.timestamp(),Ae=new Array(arguments.length),Fe=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var S=0;S<Ae.length;S++)Ae[S]=arguments[S];if(y.serialize&&!y.asObject&&O(Ae,this._serialize,this.serializers,this._stdErrSerialize),y.asObject?Q.call(Fe,v(this,x,Ae,pe)):Q.apply(Fe,Ae),y.transmit){const $=y.transmit.level||N.level,ne=o.levels.values[$],de=o.levels.values[x];if(de<ne)return;w(this,{ts:pe,methodLevel:x,methodValue:de,transmitLevel:$,transmitValue:o.levels.values[y.transmit.level||N.level],send:y.transmit.send,val:N.levelVal},Ae)}}}(N[x]))}function v(y,N,x,Q){y._serialize&&O(x,y._serialize,y.serializers,y._stdErrSerialize);const se=x.slice();let pe=se[0];const Ae={};Q&&(Ae.time=Q),Ae.level=o.levels.values[N];let Fe=(y._childLevel|0)+1;if(Fe<1&&(Fe=1),pe!==null&&typeof pe=="object"){for(;Fe--&&typeof se[0]=="object";)Object.assign(Ae,se.shift());pe=se.length?i(se.shift(),se):void 0}else typeof pe=="string"&&(pe=i(se.shift(),se));return pe!==void 0&&(Ae.msg=pe),Ae}function O(y,N,x,Q){for(const se in y)if(Q&&y[se]instanceof Error)y[se]=o.stdSerializers.err(y[se]);else if(typeof y[se]=="object"&&!Array.isArray(y[se]))for(const pe in y[se])N&&N.indexOf(pe)>-1&&pe in x&&(y[se][pe]=x[pe](y[se][pe]))}function g(y,N,x){return function(){const Q=new Array(1+arguments.length);Q[0]=N;for(var se=1;se<Q.length;se++)Q[se]=arguments[se-1];return y[x].apply(this,Q)}}function w(y,N,x){const Q=N.send,se=N.ts,pe=N.methodLevel,Ae=N.methodValue,Fe=N.val,S=y._logEvent.bindings;O(x,y._serialize||Object.keys(y.serializers),y.serializers,y._stdErrSerialize===void 0?!0:y._stdErrSerialize),y._logEvent.ts=se,y._logEvent.messages=x.filter(function($){return S.indexOf($)===-1}),y._logEvent.level.label=pe,y._logEvent.level.value=Ae,Q(pe,y._logEvent,Fe),y._logEvent=T(S)}function T(y){return{ts:0,messages:[],bindings:y||[],level:{label:"",value:0}}}function A(y){const N={type:y.constructor.name,msg:y.message,stack:y.stack};for(const x in y)N[x]===void 0&&(N[x]=y[x]);return N}function q(y){return typeof y.timestamp=="function"?y.timestamp:y.timestamp===!1?ue:l}function L(){return{}}function K(y){return y}function te(){}function ue(){return!1}function l(){return Date.now()}function p(){return Math.round(Date.now()/1e3)}function _(){return new Date(Date.now()).toISOString()}function m(){function y(N){return typeof N<"u"&&N}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return y(self)||y(window)||y(this)||{}}}return Rc}var Gn={},Wh;function yd(){return Wh||(Wh=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.PINO_CUSTOM_CONTEXT_KEY=Gn.PINO_LOGGER_DEFAULTS=void 0,Gn.PINO_LOGGER_DEFAULTS={level:"info"},Gn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Gn}var nr={},Jh;function Vw(){if(Jh)return nr;Jh=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.generateChildLogger=nr.formatChildLoggerContext=nr.getLoggerContext=nr.setBrowserLoggerContext=nr.getBrowserLoggerContext=nr.getDefaultLoggerOptions=void 0;const i=yd();function t(v){return Object.assign(Object.assign({},v),{level:v?.level||i.PINO_LOGGER_DEFAULTS.level})}nr.getDefaultLoggerOptions=t;function r(v,O=i.PINO_CUSTOM_CONTEXT_KEY){return v[O]||""}nr.getBrowserLoggerContext=r;function s(v,O,g=i.PINO_CUSTOM_CONTEXT_KEY){return v[g]=O,v}nr.setBrowserLoggerContext=s;function o(v,O=i.PINO_CUSTOM_CONTEXT_KEY){let g="";return typeof v.bindings>"u"?g=r(v,O):g=v.bindings().context||"",g}nr.getLoggerContext=o;function c(v,O,g=i.PINO_CUSTOM_CONTEXT_KEY){const w=o(v,g);return w.trim()?`${w}/${O}`:O}nr.formatChildLoggerContext=c;function f(v,O,g=i.PINO_CUSTOM_CONTEXT_KEY){const w=c(v,O,g),T=v.child({context:w});return s(T,w,g)}return nr.generateChildLogger=f,nr}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const t=zw,r=t.__importDefault(Bw());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(yd(),i),t.__exportStar(Vw(),i)})(Re);class kw extends Xn{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let Kw=class extends Xn{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},Gw=class{constructor(t,r){this.logger=t,this.core=r}},Ww=class extends Xn{constructor(t,r){super(),this.relayer=t,this.logger=r}},Jw=class extends Xn{constructor(t){super()}},Qw=class{constructor(t,r,s,o){this.core=t,this.logger=r,this.name=s}};class Yw extends Xn{constructor(t,r){super(),this.relayer=t,this.logger=r}}let Xw=class extends Xn{constructor(t,r){super(),this.core=t,this.logger=r}},Zw=class{constructor(t,r){this.projectId=t,this.logger=r}},e1=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},t1=class{constructor(t){this.client=t}};var mu={},md={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=J_,r=rd;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function v(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return v.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},v.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},v.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},v.prototype.update=function(O,g){if(g===void 0&&(g=O.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var w=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=O[w++],g--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(w=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,O,w,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=O[w++],g--;return this},v.prototype.finish=function(O){if(!this._finished){var g=this._bytesHashed,w=this._bufferLength,T=g/536870912|0,A=g<<3,q=g%128<112?128:256;this._buffer[w]=128;for(var L=w+1;L<q-8;L++)this._buffer[L]=0;t.writeUint32BE(T,this._buffer,q-8),t.writeUint32BE(A,this._buffer,q-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,q),this._finished=!0}for(var L=0;L<this.digestLength/8;L++)t.writeUint32BE(this._stateHi[L],O,L*8),t.writeUint32BE(this._stateLo[L],O,L*8+4);return this},v.prototype.digest=function(){var O=new Uint8Array(this.digestLength);return this.finish(O),O},v.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},v.prototype.restoreState=function(O){return this._stateHi.set(O.stateHi),this._stateLo.set(O.stateLo),this._bufferLength=O.bufferLength,O.buffer&&this._buffer.set(O.buffer),this._bytesHashed=O.bytesHashed,this._finished=!1,this},v.prototype.cleanSavedState=function(O){r.wipe(O.stateHi),r.wipe(O.stateLo),O.buffer&&r.wipe(O.buffer),O.bufferLength=0,O.bytesHashed=0},v}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(v,O,g,w,T,A,q){for(var L=g[0],K=g[1],te=g[2],ue=g[3],l=g[4],p=g[5],_=g[6],m=g[7],y=w[0],N=w[1],x=w[2],Q=w[3],se=w[4],pe=w[5],Ae=w[6],Fe=w[7],S,$,ne,de,X,W,Y,Z;q>=128;){for(var Qe=0;Qe<16;Qe++){var Ve=8*Qe+A;v[Qe]=t.readUint32BE(T,Ve),O[Qe]=t.readUint32BE(T,Ve+4)}for(var Qe=0;Qe<80;Qe++){var Vr=L,Ie=K,St=te,H=ue,z=l,M=p,h=_,C=m,ae=y,ye=N,we=x,Ce=Q,De=se,xe=pe,Ot=Ae,_t=Fe;if(S=m,$=Fe,X=$&65535,W=$>>>16,Y=S&65535,Z=S>>>16,S=(l>>>14|se<<18)^(l>>>18|se<<14)^(se>>>9|l<<23),$=(se>>>14|l<<18)^(se>>>18|l<<14)^(l>>>9|se<<23),X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,S=l&p^~l&_,$=se&pe^~se&Ae,X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,S=o[Qe*2],$=o[Qe*2+1],X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,S=v[Qe%16],$=O[Qe%16],X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,ne=Y&65535|Z<<16,de=X&65535|W<<16,S=ne,$=de,X=$&65535,W=$>>>16,Y=S&65535,Z=S>>>16,S=(L>>>28|y<<4)^(y>>>2|L<<30)^(y>>>7|L<<25),$=(y>>>28|L<<4)^(L>>>2|y<<30)^(L>>>7|y<<25),X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,S=L&K^L&te^K&te,$=y&N^y&x^N&x,X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,C=Y&65535|Z<<16,_t=X&65535|W<<16,S=H,$=Ce,X=$&65535,W=$>>>16,Y=S&65535,Z=S>>>16,S=ne,$=de,X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,H=Y&65535|Z<<16,Ce=X&65535|W<<16,K=Vr,te=Ie,ue=St,l=H,p=z,_=M,m=h,L=C,N=ae,x=ye,Q=we,se=Ce,pe=De,Ae=xe,Fe=Ot,y=_t,Qe%16===15)for(var Ve=0;Ve<16;Ve++)S=v[Ve],$=O[Ve],X=$&65535,W=$>>>16,Y=S&65535,Z=S>>>16,S=v[(Ve+9)%16],$=O[(Ve+9)%16],X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,ne=v[(Ve+1)%16],de=O[(Ve+1)%16],S=(ne>>>1|de<<31)^(ne>>>8|de<<24)^ne>>>7,$=(de>>>1|ne<<31)^(de>>>8|ne<<24)^(de>>>7|ne<<25),X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,ne=v[(Ve+14)%16],de=O[(Ve+14)%16],S=(ne>>>19|de<<13)^(de>>>29|ne<<3)^ne>>>6,$=(de>>>19|ne<<13)^(ne>>>29|de<<3)^(de>>>6|ne<<26),X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,v[Ve]=Y&65535|Z<<16,O[Ve]=X&65535|W<<16}S=L,$=y,X=$&65535,W=$>>>16,Y=S&65535,Z=S>>>16,S=g[0],$=w[0],X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,g[0]=L=Y&65535|Z<<16,w[0]=y=X&65535|W<<16,S=K,$=N,X=$&65535,W=$>>>16,Y=S&65535,Z=S>>>16,S=g[1],$=w[1],X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,g[1]=K=Y&65535|Z<<16,w[1]=N=X&65535|W<<16,S=te,$=x,X=$&65535,W=$>>>16,Y=S&65535,Z=S>>>16,S=g[2],$=w[2],X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,g[2]=te=Y&65535|Z<<16,w[2]=x=X&65535|W<<16,S=ue,$=Q,X=$&65535,W=$>>>16,Y=S&65535,Z=S>>>16,S=g[3],$=w[3],X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,g[3]=ue=Y&65535|Z<<16,w[3]=Q=X&65535|W<<16,S=l,$=se,X=$&65535,W=$>>>16,Y=S&65535,Z=S>>>16,S=g[4],$=w[4],X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,g[4]=l=Y&65535|Z<<16,w[4]=se=X&65535|W<<16,S=p,$=pe,X=$&65535,W=$>>>16,Y=S&65535,Z=S>>>16,S=g[5],$=w[5],X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,g[5]=p=Y&65535|Z<<16,w[5]=pe=X&65535|W<<16,S=_,$=Ae,X=$&65535,W=$>>>16,Y=S&65535,Z=S>>>16,S=g[6],$=w[6],X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,g[6]=_=Y&65535|Z<<16,w[6]=Ae=X&65535|W<<16,S=m,$=Fe,X=$&65535,W=$>>>16,Y=S&65535,Z=S>>>16,S=g[7],$=w[7],X+=$&65535,W+=$>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,g[7]=m=Y&65535|Z<<16,w[7]=Fe=X&65535|W<<16,A+=128,q-=128}return A}function f(v){var O=new s;O.update(v);var g=O.digest();return O.clean(),g}i.hash=f})(md);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const t=Bo,r=md,s=rd;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(H){const z=new Float64Array(16);if(H)for(let M=0;M<H.length;M++)z[M]=H[M];return z}const c=new Uint8Array(32);c[0]=9;const f=o(),v=o([1]),O=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),w=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),T=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),A=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function q(H,z){for(let M=0;M<16;M++)H[M]=z[M]|0}function L(H){let z=1;for(let M=0;M<16;M++){let h=H[M]+z+65535;z=Math.floor(h/65536),H[M]=h-z*65536}H[0]+=z-1+37*(z-1)}function K(H,z,M){const h=~(M-1);for(let C=0;C<16;C++){const ae=h&(H[C]^z[C]);H[C]^=ae,z[C]^=ae}}function te(H,z){const M=o(),h=o();for(let C=0;C<16;C++)h[C]=z[C];L(h),L(h),L(h);for(let C=0;C<2;C++){M[0]=h[0]-65517;for(let ye=1;ye<15;ye++)M[ye]=h[ye]-65535-(M[ye-1]>>16&1),M[ye-1]&=65535;M[15]=h[15]-32767-(M[14]>>16&1);const ae=M[15]>>16&1;M[14]&=65535,K(h,M,1-ae)}for(let C=0;C<16;C++)H[2*C]=h[C]&255,H[2*C+1]=h[C]>>8}function ue(H,z){let M=0;for(let h=0;h<32;h++)M|=H[h]^z[h];return(1&M-1>>>8)-1}function l(H,z){const M=new Uint8Array(32),h=new Uint8Array(32);return te(M,H),te(h,z),ue(M,h)}function p(H){const z=new Uint8Array(32);return te(z,H),z[0]&1}function _(H,z){for(let M=0;M<16;M++)H[M]=z[2*M]+(z[2*M+1]<<8);H[15]&=32767}function m(H,z,M){for(let h=0;h<16;h++)H[h]=z[h]+M[h]}function y(H,z,M){for(let h=0;h<16;h++)H[h]=z[h]-M[h]}function N(H,z,M){let h,C,ae=0,ye=0,we=0,Ce=0,De=0,xe=0,Ot=0,_t=0,at=0,je=0,Xe=0,Ze=0,ct=0,ze=0,et=0,$e=0,ke=0,ht=0,Me=0,xt=0,Dt=0,zt=0,Ht=0,Lt=0,Yt=0,or=0,kr=0,Xt=0,Xr=0,vn=0,Cn=0,ft=M[0],nt=M[1],dt=M[2],pt=M[3],ut=M[4],it=M[5],Pt=M[6],Tt=M[7],gt=M[8],Nt=M[9],yt=M[10],bt=M[11],mt=M[12],Ye=M[13],Rt=M[14],At=M[15];h=z[0],ae+=h*ft,ye+=h*nt,we+=h*dt,Ce+=h*pt,De+=h*ut,xe+=h*it,Ot+=h*Pt,_t+=h*Tt,at+=h*gt,je+=h*Nt,Xe+=h*yt,Ze+=h*bt,ct+=h*mt,ze+=h*Ye,et+=h*Rt,$e+=h*At,h=z[1],ye+=h*ft,we+=h*nt,Ce+=h*dt,De+=h*pt,xe+=h*ut,Ot+=h*it,_t+=h*Pt,at+=h*Tt,je+=h*gt,Xe+=h*Nt,Ze+=h*yt,ct+=h*bt,ze+=h*mt,et+=h*Ye,$e+=h*Rt,ke+=h*At,h=z[2],we+=h*ft,Ce+=h*nt,De+=h*dt,xe+=h*pt,Ot+=h*ut,_t+=h*it,at+=h*Pt,je+=h*Tt,Xe+=h*gt,Ze+=h*Nt,ct+=h*yt,ze+=h*bt,et+=h*mt,$e+=h*Ye,ke+=h*Rt,ht+=h*At,h=z[3],Ce+=h*ft,De+=h*nt,xe+=h*dt,Ot+=h*pt,_t+=h*ut,at+=h*it,je+=h*Pt,Xe+=h*Tt,Ze+=h*gt,ct+=h*Nt,ze+=h*yt,et+=h*bt,$e+=h*mt,ke+=h*Ye,ht+=h*Rt,Me+=h*At,h=z[4],De+=h*ft,xe+=h*nt,Ot+=h*dt,_t+=h*pt,at+=h*ut,je+=h*it,Xe+=h*Pt,Ze+=h*Tt,ct+=h*gt,ze+=h*Nt,et+=h*yt,$e+=h*bt,ke+=h*mt,ht+=h*Ye,Me+=h*Rt,xt+=h*At,h=z[5],xe+=h*ft,Ot+=h*nt,_t+=h*dt,at+=h*pt,je+=h*ut,Xe+=h*it,Ze+=h*Pt,ct+=h*Tt,ze+=h*gt,et+=h*Nt,$e+=h*yt,ke+=h*bt,ht+=h*mt,Me+=h*Ye,xt+=h*Rt,Dt+=h*At,h=z[6],Ot+=h*ft,_t+=h*nt,at+=h*dt,je+=h*pt,Xe+=h*ut,Ze+=h*it,ct+=h*Pt,ze+=h*Tt,et+=h*gt,$e+=h*Nt,ke+=h*yt,ht+=h*bt,Me+=h*mt,xt+=h*Ye,Dt+=h*Rt,zt+=h*At,h=z[7],_t+=h*ft,at+=h*nt,je+=h*dt,Xe+=h*pt,Ze+=h*ut,ct+=h*it,ze+=h*Pt,et+=h*Tt,$e+=h*gt,ke+=h*Nt,ht+=h*yt,Me+=h*bt,xt+=h*mt,Dt+=h*Ye,zt+=h*Rt,Ht+=h*At,h=z[8],at+=h*ft,je+=h*nt,Xe+=h*dt,Ze+=h*pt,ct+=h*ut,ze+=h*it,et+=h*Pt,$e+=h*Tt,ke+=h*gt,ht+=h*Nt,Me+=h*yt,xt+=h*bt,Dt+=h*mt,zt+=h*Ye,Ht+=h*Rt,Lt+=h*At,h=z[9],je+=h*ft,Xe+=h*nt,Ze+=h*dt,ct+=h*pt,ze+=h*ut,et+=h*it,$e+=h*Pt,ke+=h*Tt,ht+=h*gt,Me+=h*Nt,xt+=h*yt,Dt+=h*bt,zt+=h*mt,Ht+=h*Ye,Lt+=h*Rt,Yt+=h*At,h=z[10],Xe+=h*ft,Ze+=h*nt,ct+=h*dt,ze+=h*pt,et+=h*ut,$e+=h*it,ke+=h*Pt,ht+=h*Tt,Me+=h*gt,xt+=h*Nt,Dt+=h*yt,zt+=h*bt,Ht+=h*mt,Lt+=h*Ye,Yt+=h*Rt,or+=h*At,h=z[11],Ze+=h*ft,ct+=h*nt,ze+=h*dt,et+=h*pt,$e+=h*ut,ke+=h*it,ht+=h*Pt,Me+=h*Tt,xt+=h*gt,Dt+=h*Nt,zt+=h*yt,Ht+=h*bt,Lt+=h*mt,Yt+=h*Ye,or+=h*Rt,kr+=h*At,h=z[12],ct+=h*ft,ze+=h*nt,et+=h*dt,$e+=h*pt,ke+=h*ut,ht+=h*it,Me+=h*Pt,xt+=h*Tt,Dt+=h*gt,zt+=h*Nt,Ht+=h*yt,Lt+=h*bt,Yt+=h*mt,or+=h*Ye,kr+=h*Rt,Xt+=h*At,h=z[13],ze+=h*ft,et+=h*nt,$e+=h*dt,ke+=h*pt,ht+=h*ut,Me+=h*it,xt+=h*Pt,Dt+=h*Tt,zt+=h*gt,Ht+=h*Nt,Lt+=h*yt,Yt+=h*bt,or+=h*mt,kr+=h*Ye,Xt+=h*Rt,Xr+=h*At,h=z[14],et+=h*ft,$e+=h*nt,ke+=h*dt,ht+=h*pt,Me+=h*ut,xt+=h*it,Dt+=h*Pt,zt+=h*Tt,Ht+=h*gt,Lt+=h*Nt,Yt+=h*yt,or+=h*bt,kr+=h*mt,Xt+=h*Ye,Xr+=h*Rt,vn+=h*At,h=z[15],$e+=h*ft,ke+=h*nt,ht+=h*dt,Me+=h*pt,xt+=h*ut,Dt+=h*it,zt+=h*Pt,Ht+=h*Tt,Lt+=h*gt,Yt+=h*Nt,or+=h*yt,kr+=h*bt,Xt+=h*mt,Xr+=h*Ye,vn+=h*Rt,Cn+=h*At,ae+=38*ke,ye+=38*ht,we+=38*Me,Ce+=38*xt,De+=38*Dt,xe+=38*zt,Ot+=38*Ht,_t+=38*Lt,at+=38*Yt,je+=38*or,Xe+=38*kr,Ze+=38*Xt,ct+=38*Xr,ze+=38*vn,et+=38*Cn,C=1,h=ae+C+65535,C=Math.floor(h/65536),ae=h-C*65536,h=ye+C+65535,C=Math.floor(h/65536),ye=h-C*65536,h=we+C+65535,C=Math.floor(h/65536),we=h-C*65536,h=Ce+C+65535,C=Math.floor(h/65536),Ce=h-C*65536,h=De+C+65535,C=Math.floor(h/65536),De=h-C*65536,h=xe+C+65535,C=Math.floor(h/65536),xe=h-C*65536,h=Ot+C+65535,C=Math.floor(h/65536),Ot=h-C*65536,h=_t+C+65535,C=Math.floor(h/65536),_t=h-C*65536,h=at+C+65535,C=Math.floor(h/65536),at=h-C*65536,h=je+C+65535,C=Math.floor(h/65536),je=h-C*65536,h=Xe+C+65535,C=Math.floor(h/65536),Xe=h-C*65536,h=Ze+C+65535,C=Math.floor(h/65536),Ze=h-C*65536,h=ct+C+65535,C=Math.floor(h/65536),ct=h-C*65536,h=ze+C+65535,C=Math.floor(h/65536),ze=h-C*65536,h=et+C+65535,C=Math.floor(h/65536),et=h-C*65536,h=$e+C+65535,C=Math.floor(h/65536),$e=h-C*65536,ae+=C-1+37*(C-1),C=1,h=ae+C+65535,C=Math.floor(h/65536),ae=h-C*65536,h=ye+C+65535,C=Math.floor(h/65536),ye=h-C*65536,h=we+C+65535,C=Math.floor(h/65536),we=h-C*65536,h=Ce+C+65535,C=Math.floor(h/65536),Ce=h-C*65536,h=De+C+65535,C=Math.floor(h/65536),De=h-C*65536,h=xe+C+65535,C=Math.floor(h/65536),xe=h-C*65536,h=Ot+C+65535,C=Math.floor(h/65536),Ot=h-C*65536,h=_t+C+65535,C=Math.floor(h/65536),_t=h-C*65536,h=at+C+65535,C=Math.floor(h/65536),at=h-C*65536,h=je+C+65535,C=Math.floor(h/65536),je=h-C*65536,h=Xe+C+65535,C=Math.floor(h/65536),Xe=h-C*65536,h=Ze+C+65535,C=Math.floor(h/65536),Ze=h-C*65536,h=ct+C+65535,C=Math.floor(h/65536),ct=h-C*65536,h=ze+C+65535,C=Math.floor(h/65536),ze=h-C*65536,h=et+C+65535,C=Math.floor(h/65536),et=h-C*65536,h=$e+C+65535,C=Math.floor(h/65536),$e=h-C*65536,ae+=C-1+37*(C-1),H[0]=ae,H[1]=ye,H[2]=we,H[3]=Ce,H[4]=De,H[5]=xe,H[6]=Ot,H[7]=_t,H[8]=at,H[9]=je,H[10]=Xe,H[11]=Ze,H[12]=ct,H[13]=ze,H[14]=et,H[15]=$e}function x(H,z){N(H,z,z)}function Q(H,z){const M=o();let h;for(h=0;h<16;h++)M[h]=z[h];for(h=253;h>=0;h--)x(M,M),h!==2&&h!==4&&N(M,M,z);for(h=0;h<16;h++)H[h]=M[h]}function se(H,z){const M=o();let h;for(h=0;h<16;h++)M[h]=z[h];for(h=250;h>=0;h--)x(M,M),h!==1&&N(M,M,z);for(h=0;h<16;h++)H[h]=M[h]}function pe(H,z){const M=o(),h=o(),C=o(),ae=o(),ye=o(),we=o(),Ce=o(),De=o(),xe=o();y(M,H[1],H[0]),y(xe,z[1],z[0]),N(M,M,xe),m(h,H[0],H[1]),m(xe,z[0],z[1]),N(h,h,xe),N(C,H[3],z[3]),N(C,C,g),N(ae,H[2],z[2]),m(ae,ae,ae),y(ye,h,M),y(we,ae,C),m(Ce,ae,C),m(De,h,M),N(H[0],ye,we),N(H[1],De,Ce),N(H[2],Ce,we),N(H[3],ye,De)}function Ae(H,z,M){for(let h=0;h<4;h++)K(H[h],z[h],M)}function Fe(H,z){const M=o(),h=o(),C=o();Q(C,z[2]),N(M,z[0],C),N(h,z[1],C),te(H,h),H[31]^=p(M)<<7}function S(H,z,M){q(H[0],f),q(H[1],v),q(H[2],v),q(H[3],f);for(let h=255;h>=0;--h){const C=M[h/8|0]>>(h&7)&1;Ae(H,z,C),pe(z,H),pe(H,H),Ae(H,z,C)}}function $(H,z){const M=[o(),o(),o(),o()];q(M[0],w),q(M[1],T),q(M[2],v),N(M[3],w,T),S(H,M,z)}function ne(H){if(H.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const z=(0,r.hash)(H);z[0]&=248,z[31]&=127,z[31]|=64;const M=new Uint8Array(32),h=[o(),o(),o(),o()];$(h,z),Fe(M,h);const C=new Uint8Array(64);return C.set(H),C.set(M,32),{publicKey:M,secretKey:C}}i.generateKeyPairFromSeed=ne;function de(H){const z=(0,t.randomBytes)(32,H),M=ne(z);return(0,s.wipe)(z),M}i.generateKeyPair=de;function X(H){if(H.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(H.subarray(32))}i.extractPublicKeyFromSecretKey=X;const W=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Y(H,z){let M,h,C,ae;for(h=63;h>=32;--h){for(M=0,C=h-32,ae=h-12;C<ae;++C)z[C]+=M-16*z[h]*W[C-(h-32)],M=Math.floor((z[C]+128)/256),z[C]-=M*256;z[C]+=M,z[h]=0}for(M=0,C=0;C<32;C++)z[C]+=M-(z[31]>>4)*W[C],M=z[C]>>8,z[C]&=255;for(C=0;C<32;C++)z[C]-=M*W[C];for(h=0;h<32;h++)z[h+1]+=z[h]>>8,H[h]=z[h]&255}function Z(H){const z=new Float64Array(64);for(let M=0;M<64;M++)z[M]=H[M];for(let M=0;M<64;M++)H[M]=0;Y(H,z)}function Qe(H,z){const M=new Float64Array(64),h=[o(),o(),o(),o()],C=(0,r.hash)(H.subarray(0,32));C[0]&=248,C[31]&=127,C[31]|=64;const ae=new Uint8Array(64);ae.set(C.subarray(32),32);const ye=new r.SHA512;ye.update(ae.subarray(32)),ye.update(z);const we=ye.digest();ye.clean(),Z(we),$(h,we),Fe(ae,h),ye.reset(),ye.update(ae.subarray(0,32)),ye.update(H.subarray(32)),ye.update(z);const Ce=ye.digest();Z(Ce);for(let De=0;De<32;De++)M[De]=we[De];for(let De=0;De<32;De++)for(let xe=0;xe<32;xe++)M[De+xe]+=Ce[De]*C[xe];return Y(ae.subarray(32),M),ae}i.sign=Qe;function Ve(H,z){const M=o(),h=o(),C=o(),ae=o(),ye=o(),we=o(),Ce=o();return q(H[2],v),_(H[1],z),x(C,H[1]),N(ae,C,O),y(C,C,H[2]),m(ae,H[2],ae),x(ye,ae),x(we,ye),N(Ce,we,ye),N(M,Ce,C),N(M,M,ae),se(M,M),N(M,M,C),N(M,M,ae),N(M,M,ae),N(H[0],M,ae),x(h,H[0]),N(h,h,ae),l(h,C)&&N(H[0],H[0],A),x(h,H[0]),N(h,h,ae),l(h,C)?-1:(p(H[0])===z[31]>>7&&y(H[0],f,H[0]),N(H[3],H[0],H[1]),0)}function Vr(H,z,M){const h=new Uint8Array(32),C=[o(),o(),o(),o()],ae=[o(),o(),o(),o()];if(M.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(Ve(ae,H))return!1;const ye=new r.SHA512;ye.update(M.subarray(0,32)),ye.update(H),ye.update(z);const we=ye.digest();return Z(we),S(C,ae,we),$(ae,M.subarray(32)),pe(C,ae),Fe(h,C),!ue(M,h)}i.verify=Vr;function Ie(H){let z=[o(),o(),o(),o()];if(Ve(z,H))throw new Error("Ed25519: invalid public key");let M=o(),h=o(),C=z[1];m(M,v,C),y(h,v,C),Q(h,h),N(M,M,h);let ae=new Uint8Array(32);return te(ae,M),ae}i.convertPublicKeyToX25519=Ie;function St(H){const z=(0,r.hash)(H.subarray(0,32));z[0]&=248,z[31]&=127,z[31]|=64;const M=new Uint8Array(z.subarray(0,32));return(0,s.wipe)(z),M}i.convertSecretKeyToX25519=St})(mu);const r1="EdDSA",n1="JWT",vd=".",_d="base64url",i1="utf8",s1="utf8",o1=":",a1="did",c1="key",Qh="base58btc",u1="z",l1="K36",h1=32;function Co(i){return Qt(ir(Qn(i),i1),_d)}function bd(i){const t=ir(l1,Qh),r=u1+Qt(kc([t,i]),Qh);return[a1,c1,r].join(o1)}function f1(i){return Qt(i,_d)}function d1(i){return ir([Co(i.header),Co(i.payload)].join(vd),s1)}function p1(i){return[Co(i.header),Co(i.payload),f1(i.signature)].join(vd)}function Yh(i=Bo.randomBytes(h1)){return mu.generateKeyPairFromSeed(i)}async function g1(i,t,r,s,o=oe.fromMiliseconds(Date.now())){const c={alg:r1,typ:n1},f=bd(s.publicKey),v=o+r,O={iss:f,sub:i,aud:t,iat:o,exp:v},g=d1({header:c,payload:O}),w=mu.sign(s.secretKey,g);return p1({header:c,payload:O,signature:w})}var us={};(function(i){const t=Fo,r=zo,s=Mo,o=qo,c=l=>l==null,f=Symbol("encodeFragmentIdentifier");function v(l){switch(l.arrayFormat){case"index":return p=>(_,m)=>{const y=_.length;return m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,[w(p,l),"[",y,"]"].join("")]:[..._,[w(p,l),"[",w(y,l),"]=",w(m,l)].join("")]};case"bracket":return p=>(_,m)=>m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,[w(p,l),"[]"].join("")]:[..._,[w(p,l),"[]=",w(m,l)].join("")];case"colon-list-separator":return p=>(_,m)=>m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,[w(p,l),":list="].join("")]:[..._,[w(p,l),":list=",w(m,l)].join("")];case"comma":case"separator":case"bracket-separator":{const p=l.arrayFormat==="bracket-separator"?"[]=":"=";return _=>(m,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?m:(y=y===null?"":y,m.length===0?[[w(_,l),p,w(y,l)].join("")]:[[m,w(y,l)].join(l.arrayFormatSeparator)])}default:return p=>(_,m)=>m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,w(p,l)]:[..._,[w(p,l),"=",w(m,l)].join("")]}}function O(l){let p;switch(l.arrayFormat){case"index":return(_,m,y)=>{if(p=/\[(\d*)\]$/.exec(_),_=_.replace(/\[\d*\]$/,""),!p){y[_]=m;return}y[_]===void 0&&(y[_]={}),y[_][p[1]]=m};case"bracket":return(_,m,y)=>{if(p=/(\[\])$/.exec(_),_=_.replace(/\[\]$/,""),!p){y[_]=m;return}if(y[_]===void 0){y[_]=[m];return}y[_]=[].concat(y[_],m)};case"colon-list-separator":return(_,m,y)=>{if(p=/(:list)$/.exec(_),_=_.replace(/:list$/,""),!p){y[_]=m;return}if(y[_]===void 0){y[_]=[m];return}y[_]=[].concat(y[_],m)};case"comma":case"separator":return(_,m,y)=>{const N=typeof m=="string"&&m.includes(l.arrayFormatSeparator),x=typeof m=="string"&&!N&&T(m,l).includes(l.arrayFormatSeparator);m=x?T(m,l):m;const Q=N||x?m.split(l.arrayFormatSeparator).map(se=>T(se,l)):m===null?m:T(m,l);y[_]=Q};case"bracket-separator":return(_,m,y)=>{const N=/(\[\])$/.test(_);if(_=_.replace(/\[\]$/,""),!N){y[_]=m&&T(m,l);return}const x=m===null?[]:m.split(l.arrayFormatSeparator).map(Q=>T(Q,l));if(y[_]===void 0){y[_]=x;return}y[_]=[].concat(y[_],x)};default:return(_,m,y)=>{if(y[_]===void 0){y[_]=m;return}y[_]=[].concat(y[_],m)}}}function g(l){if(typeof l!="string"||l.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function w(l,p){return p.encode?p.strict?t(l):encodeURIComponent(l):l}function T(l,p){return p.decode?r(l):l}function A(l){return Array.isArray(l)?l.sort():typeof l=="object"?A(Object.keys(l)).sort((p,_)=>Number(p)-Number(_)).map(p=>l[p]):l}function q(l){const p=l.indexOf("#");return p!==-1&&(l=l.slice(0,p)),l}function L(l){let p="";const _=l.indexOf("#");return _!==-1&&(p=l.slice(_)),p}function K(l){l=q(l);const p=l.indexOf("?");return p===-1?"":l.slice(p+1)}function te(l,p){return p.parseNumbers&&!Number.isNaN(Number(l))&&typeof l=="string"&&l.trim()!==""?l=Number(l):p.parseBooleans&&l!==null&&(l.toLowerCase()==="true"||l.toLowerCase()==="false")&&(l=l.toLowerCase()==="true"),l}function ue(l,p){p=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},p),g(p.arrayFormatSeparator);const _=O(p),m=Object.create(null);if(typeof l!="string"||(l=l.trim().replace(/^[?#&]/,""),!l))return m;for(const y of l.split("&")){if(y==="")continue;let[N,x]=s(p.decode?y.replace(/\+/g," "):y,"=");x=x===void 0?null:["comma","separator","bracket-separator"].includes(p.arrayFormat)?x:T(x,p),_(T(N,p),x,m)}for(const y of Object.keys(m)){const N=m[y];if(typeof N=="object"&&N!==null)for(const x of Object.keys(N))N[x]=te(N[x],p);else m[y]=te(N,p)}return p.sort===!1?m:(p.sort===!0?Object.keys(m).sort():Object.keys(m).sort(p.sort)).reduce((y,N)=>{const x=m[N];return x&&typeof x=="object"&&!Array.isArray(x)?y[N]=A(x):y[N]=x,y},Object.create(null))}i.extract=K,i.parse=ue,i.stringify=(l,p)=>{if(!l)return"";p=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},p),g(p.arrayFormatSeparator);const _=x=>p.skipNull&&c(l[x])||p.skipEmptyString&&l[x]==="",m=v(p),y={};for(const x of Object.keys(l))_(x)||(y[x]=l[x]);const N=Object.keys(y);return p.sort!==!1&&N.sort(p.sort),N.map(x=>{const Q=l[x];return Q===void 0?"":Q===null?w(x,p):Array.isArray(Q)?Q.length===0&&p.arrayFormat==="bracket-separator"?w(x,p)+"[]":Q.reduce(m(x),[]).join("&"):w(x,p)+"="+w(Q,p)}).filter(x=>x.length>0).join("&")},i.parseUrl=(l,p)=>{p=Object.assign({decode:!0},p);const[_,m]=s(l,"#");return Object.assign({url:_.split("?")[0]||"",query:ue(K(l),p)},p&&p.parseFragmentIdentifier&&m?{fragmentIdentifier:T(m,p)}:{})},i.stringifyUrl=(l,p)=>{p=Object.assign({encode:!0,strict:!0,[f]:!0},p);const _=q(l.url).split("?")[0]||"",m=i.extract(l.url),y=i.parse(m,{sort:!1}),N=Object.assign(y,l.query);let x=i.stringify(N,p);x&&(x=`?${x}`);let Q=L(l.url);return l.fragmentIdentifier&&(Q=`#${p[f]?w(l.fragmentIdentifier,p):l.fragmentIdentifier}`),`${_}${x}${Q}`},i.pick=(l,p,_)=>{_=Object.assign({parseFragmentIdentifier:!0,[f]:!1},_);const{url:m,query:y,fragmentIdentifier:N}=i.parseUrl(l,_);return i.stringifyUrl({url:m,query:o(y,p),fragmentIdentifier:N},_)},i.exclude=(l,p,_)=>{const m=Array.isArray(p)?y=>!p.includes(y):(y,N)=>!p(y,N);return i.pick(l,m,_)}})(us);const wd="base10",sr="base16",eu="base64pad",vu="utf8",Ed=0,Oi=1,y1=0,Xh=1,tu=12,_u=32;function m1(){const i=nd.generateKeyPair();return{privateKey:Qt(i.secretKey,sr),publicKey:Qt(i.publicKey,sr)}}function ru(){const i=Bo.randomBytes(_u);return Qt(i,sr)}function v1(i,t){const r=nd.sharedKey(ir(i,sr),ir(t,sr),!0),s=new Q_(Vo.SHA256,r).expand(_u);return Qt(s,sr)}function _1(i){const t=Vo.hash(ir(i,sr));return Qt(t,sr)}function nu(i){const t=Vo.hash(ir(i,vu));return Qt(t,sr)}function b1(i){return ir(`${i}`,wd)}function ps(i){return Number(Qt(i,wd))}function w1(i){const t=b1(typeof i.type<"u"?i.type:Ed);if(ps(t)===Oi&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof i.senderPublicKey<"u"?ir(i.senderPublicKey,sr):void 0,s=typeof i.iv<"u"?ir(i.iv,sr):Bo.randomBytes(tu),o=new id.ChaCha20Poly1305(ir(i.symKey,sr)).seal(s,ir(i.message,vu));return I1({type:t,sealed:o,iv:s,senderPublicKey:r})}function E1(i){const t=new id.ChaCha20Poly1305(ir(i.symKey,sr)),{sealed:r,iv:s}=$o(i.encoded),o=t.open(s,r);if(o===null)throw new Error("Failed to decrypt");return Qt(o,vu)}function I1(i){if(ps(i.type)===Oi){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Qt(kc([i.type,i.senderPublicKey,i.iv,i.sealed]),eu)}return Qt(kc([i.type,i.iv,i.sealed]),eu)}function $o(i){const t=ir(i,eu),r=t.slice(y1,Xh),s=Xh;if(ps(r)===Oi){const v=s+_u,O=v+tu,g=t.slice(s,v),w=t.slice(v,O),T=t.slice(O);return{type:r,sealed:T,iv:w,senderPublicKey:g}}const o=s+tu,c=t.slice(s,o),f=t.slice(o);return{type:r,sealed:f,iv:c}}function S1(i,t){const r=$o(i);return Id({type:ps(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Qt(r.senderPublicKey,sr):void 0,receiverPublicKey:t?.receiverPublicKey})}function Id(i){const t=i?.type||Ed;if(t===Oi){if(typeof i?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof i?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:i?.senderPublicKey,receiverPublicKey:i?.receiverPublicKey}}function Zh(i){return i.type===Oi&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var O1=Object.defineProperty,ef=Object.getOwnPropertySymbols,x1=Object.prototype.hasOwnProperty,P1=Object.prototype.propertyIsEnumerable,tf=(i,t,r)=>t in i?O1(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,rf=(i,t)=>{for(var r in t||(t={}))x1.call(t,r)&&tf(i,r,t[r]);if(ef)for(var r of ef(t))P1.call(t,r)&&tf(i,r,t[r]);return i};const T1="ReactNative",Br={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},N1="js";function bu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function xi(){return!sd()&&!!ko()&&navigator.product===T1}function Go(){return!bu()&&!!ko()}function Wo(){return xi()?Br.reactNative:bu()?Br.node:Go()?Br.browser:Br.unknown}function R1(){var i;try{return xi()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(i=global.Application)==null?void 0:i.applicationId:void 0}catch{return}}function A1(i,t){let r=us.parse(i);return r=rf(rf({},r),t),i=us.stringify(r),i}function C1(){if(Wo()===Br.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const i=cb();if(i===null)return"unknown";const t=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[t,i.name,i.version].join("-"):[t,i.version].join("-")}function $1(){var i;const t=Wo();return t===Br.browser?[t,((i=Y_())==null?void 0:i.host)||"unknown"].join(":"):t}function D1(i,t,r){const s=C1(),o=$1();return[[i,t].join("-"),[N1,r].join("-"),s,o].join("/")}function U1({protocol:i,version:t,relayUrl:r,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:f,bundleId:v}){const O=r.split("?"),g=D1(i,t,s),w={auth:o,ua:g,projectId:c,useOnCloseEvent:f||void 0,origin:v||void 0},T=A1(O[1]||"",w);return O[0]+"?"+T}function Sd(i){return Object.fromEntries(i.entries())}function Od(i){return new Map(Object.entries(i))}function j1(i=oe.FIVE_MINUTES,t){const r=oe.toMiliseconds(i||oe.FIVE_MINUTES);let s,o,c;return{resolve:f=>{c&&s&&(clearTimeout(c),s(f))},reject:f=>{c&&o&&(clearTimeout(c),o(f))},done:()=>new Promise((f,v)=>{c=setTimeout(()=>{v(new Error(t))},r),s=f,o=v})}}function ls(i,t,r){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(r)),t);try{const f=await i;s(f)}catch(f){o(f)}clearTimeout(c)})}function xd(i,t){if(typeof t=="string"&&t.startsWith(`${i}:`))return t;if(i.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(i.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${i}`)}function L1(i){return xd("topic",i)}function M1(i){return xd("id",i)}function q1(i){const[t,r]=i.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function No(i,t){return oe.fromMiliseconds((t||Date.now())+oe.toMiliseconds(i))}function nf(i){return Date.now()>=oe.toMiliseconds(i)}function Ac(i,t){return`${i}${t?`:${t}`:""}`}const F1="irn";function iu(i){return i?.relay||{protocol:F1}}function Ro(i){const t=db[i];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${i}`);return t}var z1=Object.defineProperty,sf=Object.getOwnPropertySymbols,H1=Object.prototype.hasOwnProperty,B1=Object.prototype.propertyIsEnumerable,of=(i,t,r)=>t in i?z1(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,V1=(i,t)=>{for(var r in t||(t={}))H1.call(t,r)&&of(i,r,t[r]);if(sf)for(var r of sf(t))B1.call(t,r)&&of(i,r,t[r]);return i};function k1(i,t="-"){const r={},s="relay"+t;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),f=i[o];r[c]=f}}),r}function af(i){i=i.includes("wc://")?i.replace("wc://",""):i,i=i.includes("wc:")?i.replace("wc:",""):i;const t=i.indexOf(":"),r=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,t),o=i.substring(t+1,r).split("@"),c=typeof r<"u"?i.substring(r):"",f=us.parse(c);return{protocol:s,topic:K1(o[0]),version:parseInt(o[1],10),symKey:f.symKey,relay:k1(f)}}function K1(i){return i.startsWith("//")?i.substring(2):i}function G1(i,t="-"){const r="relay",s={};return Object.keys(i).forEach(o=>{const c=r+t+o;i[o]&&(s[c]=i[o])}),s}function W1(i){return`${i.protocol}:${i.topic}@${i.version}?`+us.stringify(V1({symKey:i.symKey},G1(i.relay)))}const J1={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Q1={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Be(i,t){const{message:r,code:s}=Q1[i];return{message:t?`${r} ${t}`:r,code:s}}function ts(i,t){const{message:r,code:s}=J1[i];return{message:t?`${r} ${t}`:r,code:s}}function Y1(i,t){return Array.isArray(i)?typeof t<"u"&&i.length?i.every(t):!0:!1}function Do(i){return typeof i>"u"}function Pd(i,t){return t&&Do(i)?!0:typeof i=="string"&&!!i.trim().length}function X1(i){if(Pd(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function Z1(i){var t;return(t=i?.proposer)==null?void 0:t.publicKey}function eE(i){return i?.topic}function Cc(i){return typeof i<"u"&&typeof i!==null}function cf(){const i=Wo();return new Promise(t=>{switch(i){case Br.browser:t(tE());break;case Br.reactNative:t(rE());break;case Br.node:t(nE());break;default:t(!0)}})}function tE(){return Go()&&navigator?.onLine}async function rE(){return xi()&&typeof global<"u"&&global!=null&&global.NetInfo?(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected:!0}function nE(){return!0}function iE(i){switch(Wo()){case Br.browser:sE(i);break;case Br.reactNative:oE(i);break}}function sE(i){!xi()&&Go()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function oE(i){xi()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(t=>i(t?.isConnected))}const aE="PARSE_ERROR",cE="INVALID_REQUEST",uE="METHOD_NOT_FOUND",lE="INVALID_PARAMS",Td="INTERNAL_ERROR",wu="SERVER_ERROR",hE=[-32700,-32600,-32601,-32602,-32603],ss={[aE]:{code:-32700,message:"Parse error"},[cE]:{code:-32600,message:"Invalid Request"},[uE]:{code:-32601,message:"Method not found"},[lE]:{code:-32602,message:"Invalid params"},[Td]:{code:-32603,message:"Internal error"},[wu]:{code:-32e3,message:"Server error"}},Nd=wu;function fE(i){return hE.includes(i)}function uf(i){return Object.keys(ss).includes(i)?ss[i]:ss[Nd]}function dE(i){const t=Object.values(ss).find(r=>r.code===i);return t||ss[Nd]}function Rd(i,t,r){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):i}var Ad={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var su=function(i,t){return su=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)s.hasOwnProperty(o)&&(r[o]=s[o])},su(i,t)};function pE(i,t){su(i,t);function r(){this.constructor=i}i.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ou=function(){return ou=Object.assign||function(t){for(var r,s=1,o=arguments.length;s<o;s++){r=arguments[s];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},ou.apply(this,arguments)};function gE(i,t){var r={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&t.indexOf(s)<0&&(r[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(r[s[o]]=i[s[o]]);return r}function yE(i,t,r,s){var o=arguments.length,c=o<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,t,r,s);else for(var v=i.length-1;v>=0;v--)(f=i[v])&&(c=(o<3?f(c):o>3?f(t,r,c):f(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c}function mE(i,t){return function(r,s){t(r,s,i)}}function vE(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)}function _E(i,t,r,s){function o(c){return c instanceof r?c:new r(function(f){f(c)})}return new(r||(r=Promise))(function(c,f){function v(w){try{g(s.next(w))}catch(T){f(T)}}function O(w){try{g(s.throw(w))}catch(T){f(T)}}function g(w){w.done?c(w.value):o(w.value).then(v,O)}g((s=s.apply(i,t||[])).next())})}function bE(i,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,f;return f={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function v(g){return function(w){return O([g,w])}}function O(g){if(s)throw new TypeError("Generator is already executing.");for(;r;)try{if(s=1,o&&(c=g[0]&2?o.return:g[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,g[1])).done)return c;switch(o=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,o=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){r=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){r.label=g[1];break}if(g[0]===6&&r.label<c[1]){r.label=c[1],c=g;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(g);break}c[2]&&r.ops.pop(),r.trys.pop();continue}g=t.call(i,r)}catch(w){g=[6,w],o=0}finally{s=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function wE(i,t,r,s){s===void 0&&(s=r),i[s]=t[r]}function EE(i,t){for(var r in i)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=i[r])}function au(i){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&i[t],s=0;if(r)return r.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cd(i,t){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var s=r.call(i),o,c=[],f;try{for(;(t===void 0||t-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(v){f={error:v}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(f)throw f.error}}return c}function IE(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(Cd(arguments[t]));return i}function SE(){for(var i=0,t=0,r=arguments.length;t<r;t++)i+=arguments[t].length;for(var s=Array(i),o=0,t=0;t<r;t++)for(var c=arguments[t],f=0,v=c.length;f<v;f++,o++)s[o]=c[f];return s}function hs(i){return this instanceof hs?(this.v=i,this):new hs(i)}function OE(i,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(i,t||[]),o,c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(A){s[A]&&(o[A]=function(q){return new Promise(function(L,K){c.push([A,q,L,K])>1||v(A,q)})})}function v(A,q){try{O(s[A](q))}catch(L){T(c[0][3],L)}}function O(A){A.value instanceof hs?Promise.resolve(A.value.v).then(g,w):T(c[0][2],A)}function g(A){v("next",A)}function w(A){v("throw",A)}function T(A,q){A(q),c.shift(),c.length&&v(c[0][0],c[0][1])}}function xE(i){var t,r;return t={},s("next"),s("throw",function(o){throw o}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(o,c){t[o]=i[o]?function(f){return(r=!r)?{value:hs(i[o](f)),done:o==="return"}:c?c(f):f}:c}}function PE(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],r;return t?t.call(i):(i=typeof au=="function"?au(i):i[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(c){r[c]=i[c]&&function(f){return new Promise(function(v,O){f=i[c](f),o(v,O,f.done,f.value)})}}function o(c,f,v,O){Promise.resolve(O).then(function(g){c({value:g,done:v})},f)}}function TE(i,t){return Object.defineProperty?Object.defineProperty(i,"raw",{value:t}):i.raw=t,i}function NE(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var r in i)Object.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t.default=i,t}function RE(i){return i&&i.__esModule?i:{default:i}}function AE(i,t){if(!t.has(i))throw new TypeError("attempted to get private field on non-instance");return t.get(i)}function CE(i,t,r){if(!t.has(i))throw new TypeError("attempted to set private field on non-instance");return t.set(i,r),r}const $E=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return ou},__asyncDelegator:xE,__asyncGenerator:OE,__asyncValues:PE,__await:hs,__awaiter:_E,__classPrivateFieldGet:AE,__classPrivateFieldSet:CE,__createBinding:wE,__decorate:yE,__exportStar:EE,__extends:pE,__generator:bE,__importDefault:RE,__importStar:NE,__makeTemplateObject:TE,__metadata:vE,__param:mE,__read:Cd,__rest:gE,__spread:IE,__spreadArrays:SE,__values:au},Symbol.toStringTag,{value:"Module"})),DE=Ho($E);var hn={},lf;function UE(){if(lf)return hn;lf=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.isBrowserCryptoAvailable=hn.getSubtleCrypto=hn.getBrowerCrypto=void 0;function i(){return(Hr===null||Hr===void 0?void 0:Hr.crypto)||(Hr===null||Hr===void 0?void 0:Hr.msCrypto)||{}}hn.getBrowerCrypto=i;function t(){const s=i();return s.subtle||s.webkitSubtle}hn.getSubtleCrypto=t;function r(){return!!i()&&!!t()}return hn.isBrowserCryptoAvailable=r,hn}var fn={},hf;function jE(){if(hf)return fn;hf=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.isBrowser=fn.isNode=fn.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}fn.isReactNative=i;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}fn.isNode=t;function r(){return!i()&&!t()}return fn.isBrowser=r,fn}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=DE;t.__exportStar(UE(),i),t.__exportStar(jE(),i)})(Ad);function Eu(i=3){const t=Date.now()*Math.pow(10,i),r=Math.floor(Math.random()*Math.pow(10,i));return t+r}function $d(i=6){return BigInt(Eu(i))}function Ii(i,t,r){return{id:r||Eu(),jsonrpc:"2.0",method:i,params:t}}function Iu(i,t){return{id:i,jsonrpc:"2.0",result:t}}function Jo(i,t,r){return{id:i,jsonrpc:"2.0",error:LE(t,r)}}function LE(i,t){return typeof i>"u"?uf(Td):(typeof i=="string"&&(i=Object.assign(Object.assign({},uf(wu)),{message:i})),typeof t<"u"&&(i.data=t),fE(i.code)&&(i=dE(i.code)),i)}class ME{}class qE extends ME{constructor(){super()}}class FE extends qE{constructor(t){super()}}const zE="^https?:",HE="^wss?:";function BE(i){const t=i.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Dd(i,t){const r=BE(i);return typeof r>"u"?!1:new RegExp(t).test(r)}function ff(i){return Dd(i,zE)}function df(i){return Dd(i,HE)}function VE(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function Ud(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function Su(i){return Ud(i)&&"method"in i}function Qo(i){return Ud(i)&&(gn(i)||zr(i))}function gn(i){return"result"in i}function zr(i){return"error"in i}class yn extends FE{constructor(t){super(t),this.events=new Cr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Ii(t.method,t.params||[],t.id||$d().toString()),r)}async requestStrict(t,r){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${t.id}`,c=>{zr(c)?o(c.error):s(c.result)});try{await this.connection.send(t,r)}catch(c){o(c)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Qo(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const kE=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),KE=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",pf=i=>i.split("?")[0],gf=10,GE=kE();let WE=class{constructor(t){if(this.url=t,this.events=new Cr.EventEmitter,this.registering=!1,!df(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Qn(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!df(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const o=new URLSearchParams(t).get("origin"),c=Ad.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!VE(t)},f=new GE(t,[],c);KE()?f.onerror=v=>{const O=v;s(this.emitError(O.error))}:f.on("error",v=>{s(this.emitError(v))}),f.onopen=()=>{this.onOpen(f),r(f)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ds(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),c=Jo(t,o);this.events.emit("payload",c)}parseError(t,r=this.url){return Rd(t,pf(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>gf&&this.events.setMaxListeners(gf)}emitError(t){const r=this.parseError(new Error(t?.message||`WebSocket connection failed for host: ${pf(this.url)}`));return this.events.emit("register_error",r),r}};var Uo={exports:{}};Uo.exports;(function(i,t){var r=200,s="__lodash_hash_undefined__",o=1,c=2,f=9007199254740991,v="[object Arguments]",O="[object Array]",g="[object AsyncFunction]",w="[object Boolean]",T="[object Date]",A="[object Error]",q="[object Function]",L="[object GeneratorFunction]",K="[object Map]",te="[object Number]",ue="[object Null]",l="[object Object]",p="[object Promise]",_="[object Proxy]",m="[object RegExp]",y="[object Set]",N="[object String]",x="[object Symbol]",Q="[object Undefined]",se="[object WeakMap]",pe="[object ArrayBuffer]",Ae="[object DataView]",Fe="[object Float32Array]",S="[object Float64Array]",$="[object Int8Array]",ne="[object Int16Array]",de="[object Int32Array]",X="[object Uint8Array]",W="[object Uint8ClampedArray]",Y="[object Uint16Array]",Z="[object Uint32Array]",Qe=/[\\^$.*+?()[\]{}|]/g,Ve=/^\[object .+?Constructor\]$/,Vr=/^(?:0|[1-9]\d*)$/,Ie={};Ie[Fe]=Ie[S]=Ie[$]=Ie[ne]=Ie[de]=Ie[X]=Ie[W]=Ie[Y]=Ie[Z]=!0,Ie[v]=Ie[O]=Ie[pe]=Ie[w]=Ie[Ae]=Ie[T]=Ie[A]=Ie[q]=Ie[K]=Ie[te]=Ie[l]=Ie[m]=Ie[y]=Ie[N]=Ie[se]=!1;var St=typeof Hr=="object"&&Hr&&Hr.Object===Object&&Hr,H=typeof self=="object"&&self&&self.Object===Object&&self,z=St||H||Function("return this")(),M=t&&!t.nodeType&&t,h=M&&!0&&i&&!i.nodeType&&i,C=h&&h.exports===M,ae=C&&St.process,ye=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),we=ye&&ye.isTypedArray;function Ce(I,D){for(var G=-1,re=I==null?0:I.length,Ge=0,ve=[];++G<re;){var tt=I[G];D(tt,G,I)&&(ve[Ge++]=tt)}return ve}function De(I,D){for(var G=-1,re=D.length,Ge=I.length;++G<re;)I[Ge+G]=D[G];return I}function xe(I,D){for(var G=-1,re=I==null?0:I.length;++G<re;)if(D(I[G],G,I))return!0;return!1}function Ot(I,D){for(var G=-1,re=Array(I);++G<I;)re[G]=D(G);return re}function _t(I){return function(D){return I(D)}}function at(I,D){return I.has(D)}function je(I,D){return I?.[D]}function Xe(I){var D=-1,G=Array(I.size);return I.forEach(function(re,Ge){G[++D]=[Ge,re]}),G}function Ze(I,D){return function(G){return I(D(G))}}function ct(I){var D=-1,G=Array(I.size);return I.forEach(function(re){G[++D]=re}),G}var ze=Array.prototype,et=Function.prototype,$e=Object.prototype,ke=z["__core-js_shared__"],ht=et.toString,Me=$e.hasOwnProperty,xt=function(){var I=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return I?"Symbol(src)_1."+I:""}(),Dt=$e.toString,zt=RegExp("^"+ht.call(Me).replace(Qe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=C?z.Buffer:void 0,Lt=z.Symbol,Yt=z.Uint8Array,or=$e.propertyIsEnumerable,kr=ze.splice,Xt=Lt?Lt.toStringTag:void 0,Xr=Object.getOwnPropertySymbols,vn=Ht?Ht.isBuffer:void 0,Cn=Ze(Object.keys,Object),ft=pr(z,"DataView"),nt=pr(z,"Map"),dt=pr(z,"Promise"),pt=pr(z,"Set"),ut=pr(z,"WeakMap"),it=pr(Object,"create"),Pt=en(ft),Tt=en(nt),gt=en(dt),Nt=en(pt),yt=en(ut),bt=Lt?Lt.prototype:void 0,mt=bt?bt.valueOf:void 0;function Ye(I){var D=-1,G=I==null?0:I.length;for(this.clear();++D<G;){var re=I[D];this.set(re[0],re[1])}}function Rt(){this.__data__=it?it(null):{},this.size=0}function At(I){var D=this.has(I)&&delete this.__data__[I];return this.size-=D?1:0,D}function ea(I){var D=this.__data__;if(it){var G=D[I];return G===s?void 0:G}return Me.call(D,I)?D[I]:void 0}function ta(I){var D=this.__data__;return it?D[I]!==void 0:Me.call(D,I)}function ra(I,D){var G=this.__data__;return this.size+=this.has(I)?0:1,G[I]=it&&D===void 0?s:D,this}Ye.prototype.clear=Rt,Ye.prototype.delete=At,Ye.prototype.get=ea,Ye.prototype.has=ta,Ye.prototype.set=ra;function wr(I){var D=-1,G=I==null?0:I.length;for(this.clear();++D<G;){var re=I[D];this.set(re[0],re[1])}}function na(){this.__data__=[],this.size=0}function ia(I){var D=this.__data__,G=$n(D,I);if(G<0)return!1;var re=D.length-1;return G==re?D.pop():kr.call(D,G,1),--this.size,!0}function sa(I){var D=this.__data__,G=$n(D,I);return G<0?void 0:D[G][1]}function oa(I){return $n(this.__data__,I)>-1}function aa(I,D){var G=this.__data__,re=$n(G,I);return re<0?(++this.size,G.push([I,D])):G[re][1]=D,this}wr.prototype.clear=na,wr.prototype.delete=ia,wr.prototype.get=sa,wr.prototype.has=oa,wr.prototype.set=aa;function Zr(I){var D=-1,G=I==null?0:I.length;for(this.clear();++D<G;){var re=I[D];this.set(re[0],re[1])}}function ei(){this.size=0,this.__data__={hash:new Ye,map:new(nt||wr),string:new Ye}}function ca(I){var D=_n(this,I).delete(I);return this.size-=D?1:0,D}function ti(I){return _n(this,I).get(I)}function ua(I){return _n(this,I).has(I)}function la(I,D){var G=_n(this,I),re=G.size;return G.set(I,D),this.size+=G.size==re?0:1,this}Zr.prototype.clear=ei,Zr.prototype.delete=ca,Zr.prototype.get=ti,Zr.prototype.has=ua,Zr.prototype.set=la;function ri(I){var D=-1,G=I==null?0:I.length;for(this.__data__=new Zr;++D<G;)this.add(I[D])}function ys(I){return this.__data__.set(I,s),this}function ms(I){return this.__data__.has(I)}ri.prototype.add=ri.prototype.push=ys,ri.prototype.has=ms;function $r(I){var D=this.__data__=new wr(I);this.size=D.size}function ha(){this.__data__=new wr,this.size=0}function fa(I){var D=this.__data__,G=D.delete(I);return this.size=D.size,G}function da(I){return this.__data__.get(I)}function pa(I){return this.__data__.has(I)}function vs(I,D){var G=this.__data__;if(G instanceof wr){var re=G.__data__;if(!nt||re.length<r-1)return re.push([I,D]),this.size=++G.size,this;G=this.__data__=new Zr(re)}return G.set(I,D),this.size=G.size,this}$r.prototype.clear=ha,$r.prototype.delete=fa,$r.prototype.get=da,$r.prototype.has=pa,$r.prototype.set=vs;function _s(I,D){var G=si(I),re=!G&&As(I),Ge=!G&&!re&&Ri(I),ve=!G&&!re&&!Ge&&Ds(I),tt=G||re||Ge||ve,Ct=tt?Ot(I.length,String):[],Te=Ct.length;for(var We in I)(D||Me.call(I,We))&&!(tt&&(We=="length"||Ge&&(We=="offset"||We=="parent")||ve&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||xs(We,Te)))&&Ct.push(We);return Ct}function $n(I,D){for(var G=I.length;G--;)if(Rs(I[G][0],D))return G;return-1}function Ti(I,D,G){var re=D(I);return si(I)?re:De(re,G(I))}function Dn(I){return I==null?I===void 0?Q:ue:Xt&&Xt in Object(I)?Ss(I):ma(I)}function Ni(I){return jn(I)&&Dn(I)==v}function Un(I,D,G,re,Ge){return I===D?!0:I==null||D==null||!jn(I)&&!jn(D)?I!==I&&D!==D:bs(I,D,G,re,Un,Ge)}function bs(I,D,G,re,Ge,ve){var tt=si(I),Ct=si(D),Te=tt?O:Kr(I),We=Ct?O:Kr(D);Te=Te==v?l:Te,We=We==v?l:We;var wt=Te==l,ar=We==l,$t=Te==We;if($t&&Ri(I)){if(!Ri(D))return!1;tt=!0,wt=!1}if($t&&!wt)return ve||(ve=new $r),tt||Ds(I)?ni(I,D,G,re,Ge,ve):ya(I,D,Te,G,re,Ge,ve);if(!(G&o)){var rt=wt&&Me.call(I,"__wrapped__"),Zt=ar&&Me.call(D,"__wrapped__");if(rt||Zt){var Dr=rt?I.value():I,Er=Zt?D.value():D;return ve||(ve=new $r),Ge(Dr,Er,G,re,ve)}}return $t?(ve||(ve=new $r),Is(I,D,G,re,Ge,ve)):!1}function ga(I){if(!$s(I)||Ts(I))return!1;var D=oi(I)?zt:Ve;return D.test(en(I))}function ws(I){return jn(I)&&Cs(I.length)&&!!Ie[Dn(I)]}function Es(I){if(!Ns(I))return Cn(I);var D=[];for(var G in Object(I))Me.call(I,G)&&G!="constructor"&&D.push(G);return D}function ni(I,D,G,re,Ge,ve){var tt=G&o,Ct=I.length,Te=D.length;if(Ct!=Te&&!(tt&&Te>Ct))return!1;var We=ve.get(I);if(We&&ve.get(D))return We==D;var wt=-1,ar=!0,$t=G&c?new ri:void 0;for(ve.set(I,D),ve.set(D,I);++wt<Ct;){var rt=I[wt],Zt=D[wt];if(re)var Dr=tt?re(Zt,rt,wt,D,I,ve):re(rt,Zt,wt,I,D,ve);if(Dr!==void 0){if(Dr)continue;ar=!1;break}if($t){if(!xe(D,function(Er,Gr){if(!at($t,Gr)&&(rt===Er||Ge(rt,Er,G,re,ve)))return $t.push(Gr)})){ar=!1;break}}else if(!(rt===Zt||Ge(rt,Zt,G,re,ve))){ar=!1;break}}return ve.delete(I),ve.delete(D),ar}function ya(I,D,G,re,Ge,ve,tt){switch(G){case Ae:if(I.byteLength!=D.byteLength||I.byteOffset!=D.byteOffset)return!1;I=I.buffer,D=D.buffer;case pe:return!(I.byteLength!=D.byteLength||!ve(new Yt(I),new Yt(D)));case w:case T:case te:return Rs(+I,+D);case A:return I.name==D.name&&I.message==D.message;case m:case N:return I==D+"";case K:var Ct=Xe;case y:var Te=re&o;if(Ct||(Ct=ct),I.size!=D.size&&!Te)return!1;var We=tt.get(I);if(We)return We==D;re|=c,tt.set(I,D);var wt=ni(Ct(I),Ct(D),re,Ge,ve,tt);return tt.delete(I),wt;case x:if(mt)return mt.call(I)==mt.call(D)}return!1}function Is(I,D,G,re,Ge,ve){var tt=G&o,Ct=ii(I),Te=Ct.length,We=ii(D),wt=We.length;if(Te!=wt&&!tt)return!1;for(var ar=Te;ar--;){var $t=Ct[ar];if(!(tt?$t in D:Me.call(D,$t)))return!1}var rt=ve.get(I);if(rt&&ve.get(D))return rt==D;var Zt=!0;ve.set(I,D),ve.set(D,I);for(var Dr=tt;++ar<Te;){$t=Ct[ar];var Er=I[$t],Gr=D[$t];if(re)var Ai=tt?re(Gr,Er,$t,D,I,ve):re(Er,Gr,$t,I,D,ve);if(!(Ai===void 0?Er===Gr||Ge(Er,Gr,G,re,ve):Ai)){Zt=!1;break}Dr||(Dr=$t=="constructor")}if(Zt&&!Dr){var Ln=I.constructor,Mt=D.constructor;Ln!=Mt&&"constructor"in I&&"constructor"in D&&!(typeof Ln=="function"&&Ln instanceof Ln&&typeof Mt=="function"&&Mt instanceof Mt)&&(Zt=!1)}return ve.delete(I),ve.delete(D),Zt}function ii(I){return Ti(I,ba,Os)}function _n(I,D){var G=I.__data__;return Ps(D)?G[typeof D=="string"?"string":"hash"]:G.map}function pr(I,D){var G=je(I,D);return ga(G)?G:void 0}function Ss(I){var D=Me.call(I,Xt),G=I[Xt];try{I[Xt]=void 0;var re=!0}catch{}var Ge=Dt.call(I);return re&&(D?I[Xt]=G:delete I[Xt]),Ge}var Os=Xr?function(I){return I==null?[]:(I=Object(I),Ce(Xr(I),function(D){return or.call(I,D)}))}:Ke,Kr=Dn;(ft&&Kr(new ft(new ArrayBuffer(1)))!=Ae||nt&&Kr(new nt)!=K||dt&&Kr(dt.resolve())!=p||pt&&Kr(new pt)!=y||ut&&Kr(new ut)!=se)&&(Kr=function(I){var D=Dn(I),G=D==l?I.constructor:void 0,re=G?en(G):"";if(re)switch(re){case Pt:return Ae;case Tt:return K;case gt:return p;case Nt:return y;case yt:return se}return D});function xs(I,D){return D=D??f,!!D&&(typeof I=="number"||Vr.test(I))&&I>-1&&I%1==0&&I<D}function Ps(I){var D=typeof I;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?I!=="__proto__":I===null}function Ts(I){return!!xt&&xt in I}function Ns(I){var D=I&&I.constructor,G=typeof D=="function"&&D.prototype||$e;return I===G}function ma(I){return Dt.call(I)}function en(I){if(I!=null){try{return ht.call(I)}catch{}try{return I+""}catch{}}return""}function Rs(I,D){return I===D||I!==I&&D!==D}var As=Ni(function(){return arguments}())?Ni:function(I){return jn(I)&&Me.call(I,"callee")&&!or.call(I,"callee")},si=Array.isArray;function va(I){return I!=null&&Cs(I.length)&&!oi(I)}var Ri=vn||He;function _a(I,D){return Un(I,D)}function oi(I){if(!$s(I))return!1;var D=Dn(I);return D==q||D==L||D==g||D==_}function Cs(I){return typeof I=="number"&&I>-1&&I%1==0&&I<=f}function $s(I){var D=typeof I;return I!=null&&(D=="object"||D=="function")}function jn(I){return I!=null&&typeof I=="object"}var Ds=we?_t(we):ws;function ba(I){return va(I)?_s(I):Es(I)}function Ke(){return[]}function He(){return!1}i.exports=_a})(Uo,Uo.exports);var JE=Uo.exports;const QE=od(JE);var YE={};function XE(i,t){if(i.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),f=c.charCodeAt(0);if(r[f]!==255)throw new TypeError(c+" is ambiguous");r[f]=o}var v=i.length,O=i.charAt(0),g=Math.log(v)/Math.log(256),w=Math.log(256)/Math.log(v);function T(L){if(L instanceof Uint8Array||(ArrayBuffer.isView(L)?L=new Uint8Array(L.buffer,L.byteOffset,L.byteLength):Array.isArray(L)&&(L=Uint8Array.from(L))),!(L instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(L.length===0)return"";for(var K=0,te=0,ue=0,l=L.length;ue!==l&&L[ue]===0;)ue++,K++;for(var p=(l-ue)*w+1>>>0,_=new Uint8Array(p);ue!==l;){for(var m=L[ue],y=0,N=p-1;(m!==0||y<te)&&N!==-1;N--,y++)m+=256*_[N]>>>0,_[N]=m%v>>>0,m=m/v>>>0;if(m!==0)throw new Error("Non-zero carry");te=y,ue++}for(var x=p-te;x!==p&&_[x]===0;)x++;for(var Q=O.repeat(K);x<p;++x)Q+=i.charAt(_[x]);return Q}function A(L){if(typeof L!="string")throw new TypeError("Expected String");if(L.length===0)return new Uint8Array;var K=0;if(L[K]!==" "){for(var te=0,ue=0;L[K]===O;)te++,K++;for(var l=(L.length-K)*g+1>>>0,p=new Uint8Array(l);L[K];){var _=r[L.charCodeAt(K)];if(_===255)return;for(var m=0,y=l-1;(_!==0||m<ue)&&y!==-1;y--,m++)_+=v*p[y]>>>0,p[y]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");ue=m,K++}if(L[K]!==" "){for(var N=l-ue;N!==l&&p[N]===0;)N++;for(var x=new Uint8Array(te+(l-N)),Q=te;N!==l;)x[Q++]=p[N++];return x}}}function q(L){var K=A(L);if(K)return K;throw new Error(`Non-${t} character`)}return{encode:T,decodeUnsafe:A,decode:q}}var ZE=XE,eI=ZE;const jd=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},tI=i=>new TextEncoder().encode(i),rI=i=>new TextDecoder().decode(i);class nI{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class iI{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Ld(this,t)}}let sI=class{constructor(t){this.decoders=t}or(t){return Ld(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const Ld=(i,t)=>new sI({...i.decoders||{[i.prefix]:i},...t.decoders||{[t.prefix]:t}});class oI{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new nI(t,r,s),this.decoder=new iI(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Yo=({name:i,prefix:t,encode:r,decode:s})=>new oI(i,t,r,s),gs=({prefix:i,name:t,alphabet:r})=>{const{encode:s,decode:o}=eI(r,t);return Yo({prefix:i,name:t,encode:s,decode:c=>jd(o(c))})},aI=(i,t,r,s)=>{const o={};for(let w=0;w<t.length;++w)o[t[w]]=w;let c=i.length;for(;i[c-1]==="=";)--c;const f=new Uint8Array(c*r/8|0);let v=0,O=0,g=0;for(let w=0;w<c;++w){const T=o[i[w]];if(T===void 0)throw new SyntaxError(`Non-${s} character`);O=O<<r|T,v+=r,v>=8&&(v-=8,f[g++]=255&O>>v)}if(v>=r||255&O<<8-v)throw new SyntaxError("Unexpected end of data");return f},cI=(i,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let c="",f=0,v=0;for(let O=0;O<i.length;++O)for(v=v<<8|i[O],f+=8;f>r;)f-=r,c+=t[o&v>>f];if(f&&(c+=t[o&v<<r-f]),s)for(;c.length*r&7;)c+="=";return c},kt=({name:i,prefix:t,bitsPerChar:r,alphabet:s})=>Yo({prefix:t,name:i,encode(o){return cI(o,s,r)},decode(o){return aI(o,s,r,i)}}),uI=Yo({prefix:"\0",name:"identity",encode:i=>rI(i),decode:i=>tI(i)});var lI=Object.freeze({__proto__:null,identity:uI});const hI=kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var fI=Object.freeze({__proto__:null,base2:hI});const dI=kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var pI=Object.freeze({__proto__:null,base8:dI});const gI=gs({prefix:"9",name:"base10",alphabet:"0123456789"});var yI=Object.freeze({__proto__:null,base10:gI});const mI=kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),vI=kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var _I=Object.freeze({__proto__:null,base16:mI,base16upper:vI});const bI=kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),wI=kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),EI=kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),II=kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),SI=kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),OI=kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),xI=kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),PI=kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),TI=kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var NI=Object.freeze({__proto__:null,base32:bI,base32upper:wI,base32pad:EI,base32padupper:II,base32hex:SI,base32hexupper:OI,base32hexpad:xI,base32hexpadupper:PI,base32z:TI});const RI=gs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),AI=gs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var CI=Object.freeze({__proto__:null,base36:RI,base36upper:AI});const $I=gs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),DI=gs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var UI=Object.freeze({__proto__:null,base58btc:$I,base58flickr:DI});const jI=kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),LI=kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),MI=kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qI=kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var FI=Object.freeze({__proto__:null,base64:jI,base64pad:LI,base64url:MI,base64urlpad:qI});const Md=Array.from(""),zI=Md.reduce((i,t,r)=>(i[r]=t,i),[]),HI=Md.reduce((i,t,r)=>(i[t.codePointAt(0)]=r,i),[]);function BI(i){return i.reduce((t,r)=>(t+=zI[r],t),"")}function VI(i){const t=[];for(const r of i){const s=HI[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const kI=Yo({prefix:"",name:"base256emoji",encode:BI,decode:VI});var KI=Object.freeze({__proto__:null,base256emoji:kI}),GI=qd,yf=128,WI=127,JI=~WI,QI=Math.pow(2,31);function qd(i,t,r){t=t||[],r=r||0;for(var s=r;i>=QI;)t[r++]=i&255|yf,i/=128;for(;i&JI;)t[r++]=i&255|yf,i>>>=7;return t[r]=i|0,qd.bytes=r-s+1,t}var YI=cu,XI=128,mf=127;function cu(i,s){var r=0,s=s||0,o=0,c=s,f,v=i.length;do{if(c>=v)throw cu.bytes=0,new RangeError("Could not decode varint");f=i[c++],r+=o<28?(f&mf)<<o:(f&mf)*Math.pow(2,o),o+=7}while(f>=XI);return cu.bytes=c-s,r}var ZI=Math.pow(2,7),eS=Math.pow(2,14),tS=Math.pow(2,21),rS=Math.pow(2,28),nS=Math.pow(2,35),iS=Math.pow(2,42),sS=Math.pow(2,49),oS=Math.pow(2,56),aS=Math.pow(2,63),cS=function(i){return i<ZI?1:i<eS?2:i<tS?3:i<rS?4:i<nS?5:i<iS?6:i<sS?7:i<oS?8:i<aS?9:10},uS={encode:GI,decode:YI,encodingLength:cS},Fd=uS;const vf=(i,t,r=0)=>(Fd.encode(i,t,r),t),_f=i=>Fd.encodingLength(i),uu=(i,t)=>{const r=t.byteLength,s=_f(i),o=s+_f(r),c=new Uint8Array(o+r);return vf(i,c,0),vf(r,c,s),c.set(t,o),new lS(i,r,t,c)};let lS=class{constructor(t,r,s,o){this.code=t,this.size=r,this.digest=s,this.bytes=o}};const zd=({name:i,code:t,encode:r})=>new hS(i,t,r);class hS{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?uu(this.code,r):r.then(s=>uu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Hd=i=>async t=>new Uint8Array(await crypto.subtle.digest(i,t)),fS=zd({name:"sha2-256",code:18,encode:Hd("SHA-256")}),dS=zd({name:"sha2-512",code:19,encode:Hd("SHA-512")});var pS=Object.freeze({__proto__:null,sha256:fS,sha512:dS});const Bd=0,gS="identity",Vd=jd,yS=i=>uu(Bd,Vd(i)),mS={code:Bd,name:gS,encode:Vd,digest:yS};var vS=Object.freeze({__proto__:null,identity:mS});new TextEncoder,new TextDecoder;const bf={...lI,...fI,...pI,...yI,..._I,...NI,...CI,...UI,...FI,...KI};({...pS,...vS});function kd(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function _S(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?kd(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Kd(i,t,r,s){return{name:i,prefix:t,encoder:{name:i,prefix:t,encode:r},decoder:{decode:s}}}const wf=Kd("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),$c=Kd("ascii","a",i=>{let t="a";for(let r=0;r<i.length;r++)t+=String.fromCharCode(i[r]);return t},i=>{i=i.substring(1);const t=_S(i.length);for(let r=0;r<i.length;r++)t[r]=i.charCodeAt(r);return t}),bS={utf8:wf,"utf-8":wf,hex:bf.base16,latin1:$c,ascii:$c,binary:$c,...bf};function wS(i,t="utf8"){const r=bS[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?kd(globalThis.Buffer.from(i,"utf-8")):r.decoder.decode(`${r.prefix}${i}`)}const Gd="wc",ES=2,Ou="core",Nn=`${Gd}@2:${Ou}:`,IS={name:Ou,logger:"error"},SS={database:":memory:"},OS="crypto",Ef="client_ed25519_seed",xS=oe.ONE_DAY,PS="keychain",TS="0.3",NS="messages",RS="0.3",AS=oe.SIX_HOURS,CS="publisher",Wd="irn",$S="error",Jd="wss://relay.walletconnect.com",If="wss://relay.walletconnect.org",DS="relayer",Wt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},US="_subscription",dn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},jS=oe.ONE_SECOND,LS="2.10.6",MS=1e4,qS="0.3",FS="WALLETCONNECT_CLIENT_ID",Fr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},zS="subscription",HS="0.3",BS=oe.FIVE_SECONDS*1e3,VS="pairing",kS="0.3",Ji={wc_pairingDelete:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:0},res:{ttl:oe.ONE_DAY,prompt:!1,tag:0}}},rs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Yr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},KS="history",GS="0.3",WS="expirer",Rr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},JS="0.3",Dc="verify-api",wi="https://verify.walletconnect.com",lu="https://verify.walletconnect.org",QS=[wi,lu];class YS{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=PS,this.version=TS,this.initialized=!1,this.storagePrefix=Nn,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=Be("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Sd(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Od(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Be("NOT_INITIALIZED",this.name);throw new Error(t)}}}class XS{constructor(t,r,s){this.core=t,this.logger=r,this.name=OS,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=Yh(o);return bd(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=m1();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),f=Yh(c),v=ru();return await g1(v,o,xS,f)},this.generateSharedKey=(o,c,f)=>{this.isInitialized();const v=this.getPrivateKey(o),O=v1(v,c);return this.setSymKey(O,f)},this.setSymKey=async(o,c)=>{this.isInitialized();const f=c||_1(o);return await this.keychain.set(f,o),f},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,f)=>{this.isInitialized();const v=Id(f),O=Qn(c);if(Zh(v)){const A=v.senderPublicKey,q=v.receiverPublicKey;o=await this.generateSharedKey(A,q)}const g=this.getSymKey(o),{type:w,senderPublicKey:T}=v;return w1({type:w,symKey:g,message:O,senderPublicKey:T})},this.decode=async(o,c,f)=>{this.isInitialized();const v=S1(c,f);if(Zh(v)){const O=v.receiverPublicKey,g=v.senderPublicKey;o=await this.generateSharedKey(O,g)}try{const O=this.getSymKey(o),g=E1({symKey:O,encoded:c});return ds(g)}catch(O){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(O)}},this.getPayloadType=o=>{const c=$o(o);return ps(c.type)},this.getPayloadSenderPublicKey=o=>{const c=$o(o);return c.senderPublicKey?Qt(c.senderPublicKey,sr):void 0},this.core=t,this.logger=Re.generateChildLogger(r,this.name),this.keychain=s||new YS(this.core,this.logger)}get context(){return Re.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Ef)}catch{t=ru(),await this.keychain.set(Ef,t)}return wS(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Be("NOT_INITIALIZED",this.name);throw new Error(t)}}}class ZS extends Gw{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=NS,this.version=RS,this.initialized=!1,this.storagePrefix=Nn,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=nu(o);let f=this.messages.get(s);return typeof f>"u"&&(f={}),typeof f[c]<"u"||(f[c]=o,this.messages.set(s,f),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),f=nu(o);return typeof c[f]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Re.generateChildLogger(t,this.name),this.core=r}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Sd(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Od(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=Be("NOT_INITIALIZED",this.name);throw new Error(t)}}}class eO extends Ww{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Cr.EventEmitter,this.name=CS,this.queue=new Map,this.publishTimeout=oe.toMiliseconds(oe.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const v=c?.ttl||AS,O=iu(c),g=c?.prompt||!1,w=c?.tag||0,T=c?.id||$d().toString(),A={topic:s,message:o,opts:{ttl:v,relay:O,prompt:g,tag:w,id:T}},q=setTimeout(()=>this.queue.set(T,A),this.publishTimeout);try{await await ls(this.rpcPublish(s,o,v,O,g,w,T),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(T),this.relayer.events.emit(Wt.publish,A)}catch(L){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=c?.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(T),L;return}finally{clearTimeout(q)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(v){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(v),v}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=Re.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Re.getLoggerContext(this.logger)}rpcPublish(t,r,s,o,c,f,v){var O,g,w,T;const A={method:Ro(o.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:c,tag:f},id:v};return Do((O=A.params)==null?void 0:O.prompt)&&((g=A.params)==null||delete g.prompt),Do((w=A.params)==null?void 0:w.tag)&&((T=A.params)==null||delete T.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:A}),this.relayer.request(A)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:o}=t;await this.publish(r,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Si.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Wt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Wt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class tO{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const o=s.filter(c=>c!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var rO=Object.defineProperty,nO=Object.defineProperties,iO=Object.getOwnPropertyDescriptors,Sf=Object.getOwnPropertySymbols,sO=Object.prototype.hasOwnProperty,oO=Object.prototype.propertyIsEnumerable,Of=(i,t,r)=>t in i?rO(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,Qi=(i,t)=>{for(var r in t||(t={}))sO.call(t,r)&&Of(i,r,t[r]);if(Sf)for(var r of Sf(t))oO.call(t,r)&&Of(i,r,t[r]);return i},Uc=(i,t)=>nO(i,iO(t));class aO extends Yw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new tO,this.events=new Cr.EventEmitter,this.name=zS,this.version=HS,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Nn,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=iu(o),f={topic:s,relay:c};this.pending.set(s,f);const v=await this.rpcSubscribe(s,c);return this.onSubscribe(v,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),v}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof o?.id<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,c)=>{const f=new oe.Watch;f.start(this.pendingSubscriptionWatchLabel);const v=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(v),f.stop(this.pendingSubscriptionWatchLabel),o(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=BS&&(clearInterval(v),f.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Re.generateChildLogger(r,this.name),this.clientId=""}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const o=iu(s);await this.rpcUnsubscribe(t,r,o);const c=ts("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const s={method:Ro(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await ls(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Wt.connection_stalled)}return nu(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:Ro(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await ls(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Wt.connection_stalled)}}rpcUnsubscribe(t,r,s){const o={method:Ro(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,Uc(Qi({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Qi({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Qi({},r)),this.topicMap.set(r.topic,t),this.events.emit(Fr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=Be("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(Fr.deleted,Uc(Qi({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Fr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Fr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=Be("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);Y1(r)&&this.onBatchSubscribe(r.map((s,o)=>Uc(Qi({},t[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Si.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Wt.connect,async()=>{await this.onConnect()}),this.relayer.on(Wt.disconnect,()=>{this.onDisconnect()}),this.events.on(Fr.created,async t=>{const r=Fr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Fr.deleted,async t=>{const r=Fr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Be("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var cO=Object.defineProperty,xf=Object.getOwnPropertySymbols,uO=Object.prototype.hasOwnProperty,lO=Object.prototype.propertyIsEnumerable,Pf=(i,t,r)=>t in i?cO(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,hO=(i,t)=>{for(var r in t||(t={}))uO.call(t,r)&&Pf(i,r,t[r]);if(xf)for(var r of xf(t))lO.call(t,r)&&Pf(i,r,t[r]);return i};class fO extends Jw{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Cr.EventEmitter,this.name=DS,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Wt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Wt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(dn.payload,this.onPayloadHandler),this.provider.on(dn.connect,this.onConnectHandler),this.provider.on(dn.disconnect,this.onDisconnectHandler),this.provider.on(dn.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Re.generateChildLogger(t.logger,this.name):Re.pino(Re.getDefaultLoggerOptions({level:t.logger||$S})),this.messages=new ZS(this.logger,t.core),this.subscriber=new aO(this,this.logger),this.publisher=new eO(this,this.logger),this.relayUrl=t?.relayUrl||Jd,this.projectId=t.projectId,this.bundleId=R1(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${If}...`),await this.restartTransport(If)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},MS)}get context(){return Re.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";if(o)return o;let c;const f=v=>{v.topic===t&&(this.subscriber.off(Fr.created,f),c())};return await Promise.all([new Promise(v=>{c=v,this.subscriber.on(Fr.created,f)}),new Promise(async v=>{o=await this.subscriber.subscribe(t,r),v()})]),o}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await ls(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Fr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await ls(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(dn.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await cf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new yn(new WE(U1({sdkVersion:LS,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const o=this.messages.has(r,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Su(t)){if(!t.method.endsWith(US))return;const r=t.params,{topic:s,message:o,publishedAt:c}=r.data,f={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(hO({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(t),await this.onMessageEvent(f)}else Qo(t)&&this.events.emit(Wt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Wt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Iu(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(dn.payload,this.onPayloadHandler),this.provider.off(dn.connect,this.onConnectHandler),this.provider.off(dn.disconnect,this.onDisconnectHandler),this.provider.off(dn.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Wt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await cf();iE(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Wt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},oe.toMiliseconds(jS)))}isInitialized(){if(!this.initialized){const{message:t}=Be("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var dO=Object.defineProperty,Tf=Object.getOwnPropertySymbols,pO=Object.prototype.hasOwnProperty,gO=Object.prototype.propertyIsEnumerable,Nf=(i,t,r)=>t in i?dO(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,Rf=(i,t)=>{for(var r in t||(t={}))pO.call(t,r)&&Nf(i,r,t[r]);if(Tf)for(var r of Tf(t))gO.call(t,r)&&Nf(i,r,t[r]);return i};class Xo extends Qw{constructor(t,r,s,o=Nn,c=void 0){super(t,r,s,o),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=qS,this.cached=[],this.initialized=!1,this.storagePrefix=Nn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!Do(f)?this.map.set(this.getKey(f),f):Z1(f)?this.map.set(f.id,f):eE(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,v)=>{this.isInitialized(),this.map.has(f)?await this.update(f,v):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:v}),this.map.set(f,v),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(v=>Object.keys(f).every(O=>QE(v[O],f[O]))):this.values),this.update=async(f,v)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:v});const O=Rf(Rf({},this.getData(f)),v);this.map.set(f,O),await this.persist()},this.delete=async(f,v)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:v}),this.map.delete(f),await this.persist())},this.logger=Re.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=Be("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=Be("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Be("NOT_INITIALIZED",this.name);throw new Error(t)}}}class yO{constructor(t,r){this.core=t,this.logger=r,this.name=VS,this.version=kS,this.events=new gu,this.initialized=!1,this.storagePrefix=Nn,this.ignoredPayloadTypes=[Oi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=ru(),o=await this.core.crypto.setSymKey(s),c=No(oe.FIVE_MINUTES),f={protocol:Wd},v={topic:o,expiry:c,relay:f,active:!1},O=W1({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:f});return await this.pairings.set(o,v),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:O}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:f}=af(s.uri);let v;if(this.pairings.keys.includes(o)&&(v=this.pairings.get(o),v.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const O=No(oe.FIVE_MINUTES),g={topic:o,relay:f,expiry:O,active:!1};return await this.pairings.set(o,g),this.core.expirer.set(o,O),s.activatePairing&&await this.activate({topic:o}),this.events.emit(rs.create,g),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:f})),g},this.activate=async({topic:s})=>{this.isInitialized();const o=No(oe.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:f,resolve:v,reject:O}=j1();this.events.once(Ac("pairing_ping",c),({error:g})=>{g?O(g):v()}),await f()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",ts("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const f=Ii(o,c),v=await this.core.crypto.encode(s,f),O=Ji[o].req;return this.core.history.set(s,f),this.core.relayer.publish(s,v,O),f.id},this.sendResult=async(s,o,c)=>{const f=Iu(s,c),v=await this.core.crypto.encode(o,f),O=await this.core.history.get(o,s),g=Ji[O.request.method].res;await this.core.relayer.publish(o,v,g),await this.core.history.resolve(f)},this.sendError=async(s,o,c)=>{const f=Jo(s,c),v=await this.core.crypto.encode(o,f),O=await this.core.history.get(o,s),g=Ji[O.request.method]?Ji[O.request.method].res:Ji.unregistered_method.res;await this.core.relayer.publish(o,v,g),await this.core.history.resolve(f)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,ts("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>nf(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,f=(await this.core.history.get(o,c.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(rs.ping,{id:c,topic:s})}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{gn(o)?this.events.emit(Ac("pairing_ping",c),{}):zr(o)&&this.events.emit(Ac("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(rs.delete,{id:c,topic:s})}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:f}=o;try{if(this.registeredMethods.includes(f))return;const v=ts("WC_METHOD_UNSUPPORTED",f);await this.sendError(c,s,v),this.logger.error(v)}catch(v){await this.sendError(c,s,v),this.logger.error(v)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(ts("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!Cc(s)){const{message:f}=Be("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(f)}if(!X1(s.uri)){const{message:f}=Be("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(f)}const c=af(s.uri);if(!((o=c?.relay)!=null&&o.protocol)){const{message:f}=Be("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(c!=null&&c.symKey)){const{message:f}=Be("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async s=>{if(!Cc(s)){const{message:c}=Be("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!Cc(s)){const{message:c}=Be("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Pd(s,!1)){const{message:o}=Be("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=Be("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(nf(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=Be("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=t,this.logger=Re.generateChildLogger(r,this.name),this.pairings=new Xo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Re.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Be("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Wt.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(r,s);try{Su(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Qo(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Rr.expired,async t=>{const{topic:r}=q1(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(rs.expire,{topic:r}))})}}let mO=class extends Kw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Cr.EventEmitter,this.name=KS,this.version=GS,this.cached=[],this.initialized=!1,this.storagePrefix=Nn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const f={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:No(oe.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Yr.created,f)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=zr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Yr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(Yr.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Ii(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=Be("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Yr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=Be("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Yr.created,t=>{const r=Yr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Yr.updated,t=>{const r=Yr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Yr.deleted,t=>{const r=Yr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Si.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{oe.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=Be("NOT_INITIALIZED",this.name);throw new Error(t)}}},vO=class extends Xw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Cr.EventEmitter,this.name=WS,this.version=JS,this.cached=[],this.initialized=!1,this.storagePrefix=Nn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),f={target:c,expiry:o};this.expirations.set(c,f),this.checkExpiry(c,f),this.events.emit(Rr.created,{target:c,expiration:f})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Rr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return L1(t);if(typeof t=="number")return M1(t);const{message:r}=Be("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Rr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=Be("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=Be("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;oe.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Rr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Si.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Rr.created,t=>{const r=Rr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Rr.expired,t=>{const r=Rr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Rr.deleted,t=>{const r=Rr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Be("NOT_INITIALIZED",this.name);throw new Error(t)}}};class _O extends Zw{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Dc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||xi()||!Go())return;const o=this.getVerifyUrl(s?.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=lu;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s?.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(f){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(f),c=await this.fetchAttestation(s.attestationId,lu)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(oe.ONE_SECOND*2),f=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),f.status===200?await f.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(Dc))return c();window.addEventListener("message",o);const f=document.createElement("iframe");f.id=Dc,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,s=c}),new Promise((c,f)=>setTimeout(()=>{window.removeEventListener("message",o),f("verify iframe load timeout")},oe.toMiliseconds(oe.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||wi;return QS.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${wi}`),o=wi),o},this.logger=Re.generateChildLogger(r,this.name),this.verifyUrl=wi,this.abortController=new AbortController,this.isDevEnv=bu()&&YE.IS_VITEST}get context(){return Re.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),oe.toMiliseconds(t))}}var bO=Object.defineProperty,Af=Object.getOwnPropertySymbols,wO=Object.prototype.hasOwnProperty,EO=Object.prototype.propertyIsEnumerable,Cf=(i,t,r)=>t in i?bO(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,$f=(i,t)=>{for(var r in t||(t={}))wO.call(t,r)&&Cf(i,r,t[r]);if(Af)for(var r of Af(t))EO.call(t,r)&&Cf(i,r,t[r]);return i};let IO=class Qd extends kw{constructor(t){super(t),this.protocol=Gd,this.version=ES,this.name=Ou,this.events=new Cr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||Jd,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:t?.logger||IS.logger}));this.logger=Re.generateChildLogger(r,this.name),this.heartbeat=new Si.HeartBeat,this.crypto=new XS(this,this.logger,t?.keychain),this.history=new mO(this,this.logger),this.expirer=new vO(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Jb($f($f({},SS),t?.storageOptions)),this.relayer=new fO({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new yO(this,this.logger),this.verify=new _O(this.projectId||"",this.logger)}static async init(t){const r=new Qd(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(FS,s),r}get context(){return Re.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}};const SO=IO;var OO={};(function(i){const t=Fo,r=zo,s=Mo,o=qo,c=l=>l==null,f=Symbol("encodeFragmentIdentifier");function v(l){switch(l.arrayFormat){case"index":return p=>(_,m)=>{const y=_.length;return m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,[w(p,l),"[",y,"]"].join("")]:[..._,[w(p,l),"[",w(y,l),"]=",w(m,l)].join("")]};case"bracket":return p=>(_,m)=>m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,[w(p,l),"[]"].join("")]:[..._,[w(p,l),"[]=",w(m,l)].join("")];case"colon-list-separator":return p=>(_,m)=>m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,[w(p,l),":list="].join("")]:[..._,[w(p,l),":list=",w(m,l)].join("")];case"comma":case"separator":case"bracket-separator":{const p=l.arrayFormat==="bracket-separator"?"[]=":"=";return _=>(m,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?m:(y=y===null?"":y,m.length===0?[[w(_,l),p,w(y,l)].join("")]:[[m,w(y,l)].join(l.arrayFormatSeparator)])}default:return p=>(_,m)=>m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,w(p,l)]:[..._,[w(p,l),"=",w(m,l)].join("")]}}function O(l){let p;switch(l.arrayFormat){case"index":return(_,m,y)=>{if(p=/\[(\d*)\]$/.exec(_),_=_.replace(/\[\d*\]$/,""),!p){y[_]=m;return}y[_]===void 0&&(y[_]={}),y[_][p[1]]=m};case"bracket":return(_,m,y)=>{if(p=/(\[\])$/.exec(_),_=_.replace(/\[\]$/,""),!p){y[_]=m;return}if(y[_]===void 0){y[_]=[m];return}y[_]=[].concat(y[_],m)};case"colon-list-separator":return(_,m,y)=>{if(p=/(:list)$/.exec(_),_=_.replace(/:list$/,""),!p){y[_]=m;return}if(y[_]===void 0){y[_]=[m];return}y[_]=[].concat(y[_],m)};case"comma":case"separator":return(_,m,y)=>{const N=typeof m=="string"&&m.includes(l.arrayFormatSeparator),x=typeof m=="string"&&!N&&T(m,l).includes(l.arrayFormatSeparator);m=x?T(m,l):m;const Q=N||x?m.split(l.arrayFormatSeparator).map(se=>T(se,l)):m===null?m:T(m,l);y[_]=Q};case"bracket-separator":return(_,m,y)=>{const N=/(\[\])$/.test(_);if(_=_.replace(/\[\]$/,""),!N){y[_]=m&&T(m,l);return}const x=m===null?[]:m.split(l.arrayFormatSeparator).map(Q=>T(Q,l));if(y[_]===void 0){y[_]=x;return}y[_]=[].concat(y[_],x)};default:return(_,m,y)=>{if(y[_]===void 0){y[_]=m;return}y[_]=[].concat(y[_],m)}}}function g(l){if(typeof l!="string"||l.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function w(l,p){return p.encode?p.strict?t(l):encodeURIComponent(l):l}function T(l,p){return p.decode?r(l):l}function A(l){return Array.isArray(l)?l.sort():typeof l=="object"?A(Object.keys(l)).sort((p,_)=>Number(p)-Number(_)).map(p=>l[p]):l}function q(l){const p=l.indexOf("#");return p!==-1&&(l=l.slice(0,p)),l}function L(l){let p="";const _=l.indexOf("#");return _!==-1&&(p=l.slice(_)),p}function K(l){l=q(l);const p=l.indexOf("?");return p===-1?"":l.slice(p+1)}function te(l,p){return p.parseNumbers&&!Number.isNaN(Number(l))&&typeof l=="string"&&l.trim()!==""?l=Number(l):p.parseBooleans&&l!==null&&(l.toLowerCase()==="true"||l.toLowerCase()==="false")&&(l=l.toLowerCase()==="true"),l}function ue(l,p){p=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},p),g(p.arrayFormatSeparator);const _=O(p),m=Object.create(null);if(typeof l!="string"||(l=l.trim().replace(/^[?#&]/,""),!l))return m;for(const y of l.split("&")){if(y==="")continue;let[N,x]=s(p.decode?y.replace(/\+/g," "):y,"=");x=x===void 0?null:["comma","separator","bracket-separator"].includes(p.arrayFormat)?x:T(x,p),_(T(N,p),x,m)}for(const y of Object.keys(m)){const N=m[y];if(typeof N=="object"&&N!==null)for(const x of Object.keys(N))N[x]=te(N[x],p);else m[y]=te(N,p)}return p.sort===!1?m:(p.sort===!0?Object.keys(m).sort():Object.keys(m).sort(p.sort)).reduce((y,N)=>{const x=m[N];return x&&typeof x=="object"&&!Array.isArray(x)?y[N]=A(x):y[N]=x,y},Object.create(null))}i.extract=K,i.parse=ue,i.stringify=(l,p)=>{if(!l)return"";p=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},p),g(p.arrayFormatSeparator);const _=x=>p.skipNull&&c(l[x])||p.skipEmptyString&&l[x]==="",m=v(p),y={};for(const x of Object.keys(l))_(x)||(y[x]=l[x]);const N=Object.keys(y);return p.sort!==!1&&N.sort(p.sort),N.map(x=>{const Q=l[x];return Q===void 0?"":Q===null?w(x,p):Array.isArray(Q)?Q.length===0&&p.arrayFormat==="bracket-separator"?w(x,p)+"[]":Q.reduce(m(x),[]).join("&"):w(x,p)+"="+w(Q,p)}).filter(x=>x.length>0).join("&")},i.parseUrl=(l,p)=>{p=Object.assign({decode:!0},p);const[_,m]=s(l,"#");return Object.assign({url:_.split("?")[0]||"",query:ue(K(l),p)},p&&p.parseFragmentIdentifier&&m?{fragmentIdentifier:T(m,p)}:{})},i.stringifyUrl=(l,p)=>{p=Object.assign({encode:!0,strict:!0,[f]:!0},p);const _=q(l.url).split("?")[0]||"",m=i.extract(l.url),y=i.parse(m,{sort:!1}),N=Object.assign(y,l.query);let x=i.stringify(N,p);x&&(x=`?${x}`);let Q=L(l.url);return l.fragmentIdentifier&&(Q=`#${p[f]?w(l.fragmentIdentifier,p):l.fragmentIdentifier}`),`${_}${x}${Q}`},i.pick=(l,p,_)=>{_=Object.assign({parseFragmentIdentifier:!0,[f]:!1},_);const{url:m,query:y,fragmentIdentifier:N}=i.parseUrl(l,_);return i.stringifyUrl({url:m,query:o(y,p),fragmentIdentifier:N},_)},i.exclude=(l,p,_)=>{const m=Array.isArray(p)?y=>!p.includes(y):(y,N)=>!p(y,N);return i.pick(l,m,_)}})(OO);function Yd(i,t){return i.includes(":")?[i]:t.chains||[]}const xO="base16",PO="utf8",TO=1;function jc(i){const t=Vo.hash(ir(i,PO));return Qt(t,xO)}const NO="ReactNative",Ei={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};function Xd(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function RO(){return!sd()&&!!ko()&&navigator.product===NO}function xu(){return!Xd()&&!!ko()}function AO(){return RO()?Ei.reactNative:Xd()?Ei.node:xu()?Ei.browser:Ei.unknown}function CO(){return X_()||{name:"",description:"",url:"",icons:[""]}}function Jn(i,t){return i.filter(r=>t.includes(r)).length===i.length}function Yi(i=oe.FIVE_MINUTES,t){const r=oe.toMiliseconds(i||oe.FIVE_MINUTES);let s,o,c;return{resolve:f=>{c&&s&&(clearTimeout(c),s(f))},reject:f=>{c&&o&&(clearTimeout(c),o(f))},done:()=>new Promise((f,v)=>{c=setTimeout(()=>{v(new Error(t))},r),s=f,o=v})}}function $O(i){const[t,r]=i.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function Wn(i,t){return oe.fromMiliseconds((t||Date.now())+oe.toMiliseconds(i))}function bi(i){return Date.now()>=oe.toMiliseconds(i)}function Vt(i,t){return`${i}${t?`:${t}`:""}`}async function DO({id:i,topic:t,wcDeepLink:r}){try{if(!r)return;let o=(typeof r=="string"?JSON.parse(r):r)?.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${i}&sessionTopic=${t}`,f=AO();f===Ei.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):f===Ei.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}async function UO(i,t){try{return await i.getItem(t)||(xu()?localStorage.getItem(t):void 0)}catch(r){console.error(r)}}function Pi(i){const t=[];return i.forEach(r=>{const[s,o]=r.split(":");t.push(`${s}:${o}`)}),t}function jO(i){const t=[];return Object.values(i).forEach(r=>{t.push(...Pi(r.accounts))}),t}function LO(i,t){const r=[];return Object.values(i).forEach(s=>{Pi(s.accounts).includes(t)&&r.push(...s.methods)}),r}function MO(i,t){const r=[];return Object.values(i).forEach(s=>{Pi(s.accounts).includes(t)&&r.push(...s.events)}),r}function qO(i,t){const r=Ao(i,t);if(r)throw new Error(r.message);const s={};for(const[o,c]of Object.entries(i))s[o]={methods:c.methods,events:c.events,chains:c.accounts.map(f=>`${f.split(":")[0]}:${f.split(":")[1]}`)};return s}const FO={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},zO={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ge(i,t){const{message:r,code:s}=zO[i];return{message:t?`${r} ${t}`:r,code:s}}function br(i,t){const{message:r,code:s}=FO[i];return{message:t?`${r} ${t}`:r,code:s}}function Zo(i,t){return Array.isArray(i)?typeof t<"u"&&i.length?i.every(t):!0:!1}function os(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function Ar(i){return typeof i>"u"}function Jt(i,t){return t&&Ar(i)?!0:typeof i=="string"&&!!i.trim().length}function Pu(i,t){return t&&Ar(i)?!0:typeof i=="number"&&!isNaN(i)}function HO(i,t){const{requiredNamespaces:r}=t,s=Object.keys(i.namespaces),o=Object.keys(r);let c=!0;return Jn(o,s)?(s.forEach(f=>{const{accounts:v,methods:O,events:g}=i.namespaces[f],w=Pi(v),T=r[f];(!Jn(Yd(f,T),w)||!Jn(T.methods,O)||!Jn(T.events,g))&&(c=!1)}),c):!1}function jo(i){return Jt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function BO(i){if(Jt(i,!1)&&i.includes(":")){const t=i.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&jo(r)}}return!1}function VO(i,t){let r=null;return Jt(i?.publicKey,!1)||(r=ge("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Df(i){let t=!0;return Zo(i)?i.length&&(t=i.every(r=>Jt(r,!1))):t=!1,t}function kO(i,t,r){let s=null;return Zo(t)&&t.length?t.forEach(o=>{s||jo(o)||(s=br("UNSUPPORTED_CHAINS",`${r}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):jo(i)||(s=br("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function KO(i,t,r){let s=null;return Object.entries(i).forEach(([o,c])=>{if(s)return;const f=kO(o,Yd(o,c),`${t} ${r}`);f&&(s=f)}),s}function GO(i,t){let r=null;return Zo(i)?i.forEach(s=>{r||BO(s)||(r=br("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=br("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function WO(i,t){let r=null;return Object.values(i).forEach(s=>{if(r)return;const o=GO(s?.accounts,`${t} namespace`);o&&(r=o)}),r}function JO(i,t){let r=null;return Df(i?.methods)?Df(i?.events)||(r=br("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=br("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Zd(i,t){let r=null;return Object.values(i).forEach(s=>{if(r)return;const o=JO(s,`${t}, namespace`);o&&(r=o)}),r}function QO(i,t,r){let s=null;if(i&&os(i)){const o=Zd(i,t);o&&(s=o);const c=KO(i,t,r);c&&(s=c)}else s=ge("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Ao(i,t){let r=null;if(i&&os(i)){const s=Zd(i,t);s&&(r=s);const o=WO(i,t);o&&(r=o)}else r=ge("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function ep(i){return Jt(i.protocol,!0)}function YO(i,t){let r=!1;return t&&!i?r=!0:i&&Zo(i)&&i.length&&i.forEach(s=>{r=ep(s)}),r}function XO(i){return typeof i=="number"}function qr(i){return typeof i<"u"&&typeof i!==null}function ZO(i){return!(!i||typeof i!="object"||!i.code||!Pu(i.code,!1)||!i.message||!Jt(i.message,!1))}function ex(i){return!(Ar(i)||!Jt(i.method,!1))}function tx(i){return!(Ar(i)||Ar(i.result)&&Ar(i.error)||!Pu(i.id,!1)||!Jt(i.jsonrpc,!1))}function rx(i){return!(Ar(i)||!Jt(i.name,!1))}function Uf(i,t){return!(!jo(t)||!jO(i).includes(t))}function nx(i,t,r){return Jt(r,!1)?LO(i,t).includes(r):!1}function ix(i,t,r){return Jt(r,!1)?MO(i,t).includes(r):!1}function jf(i,t,r){let s=null;const o=sx(i),c=ox(t),f=Object.keys(o),v=Object.keys(c),O=Lf(Object.keys(i)),g=Lf(Object.keys(t)),w=O.filter(T=>!g.includes(T));return w.length&&(s=ge("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${w.toString()}
      Received: ${Object.keys(t).toString()}`)),Jn(f,v)||(s=ge("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${f.toString()}
      Approved: ${v.toString()}`)),Object.keys(t).forEach(T=>{if(!T.includes(":")||s)return;const A=Pi(t[T].accounts);A.includes(T)||(s=ge("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${T}
        Required: ${T}
        Approved: ${A.toString()}`))}),f.forEach(T=>{s||(Jn(o[T].methods,c[T].methods)?Jn(o[T].events,c[T].events)||(s=ge("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${T}`)):s=ge("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${T}`))}),s}function sx(i){const t={};return Object.keys(i).forEach(r=>{var s;r.includes(":")?t[r]=i[r]:(s=i[r].chains)==null||s.forEach(o=>{t[o]={methods:i[r].methods,events:i[r].events}})}),t}function Lf(i){return[...new Set(i.map(t=>t.includes(":")?t.split(":")[0]:t))]}function ox(i){const t={};return Object.keys(i).forEach(r=>{r.includes(":")?t[r]=i[r]:Pi(i[r].accounts)?.forEach(o=>{t[o]={accounts:i[r].accounts.filter(c=>c.includes(`${o}:`)),methods:i[r].methods,events:i[r].events}})}),t}function ax(i,t){return Pu(i,!1)&&i<=t.max&&i>=t.min}const Lc={};class Io{static get(t){return Lc[t]}static set(t,r){Lc[t]=r}static delete(t){delete Lc[t]}}const tp="wc",rp=2,np="client",Tu=`${tp}@${rp}:${np}:`,Mc={name:np,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Mf="WALLETCONNECT_DEEPLINK_CHOICE",cx="proposal",ip="Proposal expired",ux="session",So=oe.SEVEN_DAYS,lx="engine",Xi={wc_sessionPropose:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1104},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1106},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1112},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1115}}},qc={min:oe.FIVE_MINUTES,max:oe.SEVEN_DAYS},pn={idle:"IDLE",active:"ACTIVE"},hx="request",fx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var dx=Object.defineProperty,px=Object.defineProperties,gx=Object.getOwnPropertyDescriptors,qf=Object.getOwnPropertySymbols,yx=Object.prototype.hasOwnProperty,mx=Object.prototype.propertyIsEnumerable,Ff=(i,t,r)=>t in i?dx(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,fr=(i,t)=>{for(var r in t||(t={}))yx.call(t,r)&&Ff(i,r,t[r]);if(qf)for(var r of qf(t))mx.call(t,r)&&Ff(i,r,t[r]);return i},Zi=(i,t)=>px(i,gx(t));class vx extends t1{constructor(t){super(t),this.name=lx,this.events=new gu,this.initialized=!1,this.ignoredPayloadTypes=[TO],this.requestQueue={state:pn.idle,queue:[]},this.sessionRequestQueue={state:pn.idle,queue:[]},this.requestQueueDelay=oe.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Xi)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},oe.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=Zi(fr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:f,sessionProperties:v,relays:O}=s;let g=o,w,T=!1;if(g&&(T=this.client.core.pairing.pairings.get(g).active),!g||!T){const{topic:p,uri:_}=await this.client.core.pairing.create();g=p,w=_}const A=await this.client.core.crypto.generateKeyPair(),q=fr({requiredNamespaces:c,optionalNamespaces:f,relays:O??[{protocol:Wd}],proposer:{publicKey:A,metadata:this.client.metadata}},v&&{sessionProperties:v}),{reject:L,resolve:K,done:te}=Yi(oe.FIVE_MINUTES,ip);if(this.events.once(Vt("session_connect"),async({error:p,session:_})=>{if(p)L(p);else if(_){_.self.publicKey=A;const m=Zi(fr({},_),{requiredNamespaces:_.requiredNamespaces,optionalNamespaces:_.optionalNamespaces});await this.client.session.set(_.topic,m),await this.setExpiry(_.topic,_.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:_.peer.metadata}),K(m)}}),!g){const{message:p}=ge("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(p)}const ue=await this.sendRequest({topic:g,method:"wc_sessionPropose",params:q}),l=Wn(oe.FIVE_MINUTES);return await this.setProposal(ue,fr({id:ue,expiry:l},q)),{uri:w,approval:te}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:f}=r,v=this.client.proposal.get(s);let{pairingTopic:O,proposer:g,requiredNamespaces:w,optionalNamespaces:T}=v;O=O||"",os(w)||(w=qO(c,"approve()"));const A=await this.client.core.crypto.generateKeyPair(),q=g.publicKey,L=await this.client.core.crypto.generateSharedKey(A,q);O&&s&&(await this.client.core.pairing.updateMetadata({topic:O,metadata:g.metadata}),await this.sendResult({id:s,topic:O,result:{relay:{protocol:o??"irn"},responderPublicKey:A}}),await this.client.proposal.delete(s,br("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:O}));const K=fr({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:w,optionalNamespaces:T,pairingTopic:O,controller:{publicKey:A,metadata:this.client.metadata},expiry:Wn(So)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(L),await this.sendRequest({topic:L,method:"wc_sessionSettle",params:K,throwOnFailedPublish:!0});const te=Zi(fr({},K),{topic:L,pairingTopic:O,acknowledged:!1,self:K.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:A});return await this.client.session.set(L,te),await this.setExpiry(L,Wn(So)),{topic:L,acknowledged:()=>new Promise(ue=>setTimeout(()=>ue(this.client.session.get(L)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:o}=r,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,br("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:o}=r,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:f,resolve:v,reject:O}=Yi();return this.events.once(Vt("session_update",c),({error:g})=>{g?O(g):v()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:f}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:f,reject:v}=Yi();return this.events.once(Vt("session_extend",o),({error:O})=>{O?v(O):f()}),await this.setExpiry(s,Wn(So)),{acknowledged:c}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:o,topic:c,expiry:f}=r,v=Eu(),{done:O,resolve:g,reject:w}=Yi(f,"Request expired. Please try again.");return this.events.once(Vt("session_request",v),({error:T,result:A})=>{T?w(T):g(A)}),await Promise.all([new Promise(async T=>{await this.sendRequest({clientRpcId:v,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:s},expiry:f,throwOnFailedPublish:!0}).catch(A=>w(A)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:v}),T()}),new Promise(async T=>{const A=await UO(this.client.core.storage,Mf);DO({id:v,topic:c,wcDeepLink:A}),T()}),O()]).then(T=>T[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:o}=r,{id:c}=o;gn(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):zr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:f,reject:v}=Yi();this.events.once(Vt("session_ping",o),({error:O})=>{O?v(O):f()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:o,chainId:c}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:br("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>HO(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var f,v;return((f=c.peerMetadata)==null?void 0:f.url)&&((v=c.peerMetadata)==null?void 0:v.url)===r.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,br("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Mf).catch(c=>this.client.logger.warn(c))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,br("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),o?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==r),o&&(this.sessionRequestQueue.state=pn.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=Xi.wc_sessionRequest.req.ttl,{id:o,topic:c,params:f,verifyContext:v}=r;await this.client.pendingRequest.set(o,{id:o,topic:c,params:f,verifyContext:v}),s&&this.client.core.expirer.set(o,Wn(s))},this.sendRequest=async r=>{const{topic:s,method:o,params:c,expiry:f,relayRpcId:v,clientRpcId:O,throwOnFailedPublish:g}=r,w=Ii(o,c,O);if(xu()&&fx.includes(o)){const q=jc(JSON.stringify(w));this.client.core.verify.register({attestationId:q})}const T=await this.client.core.crypto.encode(s,w),A=Xi[o].req;return f&&(A.ttl=f),v&&(A.id=v),this.client.core.history.set(s,w),g?(A.internal=Zi(fr({},A.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,T,A)):this.client.core.relayer.publish(s,T,A).catch(q=>this.client.logger.error(q)),w.id},this.sendResult=async r=>{const{id:s,topic:o,result:c,throwOnFailedPublish:f}=r,v=Iu(s,c),O=await this.client.core.crypto.encode(o,v),g=await this.client.core.history.get(o,s),w=Xi[g.request.method].res;f?(w.internal=Zi(fr({},w.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,O,w)):this.client.core.relayer.publish(o,O,w).catch(T=>this.client.logger.error(T)),await this.client.core.history.resolve(v)},this.sendError=async(r,s,o)=>{const c=Jo(r,o),f=await this.client.core.crypto.encode(s,c),v=await this.client.core.history.get(s,r),O=Xi[v.request.method].res;this.client.core.relayer.publish(s,f,O),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(o=>{bi(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{bi(o.expiry)&&s.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===pn.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=pn.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=pn.idle},this.processRequest=r=>{const{topic:s,payload:o}=r,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:o}=r,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:o}=ge("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(fr({},s.params));const f=Wn(oe.FIVE_MINUTES),v=fr({id:c,pairingTopic:r,expiry:f},o);await this.setProposal(c,v);const O=jc(JSON.stringify(s)),g=await this.getVerifyContext(O,v.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:v,verifyContext:g})}catch(f){await this.sendError(c,r,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(r,s)=>{const{id:o}=s;if(gn(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const f=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const v=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:v});const O=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:O});const g=await this.client.core.crypto.generateSharedKey(v,O);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const w=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:w}),await this.client.core.pairing.activate({topic:r})}else zr(s)&&(await this.client.proposal.delete(o,br("USER_DISCONNECTED")),this.events.emit(Vt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:f,controller:v,expiry:O,namespaces:g,requiredNamespaces:w,optionalNamespaces:T,sessionProperties:A,pairingTopic:q}=s.params,L=fr({topic:r,relay:f,expiry:O,namespaces:g,acknowledged:!0,pairingTopic:q,requiredNamespaces:w,optionalNamespaces:T,controller:v.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:v.publicKey,metadata:v.metadata}},A&&{sessionProperties:A});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Vt("session_connect"),{session:L}),this.cleanupDuplicatePairings(L)}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(r,s)=>{const{id:o}=s;gn(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Vt("session_approve",o),{})):zr(s)&&(await this.client.session.delete(r,br("USER_DISCONNECTED")),this.events.emit(Vt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:o,id:c}=s;try{const f=`${r}_session_update`,v=Io.get(f);if(v&&this.isRequestOutOfSync(v,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(fr({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:r,result:!0}),this.client.events.emit("session_update",{id:c,topic:r,params:o}),Io.set(f,c)}catch(f){await this.sendError(c,r,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:o}=s;gn(s)?this.events.emit(Vt("session_update",o),{}):zr(s)&&this.events.emit(Vt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:o}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Wn(So)),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_extend",{id:o,topic:r})}catch(c){await this.sendError(o,r,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(r,s)=>{const{id:o}=s;gn(s)?this.events.emit(Vt("session_extend",o),{}):zr(s)&&this.events.emit(Vt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:o}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_ping",{id:o,topic:r})}catch(c){await this.sendError(o,r,c),this.client.logger.error(c)}},this.onSessionPingResponse=(r,s)=>{const{id:o}=s;setTimeout(()=>{gn(s)?this.events.emit(Vt("session_ping",o),{}):zr(s)&&this.events.emit(Vt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Wt.publish,async()=>{c(await this.deleteSession(r))})}),this.sendResult({id:o,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(r,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(fr({topic:r},c));const f=jc(JSON.stringify(Ii("wc_sessionRequest",c,o))),v=this.client.session.get(r),O=await this.getVerifyContext(f,v.peer.metadata),g={id:o,topic:r,params:c,verifyContext:O};await this.setPendingSessionRequest(g),this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue()}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(r,s)=>{const{id:o}=s;gn(s)?this.events.emit(Vt("session_request",o),{result:s.result}):zr(s)&&this.events.emit(Vt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:o,params:c}=s;try{const f=`${r}_session_event_${c.event.name}`,v=Io.get(f);if(v&&this.isRequestOutOfSync(v,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(fr({topic:r},c)),this.client.events.emit("session_event",{id:o,topic:r,params:c}),Io.set(f,o)}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=pn.idle,this.processSessionRequestQueue()},oe.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===pn.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=pn.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,Ii("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!qr(r)){const{message:O}=ge("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(O)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:f,relays:v}=r;if(Ar(s)||await this.isValidPairingTopic(s),!YO(v,!0)){const{message:O}=ge("MISSING_OR_INVALID",`connect() relays: ${v}`);throw new Error(O)}!Ar(o)&&os(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!Ar(c)&&os(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),Ar(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(r,s)=>{const o=QO(r,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!qr(r))throw new Error(ge("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:f}=r;await this.isValidProposalId(s);const v=this.client.proposal.get(s),O=Ao(o,"approve()");if(O)throw new Error(O.message);const g=jf(v.requiredNamespaces,o,"approve()");if(g)throw new Error(g.message);if(!Jt(c,!0)){const{message:w}=ge("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(w)}Ar(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async r=>{if(!qr(r)){const{message:c}=ge("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(c)}const{id:s,reason:o}=r;if(await this.isValidProposalId(s),!ZO(o)){const{message:c}=ge("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=r=>{if(!qr(r)){const{message:g}=ge("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(g)}const{relay:s,controller:o,namespaces:c,expiry:f}=r;if(!ep(s)){const{message:g}=ge("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const v=VO(o,"onSessionSettleRequest()");if(v)throw new Error(v.message);const O=Ao(c,"onSessionSettleRequest()");if(O)throw new Error(O.message);if(bi(f)){const{message:g}=ge("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async r=>{if(!qr(r)){const{message:O}=ge("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(O)}const{topic:s,namespaces:o}=r;await this.isValidSessionTopic(s);const c=this.client.session.get(s),f=Ao(o,"update()");if(f)throw new Error(f.message);const v=jf(c.requiredNamespaces,o,"update()");if(v)throw new Error(v.message)},this.isValidExtend=async r=>{if(!qr(r)){const{message:o}=ge("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!qr(r)){const{message:O}=ge("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(O)}const{topic:s,request:o,chainId:c,expiry:f}=r;await this.isValidSessionTopic(s);const{namespaces:v}=this.client.session.get(s);if(!Uf(v,c)){const{message:O}=ge("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(O)}if(!ex(o)){const{message:O}=ge("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(O)}if(!nx(v,c,o.method)){const{message:O}=ge("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(O)}if(f&&!ax(f,qc)){const{message:O}=ge("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${qc.min} and ${qc.max}`);throw new Error(O)}},this.isValidRespond=async r=>{if(!qr(r)){const{message:c}=ge("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(c)}const{topic:s,response:o}=r;if(await this.isValidSessionTopic(s),!tx(o)){const{message:c}=ge("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidPing=async r=>{if(!qr(r)){const{message:o}=ge("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!qr(r)){const{message:v}=ge("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(v)}const{topic:s,event:o,chainId:c}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Uf(f,c)){const{message:v}=ge("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(v)}if(!rx(o)){const{message:v}=ge("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(v)}if(!ix(f,c,o.name)){const{message:v}=ge("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(v)}},this.isValidDisconnect=async r=>{if(!qr(r)){const{message:o}=ge("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const o={verified:{verifyUrl:s.verifyUrl||wi,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(o=>{if(!Jt(o,!1)){const{message:c}=ge("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:t}=ge("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Wt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(r,s);try{Su(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Qo(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Rr.expired,async t=>{const{topic:r,id:s}=$O(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ge("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(rs.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!Jt(t,!1)){const{message:r}=ge("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=ge("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(bi(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=ge("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Jt(t,!1)){const{message:r}=ge("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=ge("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(bi(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=ge("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Jt(t,!1)){const{message:r}=ge("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=ge("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!XO(t)){const{message:r}=ge("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=ge("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(bi(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=ge("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class _x extends Xo{constructor(t,r){super(t,r,cx,Tu),this.core=t,this.logger=r}}class bx extends Xo{constructor(t,r){super(t,r,ux,Tu),this.core=t,this.logger=r}}class wx extends Xo{constructor(t,r){super(t,r,hx,Tu,s=>s.id),this.core=t,this.logger=r}}let Ex=class sp extends e1{constructor(t){super(t),this.protocol=tp,this.version=rp,this.name=Mc.name,this.events=new Cr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=t?.name||Mc.name,this.metadata=t?.metadata||CO();const r=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:t?.logger||Mc.logger}));this.core=t?.core||new SO(t),this.logger=Re.generateChildLogger(r,this.name),this.session=new bx(this.core,this.logger),this.proposal=new _x(this.core,this.logger),this.pendingRequest=new wx(this.core,this.logger),this.engine=new vx(this)}static async init(t){const r=new sp(t);return await r.initialize(),r}get context(){return Re.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Ix={};(function(i){const t=Fo,r=zo,s=Mo,o=qo,c=l=>l==null,f=Symbol("encodeFragmentIdentifier");function v(l){switch(l.arrayFormat){case"index":return p=>(_,m)=>{const y=_.length;return m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,[w(p,l),"[",y,"]"].join("")]:[..._,[w(p,l),"[",w(y,l),"]=",w(m,l)].join("")]};case"bracket":return p=>(_,m)=>m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,[w(p,l),"[]"].join("")]:[..._,[w(p,l),"[]=",w(m,l)].join("")];case"colon-list-separator":return p=>(_,m)=>m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,[w(p,l),":list="].join("")]:[..._,[w(p,l),":list=",w(m,l)].join("")];case"comma":case"separator":case"bracket-separator":{const p=l.arrayFormat==="bracket-separator"?"[]=":"=";return _=>(m,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?m:(y=y===null?"":y,m.length===0?[[w(_,l),p,w(y,l)].join("")]:[[m,w(y,l)].join(l.arrayFormatSeparator)])}default:return p=>(_,m)=>m===void 0||l.skipNull&&m===null||l.skipEmptyString&&m===""?_:m===null?[..._,w(p,l)]:[..._,[w(p,l),"=",w(m,l)].join("")]}}function O(l){let p;switch(l.arrayFormat){case"index":return(_,m,y)=>{if(p=/\[(\d*)\]$/.exec(_),_=_.replace(/\[\d*\]$/,""),!p){y[_]=m;return}y[_]===void 0&&(y[_]={}),y[_][p[1]]=m};case"bracket":return(_,m,y)=>{if(p=/(\[\])$/.exec(_),_=_.replace(/\[\]$/,""),!p){y[_]=m;return}if(y[_]===void 0){y[_]=[m];return}y[_]=[].concat(y[_],m)};case"colon-list-separator":return(_,m,y)=>{if(p=/(:list)$/.exec(_),_=_.replace(/:list$/,""),!p){y[_]=m;return}if(y[_]===void 0){y[_]=[m];return}y[_]=[].concat(y[_],m)};case"comma":case"separator":return(_,m,y)=>{const N=typeof m=="string"&&m.includes(l.arrayFormatSeparator),x=typeof m=="string"&&!N&&T(m,l).includes(l.arrayFormatSeparator);m=x?T(m,l):m;const Q=N||x?m.split(l.arrayFormatSeparator).map(se=>T(se,l)):m===null?m:T(m,l);y[_]=Q};case"bracket-separator":return(_,m,y)=>{const N=/(\[\])$/.test(_);if(_=_.replace(/\[\]$/,""),!N){y[_]=m&&T(m,l);return}const x=m===null?[]:m.split(l.arrayFormatSeparator).map(Q=>T(Q,l));if(y[_]===void 0){y[_]=x;return}y[_]=[].concat(y[_],x)};default:return(_,m,y)=>{if(y[_]===void 0){y[_]=m;return}y[_]=[].concat(y[_],m)}}}function g(l){if(typeof l!="string"||l.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function w(l,p){return p.encode?p.strict?t(l):encodeURIComponent(l):l}function T(l,p){return p.decode?r(l):l}function A(l){return Array.isArray(l)?l.sort():typeof l=="object"?A(Object.keys(l)).sort((p,_)=>Number(p)-Number(_)).map(p=>l[p]):l}function q(l){const p=l.indexOf("#");return p!==-1&&(l=l.slice(0,p)),l}function L(l){let p="";const _=l.indexOf("#");return _!==-1&&(p=l.slice(_)),p}function K(l){l=q(l);const p=l.indexOf("?");return p===-1?"":l.slice(p+1)}function te(l,p){return p.parseNumbers&&!Number.isNaN(Number(l))&&typeof l=="string"&&l.trim()!==""?l=Number(l):p.parseBooleans&&l!==null&&(l.toLowerCase()==="true"||l.toLowerCase()==="false")&&(l=l.toLowerCase()==="true"),l}function ue(l,p){p=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},p),g(p.arrayFormatSeparator);const _=O(p),m=Object.create(null);if(typeof l!="string"||(l=l.trim().replace(/^[?#&]/,""),!l))return m;for(const y of l.split("&")){if(y==="")continue;let[N,x]=s(p.decode?y.replace(/\+/g," "):y,"=");x=x===void 0?null:["comma","separator","bracket-separator"].includes(p.arrayFormat)?x:T(x,p),_(T(N,p),x,m)}for(const y of Object.keys(m)){const N=m[y];if(typeof N=="object"&&N!==null)for(const x of Object.keys(N))N[x]=te(N[x],p);else m[y]=te(N,p)}return p.sort===!1?m:(p.sort===!0?Object.keys(m).sort():Object.keys(m).sort(p.sort)).reduce((y,N)=>{const x=m[N];return x&&typeof x=="object"&&!Array.isArray(x)?y[N]=A(x):y[N]=x,y},Object.create(null))}i.extract=K,i.parse=ue,i.stringify=(l,p)=>{if(!l)return"";p=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},p),g(p.arrayFormatSeparator);const _=x=>p.skipNull&&c(l[x])||p.skipEmptyString&&l[x]==="",m=v(p),y={};for(const x of Object.keys(l))_(x)||(y[x]=l[x]);const N=Object.keys(y);return p.sort!==!1&&N.sort(p.sort),N.map(x=>{const Q=l[x];return Q===void 0?"":Q===null?w(x,p):Array.isArray(Q)?Q.length===0&&p.arrayFormat==="bracket-separator"?w(x,p)+"[]":Q.reduce(m(x),[]).join("&"):w(x,p)+"="+w(Q,p)}).filter(x=>x.length>0).join("&")},i.parseUrl=(l,p)=>{p=Object.assign({decode:!0},p);const[_,m]=s(l,"#");return Object.assign({url:_.split("?")[0]||"",query:ue(K(l),p)},p&&p.parseFragmentIdentifier&&m?{fragmentIdentifier:T(m,p)}:{})},i.stringifyUrl=(l,p)=>{p=Object.assign({encode:!0,strict:!0,[f]:!0},p);const _=q(l.url).split("?")[0]||"",m=i.extract(l.url),y=i.parse(m,{sort:!1}),N=Object.assign(y,l.query);let x=i.stringify(N,p);x&&(x=`?${x}`);let Q=L(l.url);return l.fragmentIdentifier&&(Q=`#${p[f]?w(l.fragmentIdentifier,p):l.fragmentIdentifier}`),`${_}${x}${Q}`},i.pick=(l,p,_)=>{_=Object.assign({parseFragmentIdentifier:!0,[f]:!1},_);const{url:m,query:y,fragmentIdentifier:N}=i.parseUrl(l,_);return i.stringifyUrl({url:m,query:o(y,p),fragmentIdentifier:N},_)},i.exclude=(l,p,_)=>{const m=Array.isArray(p)?y=>!p.includes(y):(y,N)=>!p(y,N);return i.pick(l,m,_)}})(Ix);const Sx=":";function Ox(i){const[t,r]=i.split(Sx);return{namespace:t,reference:r}}function Fc(i=[],t=[]){return[...new Set([...i,...t])]}function Nu(i){return i.includes(":")}function ns(i){return Nu(i)?i.split(":")[0]:i}const xx={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function zf(i,t){const{message:r,code:s}=xx[i];return{message:t?`${r} ${t}`:r,code:s}}function Hf(i,t){return Array.isArray(i)?typeof t<"u"&&i.length?i.every(t):!0:!1}function Px(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}var hu={exports:{}};(function(i,t){var r=typeof self<"u"?self:Hr,s=function(){function c(){this.fetch=!1,this.DOMException=r.DOMException}return c.prototype=r,new c}();(function(c){(function(f){var v={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function O(S){return S&&DataView.prototype.isPrototypeOf(S)}if(v.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],w=ArrayBuffer.isView||function(S){return S&&g.indexOf(Object.prototype.toString.call(S))>-1};function T(S){if(typeof S!="string"&&(S=String(S)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(S))throw new TypeError("Invalid character in header field name");return S.toLowerCase()}function A(S){return typeof S!="string"&&(S=String(S)),S}function q(S){var $={next:function(){var ne=S.shift();return{done:ne===void 0,value:ne}}};return v.iterable&&($[Symbol.iterator]=function(){return $}),$}function L(S){this.map={},S instanceof L?S.forEach(function($,ne){this.append(ne,$)},this):Array.isArray(S)?S.forEach(function($){this.append($[0],$[1])},this):S&&Object.getOwnPropertyNames(S).forEach(function($){this.append($,S[$])},this)}L.prototype.append=function(S,$){S=T(S),$=A($);var ne=this.map[S];this.map[S]=ne?ne+", "+$:$},L.prototype.delete=function(S){delete this.map[T(S)]},L.prototype.get=function(S){return S=T(S),this.has(S)?this.map[S]:null},L.prototype.has=function(S){return this.map.hasOwnProperty(T(S))},L.prototype.set=function(S,$){this.map[T(S)]=A($)},L.prototype.forEach=function(S,$){for(var ne in this.map)this.map.hasOwnProperty(ne)&&S.call($,this.map[ne],ne,this)},L.prototype.keys=function(){var S=[];return this.forEach(function($,ne){S.push(ne)}),q(S)},L.prototype.values=function(){var S=[];return this.forEach(function($){S.push($)}),q(S)},L.prototype.entries=function(){var S=[];return this.forEach(function($,ne){S.push([ne,$])}),q(S)},v.iterable&&(L.prototype[Symbol.iterator]=L.prototype.entries);function K(S){if(S.bodyUsed)return Promise.reject(new TypeError("Already read"));S.bodyUsed=!0}function te(S){return new Promise(function($,ne){S.onload=function(){$(S.result)},S.onerror=function(){ne(S.error)}})}function ue(S){var $=new FileReader,ne=te($);return $.readAsArrayBuffer(S),ne}function l(S){var $=new FileReader,ne=te($);return $.readAsText(S),ne}function p(S){for(var $=new Uint8Array(S),ne=new Array($.length),de=0;de<$.length;de++)ne[de]=String.fromCharCode($[de]);return ne.join("")}function _(S){if(S.slice)return S.slice(0);var $=new Uint8Array(S.byteLength);return $.set(new Uint8Array(S)),$.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(S){this._bodyInit=S,S?typeof S=="string"?this._bodyText=S:v.blob&&Blob.prototype.isPrototypeOf(S)?this._bodyBlob=S:v.formData&&FormData.prototype.isPrototypeOf(S)?this._bodyFormData=S:v.searchParams&&URLSearchParams.prototype.isPrototypeOf(S)?this._bodyText=S.toString():v.arrayBuffer&&v.blob&&O(S)?(this._bodyArrayBuffer=_(S.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):v.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(S)||w(S))?this._bodyArrayBuffer=_(S):this._bodyText=S=Object.prototype.toString.call(S):this._bodyText="",this.headers.get("content-type")||(typeof S=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(S)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var S=K(this);if(S)return S;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?K(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ue)}),this.text=function(){var S=K(this);if(S)return S;if(this._bodyBlob)return l(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(p(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(Q)}),this.json=function(){return this.text().then(JSON.parse)},this}var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function N(S){var $=S.toUpperCase();return y.indexOf($)>-1?$:S}function x(S,$){$=$||{};var ne=$.body;if(S instanceof x){if(S.bodyUsed)throw new TypeError("Already read");this.url=S.url,this.credentials=S.credentials,$.headers||(this.headers=new L(S.headers)),this.method=S.method,this.mode=S.mode,this.signal=S.signal,!ne&&S._bodyInit!=null&&(ne=S._bodyInit,S.bodyUsed=!0)}else this.url=String(S);if(this.credentials=$.credentials||this.credentials||"same-origin",($.headers||!this.headers)&&(this.headers=new L($.headers)),this.method=N($.method||this.method||"GET"),this.mode=$.mode||this.mode||null,this.signal=$.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ne)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ne)}x.prototype.clone=function(){return new x(this,{body:this._bodyInit})};function Q(S){var $=new FormData;return S.trim().split("&").forEach(function(ne){if(ne){var de=ne.split("="),X=de.shift().replace(/\+/g," "),W=de.join("=").replace(/\+/g," ");$.append(decodeURIComponent(X),decodeURIComponent(W))}}),$}function se(S){var $=new L,ne=S.replace(/\r?\n[\t ]+/g," ");return ne.split(/\r?\n/).forEach(function(de){var X=de.split(":"),W=X.shift().trim();if(W){var Y=X.join(":").trim();$.append(W,Y)}}),$}m.call(x.prototype);function pe(S,$){$||($={}),this.type="default",this.status=$.status===void 0?200:$.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in $?$.statusText:"OK",this.headers=new L($.headers),this.url=$.url||"",this._initBody(S)}m.call(pe.prototype),pe.prototype.clone=function(){return new pe(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new L(this.headers),url:this.url})},pe.error=function(){var S=new pe(null,{status:0,statusText:""});return S.type="error",S};var Ae=[301,302,303,307,308];pe.redirect=function(S,$){if(Ae.indexOf($)===-1)throw new RangeError("Invalid status code");return new pe(null,{status:$,headers:{location:S}})},f.DOMException=c.DOMException;try{new f.DOMException}catch{f.DOMException=function($,ne){this.message=$,this.name=ne;var de=Error($);this.stack=de.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function Fe(S,$){return new Promise(function(ne,de){var X=new x(S,$);if(X.signal&&X.signal.aborted)return de(new f.DOMException("Aborted","AbortError"));var W=new XMLHttpRequest;function Y(){W.abort()}W.onload=function(){var Z={status:W.status,statusText:W.statusText,headers:se(W.getAllResponseHeaders()||"")};Z.url="responseURL"in W?W.responseURL:Z.headers.get("X-Request-URL");var Qe="response"in W?W.response:W.responseText;ne(new pe(Qe,Z))},W.onerror=function(){de(new TypeError("Network request failed"))},W.ontimeout=function(){de(new TypeError("Network request failed"))},W.onabort=function(){de(new f.DOMException("Aborted","AbortError"))},W.open(X.method,X.url,!0),X.credentials==="include"?W.withCredentials=!0:X.credentials==="omit"&&(W.withCredentials=!1),"responseType"in W&&v.blob&&(W.responseType="blob"),X.headers.forEach(function(Z,Qe){W.setRequestHeader(Qe,Z)}),X.signal&&(X.signal.addEventListener("abort",Y),W.onreadystatechange=function(){W.readyState===4&&X.signal.removeEventListener("abort",Y)}),W.send(typeof X._bodyInit>"u"?null:X._bodyInit)})}return Fe.polyfill=!0,c.fetch||(c.fetch=Fe,c.Headers=L,c.Request=x,c.Response=pe),f.Headers=L,f.Request=x,f.Response=pe,f.fetch=Fe,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,i.exports=t})(hu,hu.exports);var Tx=hu.exports;const Bf=od(Tx),Nx={Accept:"application/json","Content-Type":"application/json"},Rx="POST",Vf={headers:Nx,method:Rx},kf=10;class An{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Cr.EventEmitter,this.isAvailable=!1,this.registering=!1,!ff(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=Qn(t),c=await(await Bf(this.url,Object.assign(Object.assign({},Vf),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!ff(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Qn({id:1,jsonrpc:"2.0",method:"test",params:[]});await Bf(t,Object.assign(Object.assign({},Vf),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ds(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),c=Jo(t,o);this.events.emit("payload",c)}parseError(t,r=this.url){return Rd(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>kf&&this.events.setMaxListeners(kf)}}const Kf="error",Ax="wss://relay.walletconnect.com",Cx="wc",$x="universal_provider",Gf=`${Cx}@2:${$x}:`,Dx="https://rpc.walletconnect.com/v1/",mn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var es=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,t){(function(){var r,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",v="Invalid `variable` option passed into `_.template`",O="__lodash_hash_undefined__",g=500,w="__lodash_placeholder__",T=1,A=2,q=4,L=1,K=2,te=1,ue=2,l=4,p=8,_=16,m=32,y=64,N=128,x=256,Q=512,se=30,pe="...",Ae=800,Fe=16,S=1,$=2,ne=3,de=1/0,X=9007199254740991,W=17976931348623157e292,Y=NaN,Z=4294967295,Qe=Z-1,Ve=Z>>>1,Vr=[["ary",N],["bind",te],["bindKey",ue],["curry",p],["curryRight",_],["flip",Q],["partial",m],["partialRight",y],["rearg",x]],Ie="[object Arguments]",St="[object Array]",H="[object AsyncFunction]",z="[object Boolean]",M="[object Date]",h="[object DOMException]",C="[object Error]",ae="[object Function]",ye="[object GeneratorFunction]",we="[object Map]",Ce="[object Number]",De="[object Null]",xe="[object Object]",Ot="[object Promise]",_t="[object Proxy]",at="[object RegExp]",je="[object Set]",Xe="[object String]",Ze="[object Symbol]",ct="[object Undefined]",ze="[object WeakMap]",et="[object WeakSet]",$e="[object ArrayBuffer]",ke="[object DataView]",ht="[object Float32Array]",Me="[object Float64Array]",xt="[object Int8Array]",Dt="[object Int16Array]",zt="[object Int32Array]",Ht="[object Uint8Array]",Lt="[object Uint8ClampedArray]",Yt="[object Uint16Array]",or="[object Uint32Array]",kr=/\b__p \+= '';/g,Xt=/\b(__p \+=) '' \+/g,Xr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,vn=/&(?:amp|lt|gt|quot|#39);/g,Cn=/[&<>"']/g,ft=RegExp(vn.source),nt=RegExp(Cn.source),dt=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ut=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pt=/^\w*$/,Tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gt=/[\\^$.*+?()[\]{}|]/g,Nt=RegExp(gt.source),yt=/^\s+/,bt=/\s/,mt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ye=/\{\n\/\* \[wrapped with (.+)\] \*/,Rt=/,? & /,At=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ea=/[()=,{}\[\]\/\s]/,ta=/\\(\\)?/g,ra=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,wr=/\w*$/,na=/^[-+]0x[0-9a-f]+$/i,ia=/^0b[01]+$/i,sa=/^\[object .+?Constructor\]$/,oa=/^0o[0-7]+$/i,aa=/^(?:0|[1-9]\d*)$/,Zr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ei=/($^)/,ca=/['\n\r\u2028\u2029\\]/g,ti="\\ud800-\\udfff",ua="\\u0300-\\u036f",la="\\ufe20-\\ufe2f",ri="\\u20d0-\\u20ff",ys=ua+la+ri,ms="\\u2700-\\u27bf",$r="a-z\\xdf-\\xf6\\xf8-\\xff",ha="\\xac\\xb1\\xd7\\xf7",fa="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",da="\\u2000-\\u206f",pa=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",vs="A-Z\\xc0-\\xd6\\xd8-\\xde",_s="\\ufe0e\\ufe0f",$n=ha+fa+da+pa,Ti="[']",Dn="["+ti+"]",Ni="["+$n+"]",Un="["+ys+"]",bs="\\d+",ga="["+ms+"]",ws="["+$r+"]",Es="[^"+ti+$n+bs+ms+$r+vs+"]",ni="\\ud83c[\\udffb-\\udfff]",ya="(?:"+Un+"|"+ni+")",Is="[^"+ti+"]",ii="(?:\\ud83c[\\udde6-\\uddff]){2}",_n="[\\ud800-\\udbff][\\udc00-\\udfff]",pr="["+vs+"]",Ss="\\u200d",Os="(?:"+ws+"|"+Es+")",Kr="(?:"+pr+"|"+Es+")",xs="(?:"+Ti+"(?:d|ll|m|re|s|t|ve))?",Ps="(?:"+Ti+"(?:D|LL|M|RE|S|T|VE))?",Ts=ya+"?",Ns="["+_s+"]?",ma="(?:"+Ss+"(?:"+[Is,ii,_n].join("|")+")"+Ns+Ts+")*",en="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",As=Ns+Ts+ma,si="(?:"+[ga,ii,_n].join("|")+")"+As,va="(?:"+[Is+Un+"?",Un,ii,_n,Dn].join("|")+")",Ri=RegExp(Ti,"g"),_a=RegExp(Un,"g"),oi=RegExp(ni+"(?="+ni+")|"+va+As,"g"),Cs=RegExp([pr+"?"+ws+"+"+xs+"(?="+[Ni,pr,"$"].join("|")+")",Kr+"+"+Ps+"(?="+[Ni,pr+Os,"$"].join("|")+")",pr+"?"+Os+"+"+xs,pr+"+"+Ps,Rs,en,bs,si].join("|"),"g"),$s=RegExp("["+Ss+ti+ys+_s+"]"),jn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ds=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ba=-1,Ke={};Ke[ht]=Ke[Me]=Ke[xt]=Ke[Dt]=Ke[zt]=Ke[Ht]=Ke[Lt]=Ke[Yt]=Ke[or]=!0,Ke[Ie]=Ke[St]=Ke[$e]=Ke[z]=Ke[ke]=Ke[M]=Ke[C]=Ke[ae]=Ke[we]=Ke[Ce]=Ke[xe]=Ke[at]=Ke[je]=Ke[Xe]=Ke[ze]=!1;var He={};He[Ie]=He[St]=He[$e]=He[ke]=He[z]=He[M]=He[ht]=He[Me]=He[xt]=He[Dt]=He[zt]=He[we]=He[Ce]=He[xe]=He[at]=He[je]=He[Xe]=He[Ze]=He[Ht]=He[Lt]=He[Yt]=He[or]=!0,He[C]=He[ae]=He[ze]=!1;var I={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},G={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},re={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ge=parseFloat,ve=parseInt,tt=typeof es=="object"&&es&&es.Object===Object&&es,Ct=typeof self=="object"&&self&&self.Object===Object&&self,Te=tt||Ct||Function("return this")(),We=t&&!t.nodeType&&t,wt=We&&!0&&i&&!i.nodeType&&i,ar=wt&&wt.exports===We,$t=ar&&tt.process,rt=function(){try{var U=wt&&wt.require&&wt.require("util").types;return U||$t&&$t.binding&&$t.binding("util")}catch{}}(),Zt=rt&&rt.isArrayBuffer,Dr=rt&&rt.isDate,Er=rt&&rt.isMap,Gr=rt&&rt.isRegExp,Ai=rt&&rt.isSet,Ln=rt&&rt.isTypedArray;function Mt(U,B,F){switch(F.length){case 0:return U.call(B);case 1:return U.call(B,F[0]);case 2:return U.call(B,F[0],F[1]);case 3:return U.call(B,F[0],F[1],F[2])}return U.apply(B,F)}function cp(U,B,F,ie){for(var me=-1,Ue=U==null?0:U.length;++me<Ue;){var Ut=U[me];B(ie,Ut,F(Ut),U)}return ie}function Ir(U,B){for(var F=-1,ie=U==null?0:U.length;++F<ie&&B(U[F],F,U)!==!1;);return U}function up(U,B){for(var F=U==null?0:U.length;F--&&B(U[F],F,U)!==!1;);return U}function Cu(U,B){for(var F=-1,ie=U==null?0:U.length;++F<ie;)if(!B(U[F],F,U))return!1;return!0}function bn(U,B){for(var F=-1,ie=U==null?0:U.length,me=0,Ue=[];++F<ie;){var Ut=U[F];B(Ut,F,U)&&(Ue[me++]=Ut)}return Ue}function Us(U,B){var F=U==null?0:U.length;return!!F&&ai(U,B,0)>-1}function wa(U,B,F){for(var ie=-1,me=U==null?0:U.length;++ie<me;)if(F(B,U[ie]))return!0;return!1}function st(U,B){for(var F=-1,ie=U==null?0:U.length,me=Array(ie);++F<ie;)me[F]=B(U[F],F,U);return me}function wn(U,B){for(var F=-1,ie=B.length,me=U.length;++F<ie;)U[me+F]=B[F];return U}function Ea(U,B,F,ie){var me=-1,Ue=U==null?0:U.length;for(ie&&Ue&&(F=U[++me]);++me<Ue;)F=B(F,U[me],me,U);return F}function lp(U,B,F,ie){var me=U==null?0:U.length;for(ie&&me&&(F=U[--me]);me--;)F=B(F,U[me],me,U);return F}function Ia(U,B){for(var F=-1,ie=U==null?0:U.length;++F<ie;)if(B(U[F],F,U))return!0;return!1}var hp=Sa("length");function fp(U){return U.split("")}function dp(U){return U.match(At)||[]}function $u(U,B,F){var ie;return F(U,function(me,Ue,Ut){if(B(me,Ue,Ut))return ie=Ue,!1}),ie}function js(U,B,F,ie){for(var me=U.length,Ue=F+(ie?1:-1);ie?Ue--:++Ue<me;)if(B(U[Ue],Ue,U))return Ue;return-1}function ai(U,B,F){return B===B?Op(U,B,F):js(U,Du,F)}function pp(U,B,F,ie){for(var me=F-1,Ue=U.length;++me<Ue;)if(ie(U[me],B))return me;return-1}function Du(U){return U!==U}function Uu(U,B){var F=U==null?0:U.length;return F?xa(U,B)/F:Y}function Sa(U){return function(B){return B==null?r:B[U]}}function Oa(U){return function(B){return U==null?r:U[B]}}function ju(U,B,F,ie,me){return me(U,function(Ue,Ut,Je){F=ie?(ie=!1,Ue):B(F,Ue,Ut,Je)}),F}function gp(U,B){var F=U.length;for(U.sort(B);F--;)U[F]=U[F].value;return U}function xa(U,B){for(var F,ie=-1,me=U.length;++ie<me;){var Ue=B(U[ie]);Ue!==r&&(F=F===r?Ue:F+Ue)}return F}function Pa(U,B){for(var F=-1,ie=Array(U);++F<U;)ie[F]=B(F);return ie}function yp(U,B){return st(B,function(F){return[F,U[F]]})}function Lu(U){return U&&U.slice(0,zu(U)+1).replace(yt,"")}function gr(U){return function(B){return U(B)}}function Ta(U,B){return st(B,function(F){return U[F]})}function Ci(U,B){return U.has(B)}function Mu(U,B){for(var F=-1,ie=U.length;++F<ie&&ai(B,U[F],0)>-1;);return F}function qu(U,B){for(var F=U.length;F--&&ai(B,U[F],0)>-1;);return F}function mp(U,B){for(var F=U.length,ie=0;F--;)U[F]===B&&++ie;return ie}var vp=Oa(I),_p=Oa(D);function bp(U){return"\\"+re[U]}function wp(U,B){return U==null?r:U[B]}function ci(U){return $s.test(U)}function Ep(U){return jn.test(U)}function Ip(U){for(var B,F=[];!(B=U.next()).done;)F.push(B.value);return F}function Na(U){var B=-1,F=Array(U.size);return U.forEach(function(ie,me){F[++B]=[me,ie]}),F}function Fu(U,B){return function(F){return U(B(F))}}function En(U,B){for(var F=-1,ie=U.length,me=0,Ue=[];++F<ie;){var Ut=U[F];(Ut===B||Ut===w)&&(U[F]=w,Ue[me++]=F)}return Ue}function Ls(U){var B=-1,F=Array(U.size);return U.forEach(function(ie){F[++B]=ie}),F}function Sp(U){var B=-1,F=Array(U.size);return U.forEach(function(ie){F[++B]=[ie,ie]}),F}function Op(U,B,F){for(var ie=F-1,me=U.length;++ie<me;)if(U[ie]===B)return ie;return-1}function xp(U,B,F){for(var ie=F+1;ie--;)if(U[ie]===B)return ie;return ie}function ui(U){return ci(U)?Tp(U):hp(U)}function Ur(U){return ci(U)?Np(U):fp(U)}function zu(U){for(var B=U.length;B--&&bt.test(U.charAt(B)););return B}var Pp=Oa(G);function Tp(U){for(var B=oi.lastIndex=0;oi.test(U);)++B;return B}function Np(U){return U.match(oi)||[]}function Rp(U){return U.match(Cs)||[]}var Ap=function U(B){B=B==null?Te:li.defaults(Te.Object(),B,li.pick(Te,Ds));var F=B.Array,ie=B.Date,me=B.Error,Ue=B.Function,Ut=B.Math,Je=B.Object,Ra=B.RegExp,Cp=B.String,Sr=B.TypeError,Ms=F.prototype,$p=Ue.prototype,hi=Je.prototype,qs=B["__core-js_shared__"],Fs=$p.toString,qe=hi.hasOwnProperty,Dp=0,Hu=function(){var e=/[^.]+$/.exec(qs&&qs.keys&&qs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),zs=hi.toString,Up=Fs.call(Je),jp=Te._,Lp=Ra("^"+Fs.call(qe).replace(gt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Hs=ar?B.Buffer:r,In=B.Symbol,Bs=B.Uint8Array,Bu=Hs?Hs.allocUnsafe:r,Vs=Fu(Je.getPrototypeOf,Je),Vu=Je.create,ku=hi.propertyIsEnumerable,ks=Ms.splice,Ku=In?In.isConcatSpreadable:r,$i=In?In.iterator:r,Mn=In?In.toStringTag:r,Ks=function(){try{var e=Bn(Je,"defineProperty");return e({},"",{}),e}catch{}}(),Mp=B.clearTimeout!==Te.clearTimeout&&B.clearTimeout,qp=ie&&ie.now!==Te.Date.now&&ie.now,Fp=B.setTimeout!==Te.setTimeout&&B.setTimeout,Gs=Ut.ceil,Ws=Ut.floor,Aa=Je.getOwnPropertySymbols,zp=Hs?Hs.isBuffer:r,Gu=B.isFinite,Hp=Ms.join,Bp=Fu(Je.keys,Je),jt=Ut.max,Kt=Ut.min,Vp=ie.now,kp=B.parseInt,Wu=Ut.random,Kp=Ms.reverse,Ca=Bn(B,"DataView"),Di=Bn(B,"Map"),$a=Bn(B,"Promise"),fi=Bn(B,"Set"),Ui=Bn(B,"WeakMap"),ji=Bn(Je,"create"),Js=Ui&&new Ui,di={},Gp=Vn(Ca),Wp=Vn(Di),Jp=Vn($a),Qp=Vn(fi),Yp=Vn(Ui),Qs=In?In.prototype:r,Li=Qs?Qs.valueOf:r,Ju=Qs?Qs.toString:r;function b(e){if(vt(e)&&!_e(e)&&!(e instanceof Pe)){if(e instanceof Or)return e;if(qe.call(e,"__wrapped__"))return Ql(e)}return new Or(e)}var pi=function(){function e(){}return function(n){if(!lt(n))return{};if(Vu)return Vu(n);e.prototype=n;var a=new e;return e.prototype=r,a}}();function Ys(){}function Or(e,n){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=r}b.templateSettings={escape:dt,evaluate:pt,interpolate:ut,variable:"",imports:{_:b}},b.prototype=Ys.prototype,b.prototype.constructor=b,Or.prototype=pi(Ys.prototype),Or.prototype.constructor=Or;function Pe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Z,this.__views__=[]}function Xp(){var e=new Pe(this.__wrapped__);return e.__actions__=cr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=cr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=cr(this.__views__),e}function Zp(){if(this.__filtered__){var e=new Pe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function eg(){var e=this.__wrapped__.value(),n=this.__dir__,a=_e(e),u=n<0,d=a?e.length:0,E=fy(0,d,this.__views__),P=E.start,R=E.end,j=R-P,V=u?R:P-1,k=this.__iteratees__,J=k.length,ee=0,ce=Kt(j,this.__takeCount__);if(!a||!u&&d==j&&ce==j)return _l(e,this.__actions__);var he=[];e:for(;j--&&ee<ce;){V+=n;for(var Ee=-1,fe=e[V];++Ee<J;){var Oe=k[Ee],Ne=Oe.iteratee,vr=Oe.type,rr=Ne(fe);if(vr==$)fe=rr;else if(!rr){if(vr==S)continue e;break e}}he[ee++]=fe}return he}Pe.prototype=pi(Ys.prototype),Pe.prototype.constructor=Pe;function qn(e){var n=-1,a=e==null?0:e.length;for(this.clear();++n<a;){var u=e[n];this.set(u[0],u[1])}}function tg(){this.__data__=ji?ji(null):{},this.size=0}function rg(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}function ng(e){var n=this.__data__;if(ji){var a=n[e];return a===O?r:a}return qe.call(n,e)?n[e]:r}function ig(e){var n=this.__data__;return ji?n[e]!==r:qe.call(n,e)}function sg(e,n){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=ji&&n===r?O:n,this}qn.prototype.clear=tg,qn.prototype.delete=rg,qn.prototype.get=ng,qn.prototype.has=ig,qn.prototype.set=sg;function tn(e){var n=-1,a=e==null?0:e.length;for(this.clear();++n<a;){var u=e[n];this.set(u[0],u[1])}}function og(){this.__data__=[],this.size=0}function ag(e){var n=this.__data__,a=Xs(n,e);if(a<0)return!1;var u=n.length-1;return a==u?n.pop():ks.call(n,a,1),--this.size,!0}function cg(e){var n=this.__data__,a=Xs(n,e);return a<0?r:n[a][1]}function ug(e){return Xs(this.__data__,e)>-1}function lg(e,n){var a=this.__data__,u=Xs(a,e);return u<0?(++this.size,a.push([e,n])):a[u][1]=n,this}tn.prototype.clear=og,tn.prototype.delete=ag,tn.prototype.get=cg,tn.prototype.has=ug,tn.prototype.set=lg;function rn(e){var n=-1,a=e==null?0:e.length;for(this.clear();++n<a;){var u=e[n];this.set(u[0],u[1])}}function hg(){this.size=0,this.__data__={hash:new qn,map:new(Di||tn),string:new qn}}function fg(e){var n=lo(this,e).delete(e);return this.size-=n?1:0,n}function dg(e){return lo(this,e).get(e)}function pg(e){return lo(this,e).has(e)}function gg(e,n){var a=lo(this,e),u=a.size;return a.set(e,n),this.size+=a.size==u?0:1,this}rn.prototype.clear=hg,rn.prototype.delete=fg,rn.prototype.get=dg,rn.prototype.has=pg,rn.prototype.set=gg;function Fn(e){var n=-1,a=e==null?0:e.length;for(this.__data__=new rn;++n<a;)this.add(e[n])}function yg(e){return this.__data__.set(e,O),this}function mg(e){return this.__data__.has(e)}Fn.prototype.add=Fn.prototype.push=yg,Fn.prototype.has=mg;function jr(e){var n=this.__data__=new tn(e);this.size=n.size}function vg(){this.__data__=new tn,this.size=0}function _g(e){var n=this.__data__,a=n.delete(e);return this.size=n.size,a}function bg(e){return this.__data__.get(e)}function wg(e){return this.__data__.has(e)}function Eg(e,n){var a=this.__data__;if(a instanceof tn){var u=a.__data__;if(!Di||u.length<o-1)return u.push([e,n]),this.size=++a.size,this;a=this.__data__=new rn(u)}return a.set(e,n),this.size=a.size,this}jr.prototype.clear=vg,jr.prototype.delete=_g,jr.prototype.get=bg,jr.prototype.has=wg,jr.prototype.set=Eg;function Qu(e,n){var a=_e(e),u=!a&&kn(e),d=!a&&!u&&Tn(e),E=!a&&!u&&!d&&vi(e),P=a||u||d||E,R=P?Pa(e.length,Cp):[],j=R.length;for(var V in e)(n||qe.call(e,V))&&!(P&&(V=="length"||d&&(V=="offset"||V=="parent")||E&&(V=="buffer"||V=="byteLength"||V=="byteOffset")||an(V,j)))&&R.push(V);return R}function Yu(e){var n=e.length;return n?e[Va(0,n-1)]:r}function Ig(e,n){return ho(cr(e),zn(n,0,e.length))}function Sg(e){return ho(cr(e))}function Da(e,n,a){(a!==r&&!Lr(e[n],a)||a===r&&!(n in e))&&nn(e,n,a)}function Mi(e,n,a){var u=e[n];(!(qe.call(e,n)&&Lr(u,a))||a===r&&!(n in e))&&nn(e,n,a)}function Xs(e,n){for(var a=e.length;a--;)if(Lr(e[a][0],n))return a;return-1}function Og(e,n,a,u){return Sn(e,function(d,E,P){n(u,d,a(d),P)}),u}function Xu(e,n){return e&&Jr(n,qt(n),e)}function xg(e,n){return e&&Jr(n,lr(n),e)}function nn(e,n,a){n=="__proto__"&&Ks?Ks(e,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[n]=a}function Ua(e,n){for(var a=-1,u=n.length,d=F(u),E=e==null;++a<u;)d[a]=E?r:gc(e,n[a]);return d}function zn(e,n,a){return e===e&&(a!==r&&(e=e<=a?e:a),n!==r&&(e=e>=n?e:n)),e}function xr(e,n,a,u,d,E){var P,R=n&T,j=n&A,V=n&q;if(a&&(P=d?a(e,u,d,E):a(e)),P!==r)return P;if(!lt(e))return e;var k=_e(e);if(k){if(P=py(e),!R)return cr(e,P)}else{var J=Gt(e),ee=J==ae||J==ye;if(Tn(e))return El(e,R);if(J==xe||J==Ie||ee&&!d){if(P=j||ee?{}:zl(e),!R)return j?ny(e,xg(P,e)):ry(e,Xu(P,e))}else{if(!He[J])return d?e:{};P=gy(e,J,R)}}E||(E=new jr);var ce=E.get(e);if(ce)return ce;E.set(e,P),yh(e)?e.forEach(function(fe){P.add(xr(fe,n,a,fe,e,E))}):ph(e)&&e.forEach(function(fe,Oe){P.set(Oe,xr(fe,n,a,Oe,e,E))});var he=V?j?tc:ec:j?lr:qt,Ee=k?r:he(e);return Ir(Ee||e,function(fe,Oe){Ee&&(Oe=fe,fe=e[Oe]),Mi(P,Oe,xr(fe,n,a,Oe,e,E))}),P}function Pg(e){var n=qt(e);return function(a){return Zu(a,e,n)}}function Zu(e,n,a){var u=a.length;if(e==null)return!u;for(e=Je(e);u--;){var d=a[u],E=n[d],P=e[d];if(P===r&&!(d in e)||!E(P))return!1}return!0}function el(e,n,a){if(typeof e!="function")throw new Sr(f);return ki(function(){e.apply(r,a)},n)}function qi(e,n,a,u){var d=-1,E=Us,P=!0,R=e.length,j=[],V=n.length;if(!R)return j;a&&(n=st(n,gr(a))),u?(E=wa,P=!1):n.length>=o&&(E=Ci,P=!1,n=new Fn(n));e:for(;++d<R;){var k=e[d],J=a==null?k:a(k);if(k=u||k!==0?k:0,P&&J===J){for(var ee=V;ee--;)if(n[ee]===J)continue e;j.push(k)}else E(n,J,u)||j.push(k)}return j}var Sn=Pl(Wr),tl=Pl(La,!0);function Tg(e,n){var a=!0;return Sn(e,function(u,d,E){return a=!!n(u,d,E),a}),a}function Zs(e,n,a){for(var u=-1,d=e.length;++u<d;){var E=e[u],P=n(E);if(P!=null&&(R===r?P===P&&!mr(P):a(P,R)))var R=P,j=E}return j}function Ng(e,n,a,u){var d=e.length;for(a=be(a),a<0&&(a=-a>d?0:d+a),u=u===r||u>d?d:be(u),u<0&&(u+=d),u=a>u?0:vh(u);a<u;)e[a++]=n;return e}function rl(e,n){var a=[];return Sn(e,function(u,d,E){n(u,d,E)&&a.push(u)}),a}function Bt(e,n,a,u,d){var E=-1,P=e.length;for(a||(a=my),d||(d=[]);++E<P;){var R=e[E];n>0&&a(R)?n>1?Bt(R,n-1,a,u,d):wn(d,R):u||(d[d.length]=R)}return d}var ja=Tl(),nl=Tl(!0);function Wr(e,n){return e&&ja(e,n,qt)}function La(e,n){return e&&nl(e,n,qt)}function eo(e,n){return bn(n,function(a){return cn(e[a])})}function Hn(e,n){n=xn(n,e);for(var a=0,u=n.length;e!=null&&a<u;)e=e[Qr(n[a++])];return a&&a==u?e:r}function il(e,n,a){var u=n(e);return _e(e)?u:wn(u,a(e))}function er(e){return e==null?e===r?ct:De:Mn&&Mn in Je(e)?hy(e):Sy(e)}function Ma(e,n){return e>n}function Rg(e,n){return e!=null&&qe.call(e,n)}function Ag(e,n){return e!=null&&n in Je(e)}function Cg(e,n,a){return e>=Kt(n,a)&&e<jt(n,a)}function qa(e,n,a){for(var u=a?wa:Us,d=e[0].length,E=e.length,P=E,R=F(E),j=1/0,V=[];P--;){var k=e[P];P&&n&&(k=st(k,gr(n))),j=Kt(k.length,j),R[P]=!a&&(n||d>=120&&k.length>=120)?new Fn(P&&k):r}k=e[0];var J=-1,ee=R[0];e:for(;++J<d&&V.length<j;){var ce=k[J],he=n?n(ce):ce;if(ce=a||ce!==0?ce:0,!(ee?Ci(ee,he):u(V,he,a))){for(P=E;--P;){var Ee=R[P];if(!(Ee?Ci(Ee,he):u(e[P],he,a)))continue e}ee&&ee.push(he),V.push(ce)}}return V}function $g(e,n,a,u){return Wr(e,function(d,E,P){n(u,a(d),E,P)}),u}function Fi(e,n,a){n=xn(n,e),e=kl(e,n);var u=e==null?e:e[Qr(Tr(n))];return u==null?r:Mt(u,e,a)}function sl(e){return vt(e)&&er(e)==Ie}function Dg(e){return vt(e)&&er(e)==$e}function Ug(e){return vt(e)&&er(e)==M}function zi(e,n,a,u,d){return e===n?!0:e==null||n==null||!vt(e)&&!vt(n)?e!==e&&n!==n:jg(e,n,a,u,zi,d)}function jg(e,n,a,u,d,E){var P=_e(e),R=_e(n),j=P?St:Gt(e),V=R?St:Gt(n);j=j==Ie?xe:j,V=V==Ie?xe:V;var k=j==xe,J=V==xe,ee=j==V;if(ee&&Tn(e)){if(!Tn(n))return!1;P=!0,k=!1}if(ee&&!k)return E||(E=new jr),P||vi(e)?Ml(e,n,a,u,d,E):uy(e,n,j,a,u,d,E);if(!(a&L)){var ce=k&&qe.call(e,"__wrapped__"),he=J&&qe.call(n,"__wrapped__");if(ce||he){var Ee=ce?e.value():e,fe=he?n.value():n;return E||(E=new jr),d(Ee,fe,a,u,E)}}return ee?(E||(E=new jr),ly(e,n,a,u,d,E)):!1}function Lg(e){return vt(e)&&Gt(e)==we}function Fa(e,n,a,u){var d=a.length,E=d,P=!u;if(e==null)return!E;for(e=Je(e);d--;){var R=a[d];if(P&&R[2]?R[1]!==e[R[0]]:!(R[0]in e))return!1}for(;++d<E;){R=a[d];var j=R[0],V=e[j],k=R[1];if(P&&R[2]){if(V===r&&!(j in e))return!1}else{var J=new jr;if(u)var ee=u(V,k,j,e,n,J);if(!(ee===r?zi(k,V,L|K,u,J):ee))return!1}}return!0}function ol(e){if(!lt(e)||_y(e))return!1;var n=cn(e)?Lp:sa;return n.test(Vn(e))}function Mg(e){return vt(e)&&er(e)==at}function qg(e){return vt(e)&&Gt(e)==je}function Fg(e){return vt(e)&&vo(e.length)&&!!Ke[er(e)]}function al(e){return typeof e=="function"?e:e==null?hr:typeof e=="object"?_e(e)?ll(e[0],e[1]):ul(e):Nh(e)}function za(e){if(!Vi(e))return Bp(e);var n=[];for(var a in Je(e))qe.call(e,a)&&a!="constructor"&&n.push(a);return n}function zg(e){if(!lt(e))return Iy(e);var n=Vi(e),a=[];for(var u in e)u=="constructor"&&(n||!qe.call(e,u))||a.push(u);return a}function Ha(e,n){return e<n}function cl(e,n){var a=-1,u=ur(e)?F(e.length):[];return Sn(e,function(d,E,P){u[++a]=n(d,E,P)}),u}function ul(e){var n=nc(e);return n.length==1&&n[0][2]?Bl(n[0][0],n[0][1]):function(a){return a===e||Fa(a,e,n)}}function ll(e,n){return sc(e)&&Hl(n)?Bl(Qr(e),n):function(a){var u=gc(a,e);return u===r&&u===n?yc(a,e):zi(n,u,L|K)}}function to(e,n,a,u,d){e!==n&&ja(n,function(E,P){if(d||(d=new jr),lt(E))Hg(e,n,P,a,to,u,d);else{var R=u?u(ac(e,P),E,P+"",e,n,d):r;R===r&&(R=E),Da(e,P,R)}},lr)}function Hg(e,n,a,u,d,E,P){var R=ac(e,a),j=ac(n,a),V=P.get(j);if(V){Da(e,a,V);return}var k=E?E(R,j,a+"",e,n,P):r,J=k===r;if(J){var ee=_e(j),ce=!ee&&Tn(j),he=!ee&&!ce&&vi(j);k=j,ee||ce||he?_e(R)?k=R:Et(R)?k=cr(R):ce?(J=!1,k=El(j,!0)):he?(J=!1,k=Il(j,!0)):k=[]:Ki(j)||kn(j)?(k=R,kn(R)?k=_h(R):(!lt(R)||cn(R))&&(k=zl(j))):J=!1}J&&(P.set(j,k),d(k,j,u,E,P),P.delete(j)),Da(e,a,k)}function hl(e,n){var a=e.length;if(a)return n+=n<0?a:0,an(n,a)?e[n]:r}function fl(e,n,a){n.length?n=st(n,function(E){return _e(E)?function(P){return Hn(P,E.length===1?E[0]:E)}:E}):n=[hr];var u=-1;n=st(n,gr(le()));var d=cl(e,function(E,P,R){var j=st(n,function(V){return V(E)});return{criteria:j,index:++u,value:E}});return gp(d,function(E,P){return ty(E,P,a)})}function Bg(e,n){return dl(e,n,function(a,u){return yc(e,u)})}function dl(e,n,a){for(var u=-1,d=n.length,E={};++u<d;){var P=n[u],R=Hn(e,P);a(R,P)&&Hi(E,xn(P,e),R)}return E}function Vg(e){return function(n){return Hn(n,e)}}function Ba(e,n,a,u){var d=u?pp:ai,E=-1,P=n.length,R=e;for(e===n&&(n=cr(n)),a&&(R=st(e,gr(a)));++E<P;)for(var j=0,V=n[E],k=a?a(V):V;(j=d(R,k,j,u))>-1;)R!==e&&ks.call(R,j,1),ks.call(e,j,1);return e}function pl(e,n){for(var a=e?n.length:0,u=a-1;a--;){var d=n[a];if(a==u||d!==E){var E=d;an(d)?ks.call(e,d,1):Ga(e,d)}}return e}function Va(e,n){return e+Ws(Wu()*(n-e+1))}function kg(e,n,a,u){for(var d=-1,E=jt(Gs((n-e)/(a||1)),0),P=F(E);E--;)P[u?E:++d]=e,e+=a;return P}function ka(e,n){var a="";if(!e||n<1||n>X)return a;do n%2&&(a+=e),n=Ws(n/2),n&&(e+=e);while(n);return a}function Se(e,n){return cc(Vl(e,n,hr),e+"")}function Kg(e){return Yu(_i(e))}function Gg(e,n){var a=_i(e);return ho(a,zn(n,0,a.length))}function Hi(e,n,a,u){if(!lt(e))return e;n=xn(n,e);for(var d=-1,E=n.length,P=E-1,R=e;R!=null&&++d<E;){var j=Qr(n[d]),V=a;if(j==="__proto__"||j==="constructor"||j==="prototype")return e;if(d!=P){var k=R[j];V=u?u(k,j,R):r,V===r&&(V=lt(k)?k:an(n[d+1])?[]:{})}Mi(R,j,V),R=R[j]}return e}var gl=Js?function(e,n){return Js.set(e,n),e}:hr,Wg=Ks?function(e,n){return Ks(e,"toString",{configurable:!0,enumerable:!1,value:vc(n),writable:!0})}:hr;function Jg(e){return ho(_i(e))}function Pr(e,n,a){var u=-1,d=e.length;n<0&&(n=-n>d?0:d+n),a=a>d?d:a,a<0&&(a+=d),d=n>a?0:a-n>>>0,n>>>=0;for(var E=F(d);++u<d;)E[u]=e[u+n];return E}function Qg(e,n){var a;return Sn(e,function(u,d,E){return a=n(u,d,E),!a}),!!a}function ro(e,n,a){var u=0,d=e==null?u:e.length;if(typeof n=="number"&&n===n&&d<=Ve){for(;u<d;){var E=u+d>>>1,P=e[E];P!==null&&!mr(P)&&(a?P<=n:P<n)?u=E+1:d=E}return d}return Ka(e,n,hr,a)}function Ka(e,n,a,u){var d=0,E=e==null?0:e.length;if(E===0)return 0;n=a(n);for(var P=n!==n,R=n===null,j=mr(n),V=n===r;d<E;){var k=Ws((d+E)/2),J=a(e[k]),ee=J!==r,ce=J===null,he=J===J,Ee=mr(J);if(P)var fe=u||he;else V?fe=he&&(u||ee):R?fe=he&&ee&&(u||!ce):j?fe=he&&ee&&!ce&&(u||!Ee):ce||Ee?fe=!1:fe=u?J<=n:J<n;fe?d=k+1:E=k}return Kt(E,Qe)}function yl(e,n){for(var a=-1,u=e.length,d=0,E=[];++a<u;){var P=e[a],R=n?n(P):P;if(!a||!Lr(R,j)){var j=R;E[d++]=P===0?0:P}}return E}function ml(e){return typeof e=="number"?e:mr(e)?Y:+e}function yr(e){if(typeof e=="string")return e;if(_e(e))return st(e,yr)+"";if(mr(e))return Ju?Ju.call(e):"";var n=e+"";return n=="0"&&1/e==-de?"-0":n}function On(e,n,a){var u=-1,d=Us,E=e.length,P=!0,R=[],j=R;if(a)P=!1,d=wa;else if(E>=o){var V=n?null:ay(e);if(V)return Ls(V);P=!1,d=Ci,j=new Fn}else j=n?[]:R;e:for(;++u<E;){var k=e[u],J=n?n(k):k;if(k=a||k!==0?k:0,P&&J===J){for(var ee=j.length;ee--;)if(j[ee]===J)continue e;n&&j.push(J),R.push(k)}else d(j,J,a)||(j!==R&&j.push(J),R.push(k))}return R}function Ga(e,n){return n=xn(n,e),e=kl(e,n),e==null||delete e[Qr(Tr(n))]}function vl(e,n,a,u){return Hi(e,n,a(Hn(e,n)),u)}function no(e,n,a,u){for(var d=e.length,E=u?d:-1;(u?E--:++E<d)&&n(e[E],E,e););return a?Pr(e,u?0:E,u?E+1:d):Pr(e,u?E+1:0,u?d:E)}function _l(e,n){var a=e;return a instanceof Pe&&(a=a.value()),Ea(n,function(u,d){return d.func.apply(d.thisArg,wn([u],d.args))},a)}function Wa(e,n,a){var u=e.length;if(u<2)return u?On(e[0]):[];for(var d=-1,E=F(u);++d<u;)for(var P=e[d],R=-1;++R<u;)R!=d&&(E[d]=qi(E[d]||P,e[R],n,a));return On(Bt(E,1),n,a)}function bl(e,n,a){for(var u=-1,d=e.length,E=n.length,P={};++u<d;){var R=u<E?n[u]:r;a(P,e[u],R)}return P}function Ja(e){return Et(e)?e:[]}function Qa(e){return typeof e=="function"?e:hr}function xn(e,n){return _e(e)?e:sc(e,n)?[e]:Jl(Le(e))}var Yg=Se;function Pn(e,n,a){var u=e.length;return a=a===r?u:a,!n&&a>=u?e:Pr(e,n,a)}var wl=Mp||function(e){return Te.clearTimeout(e)};function El(e,n){if(n)return e.slice();var a=e.length,u=Bu?Bu(a):new e.constructor(a);return e.copy(u),u}function Ya(e){var n=new e.constructor(e.byteLength);return new Bs(n).set(new Bs(e)),n}function Xg(e,n){var a=n?Ya(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function Zg(e){var n=new e.constructor(e.source,wr.exec(e));return n.lastIndex=e.lastIndex,n}function ey(e){return Li?Je(Li.call(e)):{}}function Il(e,n){var a=n?Ya(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function Sl(e,n){if(e!==n){var a=e!==r,u=e===null,d=e===e,E=mr(e),P=n!==r,R=n===null,j=n===n,V=mr(n);if(!R&&!V&&!E&&e>n||E&&P&&j&&!R&&!V||u&&P&&j||!a&&j||!d)return 1;if(!u&&!E&&!V&&e<n||V&&a&&d&&!u&&!E||R&&a&&d||!P&&d||!j)return-1}return 0}function ty(e,n,a){for(var u=-1,d=e.criteria,E=n.criteria,P=d.length,R=a.length;++u<P;){var j=Sl(d[u],E[u]);if(j){if(u>=R)return j;var V=a[u];return j*(V=="desc"?-1:1)}}return e.index-n.index}function Ol(e,n,a,u){for(var d=-1,E=e.length,P=a.length,R=-1,j=n.length,V=jt(E-P,0),k=F(j+V),J=!u;++R<j;)k[R]=n[R];for(;++d<P;)(J||d<E)&&(k[a[d]]=e[d]);for(;V--;)k[R++]=e[d++];return k}function xl(e,n,a,u){for(var d=-1,E=e.length,P=-1,R=a.length,j=-1,V=n.length,k=jt(E-R,0),J=F(k+V),ee=!u;++d<k;)J[d]=e[d];for(var ce=d;++j<V;)J[ce+j]=n[j];for(;++P<R;)(ee||d<E)&&(J[ce+a[P]]=e[d++]);return J}function cr(e,n){var a=-1,u=e.length;for(n||(n=F(u));++a<u;)n[a]=e[a];return n}function Jr(e,n,a,u){var d=!a;a||(a={});for(var E=-1,P=n.length;++E<P;){var R=n[E],j=u?u(a[R],e[R],R,a,e):r;j===r&&(j=e[R]),d?nn(a,R,j):Mi(a,R,j)}return a}function ry(e,n){return Jr(e,ic(e),n)}function ny(e,n){return Jr(e,ql(e),n)}function io(e,n){return function(a,u){var d=_e(a)?cp:Og,E=n?n():{};return d(a,e,le(u,2),E)}}function gi(e){return Se(function(n,a){var u=-1,d=a.length,E=d>1?a[d-1]:r,P=d>2?a[2]:r;for(E=e.length>3&&typeof E=="function"?(d--,E):r,P&&tr(a[0],a[1],P)&&(E=d<3?r:E,d=1),n=Je(n);++u<d;){var R=a[u];R&&e(n,R,u,E)}return n})}function Pl(e,n){return function(a,u){if(a==null)return a;if(!ur(a))return e(a,u);for(var d=a.length,E=n?d:-1,P=Je(a);(n?E--:++E<d)&&u(P[E],E,P)!==!1;);return a}}function Tl(e){return function(n,a,u){for(var d=-1,E=Je(n),P=u(n),R=P.length;R--;){var j=P[e?R:++d];if(a(E[j],j,E)===!1)break}return n}}function iy(e,n,a){var u=n&te,d=Bi(e);function E(){var P=this&&this!==Te&&this instanceof E?d:e;return P.apply(u?a:this,arguments)}return E}function Nl(e){return function(n){n=Le(n);var a=ci(n)?Ur(n):r,u=a?a[0]:n.charAt(0),d=a?Pn(a,1).join(""):n.slice(1);return u[e]()+d}}function yi(e){return function(n){return Ea(Ph(xh(n).replace(Ri,"")),e,"")}}function Bi(e){return function(){var n=arguments;switch(n.length){case 0:return new e;case 1:return new e(n[0]);case 2:return new e(n[0],n[1]);case 3:return new e(n[0],n[1],n[2]);case 4:return new e(n[0],n[1],n[2],n[3]);case 5:return new e(n[0],n[1],n[2],n[3],n[4]);case 6:return new e(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new e(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=pi(e.prototype),u=e.apply(a,n);return lt(u)?u:a}}function sy(e,n,a){var u=Bi(e);function d(){for(var E=arguments.length,P=F(E),R=E,j=mi(d);R--;)P[R]=arguments[R];var V=E<3&&P[0]!==j&&P[E-1]!==j?[]:En(P,j);if(E-=V.length,E<a)return Dl(e,n,so,d.placeholder,r,P,V,r,r,a-E);var k=this&&this!==Te&&this instanceof d?u:e;return Mt(k,this,P)}return d}function Rl(e){return function(n,a,u){var d=Je(n);if(!ur(n)){var E=le(a,3);n=qt(n),a=function(R){return E(d[R],R,d)}}var P=e(n,a,u);return P>-1?d[E?n[P]:P]:r}}function Al(e){return on(function(n){var a=n.length,u=a,d=Or.prototype.thru;for(e&&n.reverse();u--;){var E=n[u];if(typeof E!="function")throw new Sr(f);if(d&&!P&&uo(E)=="wrapper")var P=new Or([],!0)}for(u=P?u:a;++u<a;){E=n[u];var R=uo(E),j=R=="wrapper"?rc(E):r;j&&oc(j[0])&&j[1]==(N|p|m|x)&&!j[4].length&&j[9]==1?P=P[uo(j[0])].apply(P,j[3]):P=E.length==1&&oc(E)?P[R]():P.thru(E)}return function(){var V=arguments,k=V[0];if(P&&V.length==1&&_e(k))return P.plant(k).value();for(var J=0,ee=a?n[J].apply(this,V):k;++J<a;)ee=n[J].call(this,ee);return ee}})}function so(e,n,a,u,d,E,P,R,j,V){var k=n&N,J=n&te,ee=n&ue,ce=n&(p|_),he=n&Q,Ee=ee?r:Bi(e);function fe(){for(var Oe=arguments.length,Ne=F(Oe),vr=Oe;vr--;)Ne[vr]=arguments[vr];if(ce)var rr=mi(fe),_r=mp(Ne,rr);if(u&&(Ne=Ol(Ne,u,d,ce)),E&&(Ne=xl(Ne,E,P,ce)),Oe-=_r,ce&&Oe<V){var It=En(Ne,rr);return Dl(e,n,so,fe.placeholder,a,Ne,It,R,j,V-Oe)}var Mr=J?a:this,ln=ee?Mr[e]:e;return Oe=Ne.length,R?Ne=Oy(Ne,R):he&&Oe>1&&Ne.reverse(),k&&j<Oe&&(Ne.length=j),this&&this!==Te&&this instanceof fe&&(ln=Ee||Bi(ln)),ln.apply(Mr,Ne)}return fe}function Cl(e,n){return function(a,u){return $g(a,e,n(u),{})}}function oo(e,n){return function(a,u){var d;if(a===r&&u===r)return n;if(a!==r&&(d=a),u!==r){if(d===r)return u;typeof a=="string"||typeof u=="string"?(a=yr(a),u=yr(u)):(a=ml(a),u=ml(u)),d=e(a,u)}return d}}function Xa(e){return on(function(n){return n=st(n,gr(le())),Se(function(a){var u=this;return e(n,function(d){return Mt(d,u,a)})})})}function ao(e,n){n=n===r?" ":yr(n);var a=n.length;if(a<2)return a?ka(n,e):n;var u=ka(n,Gs(e/ui(n)));return ci(n)?Pn(Ur(u),0,e).join(""):u.slice(0,e)}function oy(e,n,a,u){var d=n&te,E=Bi(e);function P(){for(var R=-1,j=arguments.length,V=-1,k=u.length,J=F(k+j),ee=this&&this!==Te&&this instanceof P?E:e;++V<k;)J[V]=u[V];for(;j--;)J[V++]=arguments[++R];return Mt(ee,d?a:this,J)}return P}function $l(e){return function(n,a,u){return u&&typeof u!="number"&&tr(n,a,u)&&(a=u=r),n=un(n),a===r?(a=n,n=0):a=un(a),u=u===r?n<a?1:-1:un(u),kg(n,a,u,e)}}function co(e){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=Nr(n),a=Nr(a)),e(n,a)}}function Dl(e,n,a,u,d,E,P,R,j,V){var k=n&p,J=k?P:r,ee=k?r:P,ce=k?E:r,he=k?r:E;n|=k?m:y,n&=~(k?y:m),n&l||(n&=~(te|ue));var Ee=[e,n,d,ce,J,he,ee,R,j,V],fe=a.apply(r,Ee);return oc(e)&&Kl(fe,Ee),fe.placeholder=u,Gl(fe,e,n)}function Za(e){var n=Ut[e];return function(a,u){if(a=Nr(a),u=u==null?0:Kt(be(u),292),u&&Gu(a)){var d=(Le(a)+"e").split("e"),E=n(d[0]+"e"+(+d[1]+u));return d=(Le(E)+"e").split("e"),+(d[0]+"e"+(+d[1]-u))}return n(a)}}var ay=fi&&1/Ls(new fi([,-0]))[1]==de?function(e){return new fi(e)}:wc;function Ul(e){return function(n){var a=Gt(n);return a==we?Na(n):a==je?Sp(n):yp(n,e(n))}}function sn(e,n,a,u,d,E,P,R){var j=n&ue;if(!j&&typeof e!="function")throw new Sr(f);var V=u?u.length:0;if(V||(n&=~(m|y),u=d=r),P=P===r?P:jt(be(P),0),R=R===r?R:be(R),V-=d?d.length:0,n&y){var k=u,J=d;u=d=r}var ee=j?r:rc(e),ce=[e,n,a,u,d,k,J,E,P,R];if(ee&&Ey(ce,ee),e=ce[0],n=ce[1],a=ce[2],u=ce[3],d=ce[4],R=ce[9]=ce[9]===r?j?0:e.length:jt(ce[9]-V,0),!R&&n&(p|_)&&(n&=~(p|_)),!n||n==te)var he=iy(e,n,a);else n==p||n==_?he=sy(e,n,R):(n==m||n==(te|m))&&!d.length?he=oy(e,n,a,u):he=so.apply(r,ce);var Ee=ee?gl:Kl;return Gl(Ee(he,ce),e,n)}function jl(e,n,a,u){return e===r||Lr(e,hi[a])&&!qe.call(u,a)?n:e}function Ll(e,n,a,u,d,E){return lt(e)&&lt(n)&&(E.set(n,e),to(e,n,r,Ll,E),E.delete(n)),e}function cy(e){return Ki(e)?r:e}function Ml(e,n,a,u,d,E){var P=a&L,R=e.length,j=n.length;if(R!=j&&!(P&&j>R))return!1;var V=E.get(e),k=E.get(n);if(V&&k)return V==n&&k==e;var J=-1,ee=!0,ce=a&K?new Fn:r;for(E.set(e,n),E.set(n,e);++J<R;){var he=e[J],Ee=n[J];if(u)var fe=P?u(Ee,he,J,n,e,E):u(he,Ee,J,e,n,E);if(fe!==r){if(fe)continue;ee=!1;break}if(ce){if(!Ia(n,function(Oe,Ne){if(!Ci(ce,Ne)&&(he===Oe||d(he,Oe,a,u,E)))return ce.push(Ne)})){ee=!1;break}}else if(!(he===Ee||d(he,Ee,a,u,E))){ee=!1;break}}return E.delete(e),E.delete(n),ee}function uy(e,n,a,u,d,E,P){switch(a){case ke:if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case $e:return!(e.byteLength!=n.byteLength||!E(new Bs(e),new Bs(n)));case z:case M:case Ce:return Lr(+e,+n);case C:return e.name==n.name&&e.message==n.message;case at:case Xe:return e==n+"";case we:var R=Na;case je:var j=u&L;if(R||(R=Ls),e.size!=n.size&&!j)return!1;var V=P.get(e);if(V)return V==n;u|=K,P.set(e,n);var k=Ml(R(e),R(n),u,d,E,P);return P.delete(e),k;case Ze:if(Li)return Li.call(e)==Li.call(n)}return!1}function ly(e,n,a,u,d,E){var P=a&L,R=ec(e),j=R.length,V=ec(n),k=V.length;if(j!=k&&!P)return!1;for(var J=j;J--;){var ee=R[J];if(!(P?ee in n:qe.call(n,ee)))return!1}var ce=E.get(e),he=E.get(n);if(ce&&he)return ce==n&&he==e;var Ee=!0;E.set(e,n),E.set(n,e);for(var fe=P;++J<j;){ee=R[J];var Oe=e[ee],Ne=n[ee];if(u)var vr=P?u(Ne,Oe,ee,n,e,E):u(Oe,Ne,ee,e,n,E);if(!(vr===r?Oe===Ne||d(Oe,Ne,a,u,E):vr)){Ee=!1;break}fe||(fe=ee=="constructor")}if(Ee&&!fe){var rr=e.constructor,_r=n.constructor;rr!=_r&&"constructor"in e&&"constructor"in n&&!(typeof rr=="function"&&rr instanceof rr&&typeof _r=="function"&&_r instanceof _r)&&(Ee=!1)}return E.delete(e),E.delete(n),Ee}function on(e){return cc(Vl(e,r,Zl),e+"")}function ec(e){return il(e,qt,ic)}function tc(e){return il(e,lr,ql)}var rc=Js?function(e){return Js.get(e)}:wc;function uo(e){for(var n=e.name+"",a=di[n],u=qe.call(di,n)?a.length:0;u--;){var d=a[u],E=d.func;if(E==null||E==e)return d.name}return n}function mi(e){var n=qe.call(b,"placeholder")?b:e;return n.placeholder}function le(){var e=b.iteratee||_c;return e=e===_c?al:e,arguments.length?e(arguments[0],arguments[1]):e}function lo(e,n){var a=e.__data__;return vy(n)?a[typeof n=="string"?"string":"hash"]:a.map}function nc(e){for(var n=qt(e),a=n.length;a--;){var u=n[a],d=e[u];n[a]=[u,d,Hl(d)]}return n}function Bn(e,n){var a=wp(e,n);return ol(a)?a:r}function hy(e){var n=qe.call(e,Mn),a=e[Mn];try{e[Mn]=r;var u=!0}catch{}var d=zs.call(e);return u&&(n?e[Mn]=a:delete e[Mn]),d}var ic=Aa?function(e){return e==null?[]:(e=Je(e),bn(Aa(e),function(n){return ku.call(e,n)}))}:Ec,ql=Aa?function(e){for(var n=[];e;)wn(n,ic(e)),e=Vs(e);return n}:Ec,Gt=er;(Ca&&Gt(new Ca(new ArrayBuffer(1)))!=ke||Di&&Gt(new Di)!=we||$a&&Gt($a.resolve())!=Ot||fi&&Gt(new fi)!=je||Ui&&Gt(new Ui)!=ze)&&(Gt=function(e){var n=er(e),a=n==xe?e.constructor:r,u=a?Vn(a):"";if(u)switch(u){case Gp:return ke;case Wp:return we;case Jp:return Ot;case Qp:return je;case Yp:return ze}return n});function fy(e,n,a){for(var u=-1,d=a.length;++u<d;){var E=a[u],P=E.size;switch(E.type){case"drop":e+=P;break;case"dropRight":n-=P;break;case"take":n=Kt(n,e+P);break;case"takeRight":e=jt(e,n-P);break}}return{start:e,end:n}}function dy(e){var n=e.match(Ye);return n?n[1].split(Rt):[]}function Fl(e,n,a){n=xn(n,e);for(var u=-1,d=n.length,E=!1;++u<d;){var P=Qr(n[u]);if(!(E=e!=null&&a(e,P)))break;e=e[P]}return E||++u!=d?E:(d=e==null?0:e.length,!!d&&vo(d)&&an(P,d)&&(_e(e)||kn(e)))}function py(e){var n=e.length,a=new e.constructor(n);return n&&typeof e[0]=="string"&&qe.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function zl(e){return typeof e.constructor=="function"&&!Vi(e)?pi(Vs(e)):{}}function gy(e,n,a){var u=e.constructor;switch(n){case $e:return Ya(e);case z:case M:return new u(+e);case ke:return Xg(e,a);case ht:case Me:case xt:case Dt:case zt:case Ht:case Lt:case Yt:case or:return Il(e,a);case we:return new u;case Ce:case Xe:return new u(e);case at:return Zg(e);case je:return new u;case Ze:return ey(e)}}function yy(e,n){var a=n.length;if(!a)return e;var u=a-1;return n[u]=(a>1?"& ":"")+n[u],n=n.join(a>2?", ":" "),e.replace(mt,`{
/* [wrapped with `+n+`] */
`)}function my(e){return _e(e)||kn(e)||!!(Ku&&e&&e[Ku])}function an(e,n){var a=typeof e;return n=n??X,!!n&&(a=="number"||a!="symbol"&&aa.test(e))&&e>-1&&e%1==0&&e<n}function tr(e,n,a){if(!lt(a))return!1;var u=typeof n;return(u=="number"?ur(a)&&an(n,a.length):u=="string"&&n in a)?Lr(a[n],e):!1}function sc(e,n){if(_e(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||mr(e)?!0:Pt.test(e)||!it.test(e)||n!=null&&e in Je(n)}function vy(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}function oc(e){var n=uo(e),a=b[n];if(typeof a!="function"||!(n in Pe.prototype))return!1;if(e===a)return!0;var u=rc(a);return!!u&&e===u[0]}function _y(e){return!!Hu&&Hu in e}var by=qs?cn:Ic;function Vi(e){var n=e&&e.constructor,a=typeof n=="function"&&n.prototype||hi;return e===a}function Hl(e){return e===e&&!lt(e)}function Bl(e,n){return function(a){return a==null?!1:a[e]===n&&(n!==r||e in Je(a))}}function wy(e){var n=yo(e,function(u){return a.size===g&&a.clear(),u}),a=n.cache;return n}function Ey(e,n){var a=e[1],u=n[1],d=a|u,E=d<(te|ue|N),P=u==N&&a==p||u==N&&a==x&&e[7].length<=n[8]||u==(N|x)&&n[7].length<=n[8]&&a==p;if(!(E||P))return e;u&te&&(e[2]=n[2],d|=a&te?0:l);var R=n[3];if(R){var j=e[3];e[3]=j?Ol(j,R,n[4]):R,e[4]=j?En(e[3],w):n[4]}return R=n[5],R&&(j=e[5],e[5]=j?xl(j,R,n[6]):R,e[6]=j?En(e[5],w):n[6]),R=n[7],R&&(e[7]=R),u&N&&(e[8]=e[8]==null?n[8]:Kt(e[8],n[8])),e[9]==null&&(e[9]=n[9]),e[0]=n[0],e[1]=d,e}function Iy(e){var n=[];if(e!=null)for(var a in Je(e))n.push(a);return n}function Sy(e){return zs.call(e)}function Vl(e,n,a){return n=jt(n===r?e.length-1:n,0),function(){for(var u=arguments,d=-1,E=jt(u.length-n,0),P=F(E);++d<E;)P[d]=u[n+d];d=-1;for(var R=F(n+1);++d<n;)R[d]=u[d];return R[n]=a(P),Mt(e,this,R)}}function kl(e,n){return n.length<2?e:Hn(e,Pr(n,0,-1))}function Oy(e,n){for(var a=e.length,u=Kt(n.length,a),d=cr(e);u--;){var E=n[u];e[u]=an(E,a)?d[E]:r}return e}function ac(e,n){if(!(n==="constructor"&&typeof e[n]=="function")&&n!="__proto__")return e[n]}var Kl=Wl(gl),ki=Fp||function(e,n){return Te.setTimeout(e,n)},cc=Wl(Wg);function Gl(e,n,a){var u=n+"";return cc(e,yy(u,xy(dy(u),a)))}function Wl(e){var n=0,a=0;return function(){var u=Vp(),d=Fe-(u-a);if(a=u,d>0){if(++n>=Ae)return arguments[0]}else n=0;return e.apply(r,arguments)}}function ho(e,n){var a=-1,u=e.length,d=u-1;for(n=n===r?u:n;++a<n;){var E=Va(a,d),P=e[E];e[E]=e[a],e[a]=P}return e.length=n,e}var Jl=wy(function(e){var n=[];return e.charCodeAt(0)===46&&n.push(""),e.replace(Tt,function(a,u,d,E){n.push(d?E.replace(ta,"$1"):u||a)}),n});function Qr(e){if(typeof e=="string"||mr(e))return e;var n=e+"";return n=="0"&&1/e==-de?"-0":n}function Vn(e){if(e!=null){try{return Fs.call(e)}catch{}try{return e+""}catch{}}return""}function xy(e,n){return Ir(Vr,function(a){var u="_."+a[0];n&a[1]&&!Us(e,u)&&e.push(u)}),e.sort()}function Ql(e){if(e instanceof Pe)return e.clone();var n=new Or(e.__wrapped__,e.__chain__);return n.__actions__=cr(e.__actions__),n.__index__=e.__index__,n.__values__=e.__values__,n}function Py(e,n,a){(a?tr(e,n,a):n===r)?n=1:n=jt(be(n),0);var u=e==null?0:e.length;if(!u||n<1)return[];for(var d=0,E=0,P=F(Gs(u/n));d<u;)P[E++]=Pr(e,d,d+=n);return P}function Ty(e){for(var n=-1,a=e==null?0:e.length,u=0,d=[];++n<a;){var E=e[n];E&&(d[u++]=E)}return d}function Ny(){var e=arguments.length;if(!e)return[];for(var n=F(e-1),a=arguments[0],u=e;u--;)n[u-1]=arguments[u];return wn(_e(a)?cr(a):[a],Bt(n,1))}var Ry=Se(function(e,n){return Et(e)?qi(e,Bt(n,1,Et,!0)):[]}),Ay=Se(function(e,n){var a=Tr(n);return Et(a)&&(a=r),Et(e)?qi(e,Bt(n,1,Et,!0),le(a,2)):[]}),Cy=Se(function(e,n){var a=Tr(n);return Et(a)&&(a=r),Et(e)?qi(e,Bt(n,1,Et,!0),r,a):[]});function $y(e,n,a){var u=e==null?0:e.length;return u?(n=a||n===r?1:be(n),Pr(e,n<0?0:n,u)):[]}function Dy(e,n,a){var u=e==null?0:e.length;return u?(n=a||n===r?1:be(n),n=u-n,Pr(e,0,n<0?0:n)):[]}function Uy(e,n){return e&&e.length?no(e,le(n,3),!0,!0):[]}function jy(e,n){return e&&e.length?no(e,le(n,3),!0):[]}function Ly(e,n,a,u){var d=e==null?0:e.length;return d?(a&&typeof a!="number"&&tr(e,n,a)&&(a=0,u=d),Ng(e,n,a,u)):[]}function Yl(e,n,a){var u=e==null?0:e.length;if(!u)return-1;var d=a==null?0:be(a);return d<0&&(d=jt(u+d,0)),js(e,le(n,3),d)}function Xl(e,n,a){var u=e==null?0:e.length;if(!u)return-1;var d=u-1;return a!==r&&(d=be(a),d=a<0?jt(u+d,0):Kt(d,u-1)),js(e,le(n,3),d,!0)}function Zl(e){var n=e==null?0:e.length;return n?Bt(e,1):[]}function My(e){var n=e==null?0:e.length;return n?Bt(e,de):[]}function qy(e,n){var a=e==null?0:e.length;return a?(n=n===r?1:be(n),Bt(e,n)):[]}function Fy(e){for(var n=-1,a=e==null?0:e.length,u={};++n<a;){var d=e[n];u[d[0]]=d[1]}return u}function eh(e){return e&&e.length?e[0]:r}function zy(e,n,a){var u=e==null?0:e.length;if(!u)return-1;var d=a==null?0:be(a);return d<0&&(d=jt(u+d,0)),ai(e,n,d)}function Hy(e){var n=e==null?0:e.length;return n?Pr(e,0,-1):[]}var By=Se(function(e){var n=st(e,Ja);return n.length&&n[0]===e[0]?qa(n):[]}),Vy=Se(function(e){var n=Tr(e),a=st(e,Ja);return n===Tr(a)?n=r:a.pop(),a.length&&a[0]===e[0]?qa(a,le(n,2)):[]}),ky=Se(function(e){var n=Tr(e),a=st(e,Ja);return n=typeof n=="function"?n:r,n&&a.pop(),a.length&&a[0]===e[0]?qa(a,r,n):[]});function Ky(e,n){return e==null?"":Hp.call(e,n)}function Tr(e){var n=e==null?0:e.length;return n?e[n-1]:r}function Gy(e,n,a){var u=e==null?0:e.length;if(!u)return-1;var d=u;return a!==r&&(d=be(a),d=d<0?jt(u+d,0):Kt(d,u-1)),n===n?xp(e,n,d):js(e,Du,d,!0)}function Wy(e,n){return e&&e.length?hl(e,be(n)):r}var Jy=Se(th);function th(e,n){return e&&e.length&&n&&n.length?Ba(e,n):e}function Qy(e,n,a){return e&&e.length&&n&&n.length?Ba(e,n,le(a,2)):e}function Yy(e,n,a){return e&&e.length&&n&&n.length?Ba(e,n,r,a):e}var Xy=on(function(e,n){var a=e==null?0:e.length,u=Ua(e,n);return pl(e,st(n,function(d){return an(d,a)?+d:d}).sort(Sl)),u});function Zy(e,n){var a=[];if(!(e&&e.length))return a;var u=-1,d=[],E=e.length;for(n=le(n,3);++u<E;){var P=e[u];n(P,u,e)&&(a.push(P),d.push(u))}return pl(e,d),a}function uc(e){return e==null?e:Kp.call(e)}function em(e,n,a){var u=e==null?0:e.length;return u?(a&&typeof a!="number"&&tr(e,n,a)?(n=0,a=u):(n=n==null?0:be(n),a=a===r?u:be(a)),Pr(e,n,a)):[]}function tm(e,n){return ro(e,n)}function rm(e,n,a){return Ka(e,n,le(a,2))}function nm(e,n){var a=e==null?0:e.length;if(a){var u=ro(e,n);if(u<a&&Lr(e[u],n))return u}return-1}function im(e,n){return ro(e,n,!0)}function sm(e,n,a){return Ka(e,n,le(a,2),!0)}function om(e,n){var a=e==null?0:e.length;if(a){var u=ro(e,n,!0)-1;if(Lr(e[u],n))return u}return-1}function am(e){return e&&e.length?yl(e):[]}function cm(e,n){return e&&e.length?yl(e,le(n,2)):[]}function um(e){var n=e==null?0:e.length;return n?Pr(e,1,n):[]}function lm(e,n,a){return e&&e.length?(n=a||n===r?1:be(n),Pr(e,0,n<0?0:n)):[]}function hm(e,n,a){var u=e==null?0:e.length;return u?(n=a||n===r?1:be(n),n=u-n,Pr(e,n<0?0:n,u)):[]}function fm(e,n){return e&&e.length?no(e,le(n,3),!1,!0):[]}function dm(e,n){return e&&e.length?no(e,le(n,3)):[]}var pm=Se(function(e){return On(Bt(e,1,Et,!0))}),gm=Se(function(e){var n=Tr(e);return Et(n)&&(n=r),On(Bt(e,1,Et,!0),le(n,2))}),ym=Se(function(e){var n=Tr(e);return n=typeof n=="function"?n:r,On(Bt(e,1,Et,!0),r,n)});function mm(e){return e&&e.length?On(e):[]}function vm(e,n){return e&&e.length?On(e,le(n,2)):[]}function _m(e,n){return n=typeof n=="function"?n:r,e&&e.length?On(e,r,n):[]}function lc(e){if(!(e&&e.length))return[];var n=0;return e=bn(e,function(a){if(Et(a))return n=jt(a.length,n),!0}),Pa(n,function(a){return st(e,Sa(a))})}function rh(e,n){if(!(e&&e.length))return[];var a=lc(e);return n==null?a:st(a,function(u){return Mt(n,r,u)})}var bm=Se(function(e,n){return Et(e)?qi(e,n):[]}),wm=Se(function(e){return Wa(bn(e,Et))}),Em=Se(function(e){var n=Tr(e);return Et(n)&&(n=r),Wa(bn(e,Et),le(n,2))}),Im=Se(function(e){var n=Tr(e);return n=typeof n=="function"?n:r,Wa(bn(e,Et),r,n)}),Sm=Se(lc);function Om(e,n){return bl(e||[],n||[],Mi)}function xm(e,n){return bl(e||[],n||[],Hi)}var Pm=Se(function(e){var n=e.length,a=n>1?e[n-1]:r;return a=typeof a=="function"?(e.pop(),a):r,rh(e,a)});function nh(e){var n=b(e);return n.__chain__=!0,n}function Tm(e,n){return n(e),e}function fo(e,n){return n(e)}var Nm=on(function(e){var n=e.length,a=n?e[0]:0,u=this.__wrapped__,d=function(E){return Ua(E,e)};return n>1||this.__actions__.length||!(u instanceof Pe)||!an(a)?this.thru(d):(u=u.slice(a,+a+(n?1:0)),u.__actions__.push({func:fo,args:[d],thisArg:r}),new Or(u,this.__chain__).thru(function(E){return n&&!E.length&&E.push(r),E}))});function Rm(){return nh(this)}function Am(){return new Or(this.value(),this.__chain__)}function Cm(){this.__values__===r&&(this.__values__=mh(this.value()));var e=this.__index__>=this.__values__.length,n=e?r:this.__values__[this.__index__++];return{done:e,value:n}}function $m(){return this}function Dm(e){for(var n,a=this;a instanceof Ys;){var u=Ql(a);u.__index__=0,u.__values__=r,n?d.__wrapped__=u:n=u;var d=u;a=a.__wrapped__}return d.__wrapped__=e,n}function Um(){var e=this.__wrapped__;if(e instanceof Pe){var n=e;return this.__actions__.length&&(n=new Pe(this)),n=n.reverse(),n.__actions__.push({func:fo,args:[uc],thisArg:r}),new Or(n,this.__chain__)}return this.thru(uc)}function jm(){return _l(this.__wrapped__,this.__actions__)}var Lm=io(function(e,n,a){qe.call(e,a)?++e[a]:nn(e,a,1)});function Mm(e,n,a){var u=_e(e)?Cu:Tg;return a&&tr(e,n,a)&&(n=r),u(e,le(n,3))}function qm(e,n){var a=_e(e)?bn:rl;return a(e,le(n,3))}var Fm=Rl(Yl),zm=Rl(Xl);function Hm(e,n){return Bt(po(e,n),1)}function Bm(e,n){return Bt(po(e,n),de)}function Vm(e,n,a){return a=a===r?1:be(a),Bt(po(e,n),a)}function ih(e,n){var a=_e(e)?Ir:Sn;return a(e,le(n,3))}function sh(e,n){var a=_e(e)?up:tl;return a(e,le(n,3))}var km=io(function(e,n,a){qe.call(e,a)?e[a].push(n):nn(e,a,[n])});function Km(e,n,a,u){e=ur(e)?e:_i(e),a=a&&!u?be(a):0;var d=e.length;return a<0&&(a=jt(d+a,0)),_o(e)?a<=d&&e.indexOf(n,a)>-1:!!d&&ai(e,n,a)>-1}var Gm=Se(function(e,n,a){var u=-1,d=typeof n=="function",E=ur(e)?F(e.length):[];return Sn(e,function(P){E[++u]=d?Mt(n,P,a):Fi(P,n,a)}),E}),Wm=io(function(e,n,a){nn(e,a,n)});function po(e,n){var a=_e(e)?st:cl;return a(e,le(n,3))}function Jm(e,n,a,u){return e==null?[]:(_e(n)||(n=n==null?[]:[n]),a=u?r:a,_e(a)||(a=a==null?[]:[a]),fl(e,n,a))}var Qm=io(function(e,n,a){e[a?0:1].push(n)},function(){return[[],[]]});function Ym(e,n,a){var u=_e(e)?Ea:ju,d=arguments.length<3;return u(e,le(n,4),a,d,Sn)}function Xm(e,n,a){var u=_e(e)?lp:ju,d=arguments.length<3;return u(e,le(n,4),a,d,tl)}function Zm(e,n){var a=_e(e)?bn:rl;return a(e,mo(le(n,3)))}function e0(e){var n=_e(e)?Yu:Kg;return n(e)}function t0(e,n,a){(a?tr(e,n,a):n===r)?n=1:n=be(n);var u=_e(e)?Ig:Gg;return u(e,n)}function r0(e){var n=_e(e)?Sg:Jg;return n(e)}function n0(e){if(e==null)return 0;if(ur(e))return _o(e)?ui(e):e.length;var n=Gt(e);return n==we||n==je?e.size:za(e).length}function i0(e,n,a){var u=_e(e)?Ia:Qg;return a&&tr(e,n,a)&&(n=r),u(e,le(n,3))}var s0=Se(function(e,n){if(e==null)return[];var a=n.length;return a>1&&tr(e,n[0],n[1])?n=[]:a>2&&tr(n[0],n[1],n[2])&&(n=[n[0]]),fl(e,Bt(n,1),[])}),go=qp||function(){return Te.Date.now()};function o0(e,n){if(typeof n!="function")throw new Sr(f);return e=be(e),function(){if(--e<1)return n.apply(this,arguments)}}function oh(e,n,a){return n=a?r:n,n=e&&n==null?e.length:n,sn(e,N,r,r,r,r,n)}function ah(e,n){var a;if(typeof n!="function")throw new Sr(f);return e=be(e),function(){return--e>0&&(a=n.apply(this,arguments)),e<=1&&(n=r),a}}var hc=Se(function(e,n,a){var u=te;if(a.length){var d=En(a,mi(hc));u|=m}return sn(e,u,n,a,d)}),ch=Se(function(e,n,a){var u=te|ue;if(a.length){var d=En(a,mi(ch));u|=m}return sn(n,u,e,a,d)});function uh(e,n,a){n=a?r:n;var u=sn(e,p,r,r,r,r,r,n);return u.placeholder=uh.placeholder,u}function lh(e,n,a){n=a?r:n;var u=sn(e,_,r,r,r,r,r,n);return u.placeholder=lh.placeholder,u}function hh(e,n,a){var u,d,E,P,R,j,V=0,k=!1,J=!1,ee=!0;if(typeof e!="function")throw new Sr(f);n=Nr(n)||0,lt(a)&&(k=!!a.leading,J="maxWait"in a,E=J?jt(Nr(a.maxWait)||0,n):E,ee="trailing"in a?!!a.trailing:ee);function ce(It){var Mr=u,ln=d;return u=d=r,V=It,P=e.apply(ln,Mr),P}function he(It){return V=It,R=ki(Oe,n),k?ce(It):P}function Ee(It){var Mr=It-j,ln=It-V,Rh=n-Mr;return J?Kt(Rh,E-ln):Rh}function fe(It){var Mr=It-j,ln=It-V;return j===r||Mr>=n||Mr<0||J&&ln>=E}function Oe(){var It=go();if(fe(It))return Ne(It);R=ki(Oe,Ee(It))}function Ne(It){return R=r,ee&&u?ce(It):(u=d=r,P)}function vr(){R!==r&&wl(R),V=0,u=j=d=R=r}function rr(){return R===r?P:Ne(go())}function _r(){var It=go(),Mr=fe(It);if(u=arguments,d=this,j=It,Mr){if(R===r)return he(j);if(J)return wl(R),R=ki(Oe,n),ce(j)}return R===r&&(R=ki(Oe,n)),P}return _r.cancel=vr,_r.flush=rr,_r}var a0=Se(function(e,n){return el(e,1,n)}),c0=Se(function(e,n,a){return el(e,Nr(n)||0,a)});function u0(e){return sn(e,Q)}function yo(e,n){if(typeof e!="function"||n!=null&&typeof n!="function")throw new Sr(f);var a=function(){var u=arguments,d=n?n.apply(this,u):u[0],E=a.cache;if(E.has(d))return E.get(d);var P=e.apply(this,u);return a.cache=E.set(d,P)||E,P};return a.cache=new(yo.Cache||rn),a}yo.Cache=rn;function mo(e){if(typeof e!="function")throw new Sr(f);return function(){var n=arguments;switch(n.length){case 0:return!e.call(this);case 1:return!e.call(this,n[0]);case 2:return!e.call(this,n[0],n[1]);case 3:return!e.call(this,n[0],n[1],n[2])}return!e.apply(this,n)}}function l0(e){return ah(2,e)}var h0=Yg(function(e,n){n=n.length==1&&_e(n[0])?st(n[0],gr(le())):st(Bt(n,1),gr(le()));var a=n.length;return Se(function(u){for(var d=-1,E=Kt(u.length,a);++d<E;)u[d]=n[d].call(this,u[d]);return Mt(e,this,u)})}),fc=Se(function(e,n){var a=En(n,mi(fc));return sn(e,m,r,n,a)}),fh=Se(function(e,n){var a=En(n,mi(fh));return sn(e,y,r,n,a)}),f0=on(function(e,n){return sn(e,x,r,r,r,n)});function d0(e,n){if(typeof e!="function")throw new Sr(f);return n=n===r?n:be(n),Se(e,n)}function p0(e,n){if(typeof e!="function")throw new Sr(f);return n=n==null?0:jt(be(n),0),Se(function(a){var u=a[n],d=Pn(a,0,n);return u&&wn(d,u),Mt(e,this,d)})}function g0(e,n,a){var u=!0,d=!0;if(typeof e!="function")throw new Sr(f);return lt(a)&&(u="leading"in a?!!a.leading:u,d="trailing"in a?!!a.trailing:d),hh(e,n,{leading:u,maxWait:n,trailing:d})}function y0(e){return oh(e,1)}function m0(e,n){return fc(Qa(n),e)}function v0(){if(!arguments.length)return[];var e=arguments[0];return _e(e)?e:[e]}function _0(e){return xr(e,q)}function b0(e,n){return n=typeof n=="function"?n:r,xr(e,q,n)}function w0(e){return xr(e,T|q)}function E0(e,n){return n=typeof n=="function"?n:r,xr(e,T|q,n)}function I0(e,n){return n==null||Zu(e,n,qt(n))}function Lr(e,n){return e===n||e!==e&&n!==n}var S0=co(Ma),O0=co(function(e,n){return e>=n}),kn=sl(function(){return arguments}())?sl:function(e){return vt(e)&&qe.call(e,"callee")&&!ku.call(e,"callee")},_e=F.isArray,x0=Zt?gr(Zt):Dg;function ur(e){return e!=null&&vo(e.length)&&!cn(e)}function Et(e){return vt(e)&&ur(e)}function P0(e){return e===!0||e===!1||vt(e)&&er(e)==z}var Tn=zp||Ic,T0=Dr?gr(Dr):Ug;function N0(e){return vt(e)&&e.nodeType===1&&!Ki(e)}function R0(e){if(e==null)return!0;if(ur(e)&&(_e(e)||typeof e=="string"||typeof e.splice=="function"||Tn(e)||vi(e)||kn(e)))return!e.length;var n=Gt(e);if(n==we||n==je)return!e.size;if(Vi(e))return!za(e).length;for(var a in e)if(qe.call(e,a))return!1;return!0}function A0(e,n){return zi(e,n)}function C0(e,n,a){a=typeof a=="function"?a:r;var u=a?a(e,n):r;return u===r?zi(e,n,r,a):!!u}function dc(e){if(!vt(e))return!1;var n=er(e);return n==C||n==h||typeof e.message=="string"&&typeof e.name=="string"&&!Ki(e)}function $0(e){return typeof e=="number"&&Gu(e)}function cn(e){if(!lt(e))return!1;var n=er(e);return n==ae||n==ye||n==H||n==_t}function dh(e){return typeof e=="number"&&e==be(e)}function vo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=X}function lt(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}function vt(e){return e!=null&&typeof e=="object"}var ph=Er?gr(Er):Lg;function D0(e,n){return e===n||Fa(e,n,nc(n))}function U0(e,n,a){return a=typeof a=="function"?a:r,Fa(e,n,nc(n),a)}function j0(e){return gh(e)&&e!=+e}function L0(e){if(by(e))throw new me(c);return ol(e)}function M0(e){return e===null}function q0(e){return e==null}function gh(e){return typeof e=="number"||vt(e)&&er(e)==Ce}function Ki(e){if(!vt(e)||er(e)!=xe)return!1;var n=Vs(e);if(n===null)return!0;var a=qe.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&Fs.call(a)==Up}var pc=Gr?gr(Gr):Mg;function F0(e){return dh(e)&&e>=-X&&e<=X}var yh=Ai?gr(Ai):qg;function _o(e){return typeof e=="string"||!_e(e)&&vt(e)&&er(e)==Xe}function mr(e){return typeof e=="symbol"||vt(e)&&er(e)==Ze}var vi=Ln?gr(Ln):Fg;function z0(e){return e===r}function H0(e){return vt(e)&&Gt(e)==ze}function B0(e){return vt(e)&&er(e)==et}var V0=co(Ha),k0=co(function(e,n){return e<=n});function mh(e){if(!e)return[];if(ur(e))return _o(e)?Ur(e):cr(e);if($i&&e[$i])return Ip(e[$i]());var n=Gt(e),a=n==we?Na:n==je?Ls:_i;return a(e)}function un(e){if(!e)return e===0?e:0;if(e=Nr(e),e===de||e===-de){var n=e<0?-1:1;return n*W}return e===e?e:0}function be(e){var n=un(e),a=n%1;return n===n?a?n-a:n:0}function vh(e){return e?zn(be(e),0,Z):0}function Nr(e){if(typeof e=="number")return e;if(mr(e))return Y;if(lt(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=lt(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=Lu(e);var a=ia.test(e);return a||oa.test(e)?ve(e.slice(2),a?2:8):na.test(e)?Y:+e}function _h(e){return Jr(e,lr(e))}function K0(e){return e?zn(be(e),-X,X):e===0?e:0}function Le(e){return e==null?"":yr(e)}var G0=gi(function(e,n){if(Vi(n)||ur(n)){Jr(n,qt(n),e);return}for(var a in n)qe.call(n,a)&&Mi(e,a,n[a])}),bh=gi(function(e,n){Jr(n,lr(n),e)}),bo=gi(function(e,n,a,u){Jr(n,lr(n),e,u)}),W0=gi(function(e,n,a,u){Jr(n,qt(n),e,u)}),J0=on(Ua);function Q0(e,n){var a=pi(e);return n==null?a:Xu(a,n)}var Y0=Se(function(e,n){e=Je(e);var a=-1,u=n.length,d=u>2?n[2]:r;for(d&&tr(n[0],n[1],d)&&(u=1);++a<u;)for(var E=n[a],P=lr(E),R=-1,j=P.length;++R<j;){var V=P[R],k=e[V];(k===r||Lr(k,hi[V])&&!qe.call(e,V))&&(e[V]=E[V])}return e}),X0=Se(function(e){return e.push(r,Ll),Mt(wh,r,e)});function Z0(e,n){return $u(e,le(n,3),Wr)}function ev(e,n){return $u(e,le(n,3),La)}function tv(e,n){return e==null?e:ja(e,le(n,3),lr)}function rv(e,n){return e==null?e:nl(e,le(n,3),lr)}function nv(e,n){return e&&Wr(e,le(n,3))}function iv(e,n){return e&&La(e,le(n,3))}function sv(e){return e==null?[]:eo(e,qt(e))}function ov(e){return e==null?[]:eo(e,lr(e))}function gc(e,n,a){var u=e==null?r:Hn(e,n);return u===r?a:u}function av(e,n){return e!=null&&Fl(e,n,Rg)}function yc(e,n){return e!=null&&Fl(e,n,Ag)}var cv=Cl(function(e,n,a){n!=null&&typeof n.toString!="function"&&(n=zs.call(n)),e[n]=a},vc(hr)),uv=Cl(function(e,n,a){n!=null&&typeof n.toString!="function"&&(n=zs.call(n)),qe.call(e,n)?e[n].push(a):e[n]=[a]},le),lv=Se(Fi);function qt(e){return ur(e)?Qu(e):za(e)}function lr(e){return ur(e)?Qu(e,!0):zg(e)}function hv(e,n){var a={};return n=le(n,3),Wr(e,function(u,d,E){nn(a,n(u,d,E),u)}),a}function fv(e,n){var a={};return n=le(n,3),Wr(e,function(u,d,E){nn(a,d,n(u,d,E))}),a}var dv=gi(function(e,n,a){to(e,n,a)}),wh=gi(function(e,n,a,u){to(e,n,a,u)}),pv=on(function(e,n){var a={};if(e==null)return a;var u=!1;n=st(n,function(E){return E=xn(E,e),u||(u=E.length>1),E}),Jr(e,tc(e),a),u&&(a=xr(a,T|A|q,cy));for(var d=n.length;d--;)Ga(a,n[d]);return a});function gv(e,n){return Eh(e,mo(le(n)))}var yv=on(function(e,n){return e==null?{}:Bg(e,n)});function Eh(e,n){if(e==null)return{};var a=st(tc(e),function(u){return[u]});return n=le(n),dl(e,a,function(u,d){return n(u,d[0])})}function mv(e,n,a){n=xn(n,e);var u=-1,d=n.length;for(d||(d=1,e=r);++u<d;){var E=e==null?r:e[Qr(n[u])];E===r&&(u=d,E=a),e=cn(E)?E.call(e):E}return e}function vv(e,n,a){return e==null?e:Hi(e,n,a)}function _v(e,n,a,u){return u=typeof u=="function"?u:r,e==null?e:Hi(e,n,a,u)}var Ih=Ul(qt),Sh=Ul(lr);function bv(e,n,a){var u=_e(e),d=u||Tn(e)||vi(e);if(n=le(n,4),a==null){var E=e&&e.constructor;d?a=u?new E:[]:lt(e)?a=cn(E)?pi(Vs(e)):{}:a={}}return(d?Ir:Wr)(e,function(P,R,j){return n(a,P,R,j)}),a}function wv(e,n){return e==null?!0:Ga(e,n)}function Ev(e,n,a){return e==null?e:vl(e,n,Qa(a))}function Iv(e,n,a,u){return u=typeof u=="function"?u:r,e==null?e:vl(e,n,Qa(a),u)}function _i(e){return e==null?[]:Ta(e,qt(e))}function Sv(e){return e==null?[]:Ta(e,lr(e))}function Ov(e,n,a){return a===r&&(a=n,n=r),a!==r&&(a=Nr(a),a=a===a?a:0),n!==r&&(n=Nr(n),n=n===n?n:0),zn(Nr(e),n,a)}function xv(e,n,a){return n=un(n),a===r?(a=n,n=0):a=un(a),e=Nr(e),Cg(e,n,a)}function Pv(e,n,a){if(a&&typeof a!="boolean"&&tr(e,n,a)&&(n=a=r),a===r&&(typeof n=="boolean"?(a=n,n=r):typeof e=="boolean"&&(a=e,e=r)),e===r&&n===r?(e=0,n=1):(e=un(e),n===r?(n=e,e=0):n=un(n)),e>n){var u=e;e=n,n=u}if(a||e%1||n%1){var d=Wu();return Kt(e+d*(n-e+Ge("1e-"+((d+"").length-1))),n)}return Va(e,n)}var Tv=yi(function(e,n,a){return n=n.toLowerCase(),e+(a?Oh(n):n)});function Oh(e){return mc(Le(e).toLowerCase())}function xh(e){return e=Le(e),e&&e.replace(Zr,vp).replace(_a,"")}function Nv(e,n,a){e=Le(e),n=yr(n);var u=e.length;a=a===r?u:zn(be(a),0,u);var d=a;return a-=n.length,a>=0&&e.slice(a,d)==n}function Rv(e){return e=Le(e),e&&nt.test(e)?e.replace(Cn,_p):e}function Av(e){return e=Le(e),e&&Nt.test(e)?e.replace(gt,"\\$&"):e}var Cv=yi(function(e,n,a){return e+(a?"-":"")+n.toLowerCase()}),$v=yi(function(e,n,a){return e+(a?" ":"")+n.toLowerCase()}),Dv=Nl("toLowerCase");function Uv(e,n,a){e=Le(e),n=be(n);var u=n?ui(e):0;if(!n||u>=n)return e;var d=(n-u)/2;return ao(Ws(d),a)+e+ao(Gs(d),a)}function jv(e,n,a){e=Le(e),n=be(n);var u=n?ui(e):0;return n&&u<n?e+ao(n-u,a):e}function Lv(e,n,a){e=Le(e),n=be(n);var u=n?ui(e):0;return n&&u<n?ao(n-u,a)+e:e}function Mv(e,n,a){return a||n==null?n=0:n&&(n=+n),kp(Le(e).replace(yt,""),n||0)}function qv(e,n,a){return(a?tr(e,n,a):n===r)?n=1:n=be(n),ka(Le(e),n)}function Fv(){var e=arguments,n=Le(e[0]);return e.length<3?n:n.replace(e[1],e[2])}var zv=yi(function(e,n,a){return e+(a?"_":"")+n.toLowerCase()});function Hv(e,n,a){return a&&typeof a!="number"&&tr(e,n,a)&&(n=a=r),a=a===r?Z:a>>>0,a?(e=Le(e),e&&(typeof n=="string"||n!=null&&!pc(n))&&(n=yr(n),!n&&ci(e))?Pn(Ur(e),0,a):e.split(n,a)):[]}var Bv=yi(function(e,n,a){return e+(a?" ":"")+mc(n)});function Vv(e,n,a){return e=Le(e),a=a==null?0:zn(be(a),0,e.length),n=yr(n),e.slice(a,a+n.length)==n}function kv(e,n,a){var u=b.templateSettings;a&&tr(e,n,a)&&(n=r),e=Le(e),n=bo({},n,u,jl);var d=bo({},n.imports,u.imports,jl),E=qt(d),P=Ta(d,E),R,j,V=0,k=n.interpolate||ei,J="__p += '",ee=Ra((n.escape||ei).source+"|"+k.source+"|"+(k===ut?ra:ei).source+"|"+(n.evaluate||ei).source+"|$","g"),ce="//# sourceURL="+(qe.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ba+"]")+`
`;e.replace(ee,function(fe,Oe,Ne,vr,rr,_r){return Ne||(Ne=vr),J+=e.slice(V,_r).replace(ca,bp),Oe&&(R=!0,J+=`' +
__e(`+Oe+`) +
'`),rr&&(j=!0,J+=`';
`+rr+`;
__p += '`),Ne&&(J+=`' +
((__t = (`+Ne+`)) == null ? '' : __t) +
'`),V=_r+fe.length,fe}),J+=`';
`;var he=qe.call(n,"variable")&&n.variable;if(!he)J=`with (obj) {
`+J+`
}
`;else if(ea.test(he))throw new me(v);J=(j?J.replace(kr,""):J).replace(Xt,"$1").replace(Xr,"$1;"),J="function("+(he||"obj")+`) {
`+(he?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(R?", __e = _.escape":"")+(j?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+J+`return __p
}`;var Ee=Th(function(){return Ue(E,ce+"return "+J).apply(r,P)});if(Ee.source=J,dc(Ee))throw Ee;return Ee}function Kv(e){return Le(e).toLowerCase()}function Gv(e){return Le(e).toUpperCase()}function Wv(e,n,a){if(e=Le(e),e&&(a||n===r))return Lu(e);if(!e||!(n=yr(n)))return e;var u=Ur(e),d=Ur(n),E=Mu(u,d),P=qu(u,d)+1;return Pn(u,E,P).join("")}function Jv(e,n,a){if(e=Le(e),e&&(a||n===r))return e.slice(0,zu(e)+1);if(!e||!(n=yr(n)))return e;var u=Ur(e),d=qu(u,Ur(n))+1;return Pn(u,0,d).join("")}function Qv(e,n,a){if(e=Le(e),e&&(a||n===r))return e.replace(yt,"");if(!e||!(n=yr(n)))return e;var u=Ur(e),d=Mu(u,Ur(n));return Pn(u,d).join("")}function Yv(e,n){var a=se,u=pe;if(lt(n)){var d="separator"in n?n.separator:d;a="length"in n?be(n.length):a,u="omission"in n?yr(n.omission):u}e=Le(e);var E=e.length;if(ci(e)){var P=Ur(e);E=P.length}if(a>=E)return e;var R=a-ui(u);if(R<1)return u;var j=P?Pn(P,0,R).join(""):e.slice(0,R);if(d===r)return j+u;if(P&&(R+=j.length-R),pc(d)){if(e.slice(R).search(d)){var V,k=j;for(d.global||(d=Ra(d.source,Le(wr.exec(d))+"g")),d.lastIndex=0;V=d.exec(k);)var J=V.index;j=j.slice(0,J===r?R:J)}}else if(e.indexOf(yr(d),R)!=R){var ee=j.lastIndexOf(d);ee>-1&&(j=j.slice(0,ee))}return j+u}function Xv(e){return e=Le(e),e&&ft.test(e)?e.replace(vn,Pp):e}var Zv=yi(function(e,n,a){return e+(a?" ":"")+n.toUpperCase()}),mc=Nl("toUpperCase");function Ph(e,n,a){return e=Le(e),n=a?r:n,n===r?Ep(e)?Rp(e):dp(e):e.match(n)||[]}var Th=Se(function(e,n){try{return Mt(e,r,n)}catch(a){return dc(a)?a:new me(a)}}),e_=on(function(e,n){return Ir(n,function(a){a=Qr(a),nn(e,a,hc(e[a],e))}),e});function t_(e){var n=e==null?0:e.length,a=le();return e=n?st(e,function(u){if(typeof u[1]!="function")throw new Sr(f);return[a(u[0]),u[1]]}):[],Se(function(u){for(var d=-1;++d<n;){var E=e[d];if(Mt(E[0],this,u))return Mt(E[1],this,u)}})}function r_(e){return Pg(xr(e,T))}function vc(e){return function(){return e}}function n_(e,n){return e==null||e!==e?n:e}var i_=Al(),s_=Al(!0);function hr(e){return e}function _c(e){return al(typeof e=="function"?e:xr(e,T))}function o_(e){return ul(xr(e,T))}function a_(e,n){return ll(e,xr(n,T))}var c_=Se(function(e,n){return function(a){return Fi(a,e,n)}}),u_=Se(function(e,n){return function(a){return Fi(e,a,n)}});function bc(e,n,a){var u=qt(n),d=eo(n,u);a==null&&!(lt(n)&&(d.length||!u.length))&&(a=n,n=e,e=this,d=eo(n,qt(n)));var E=!(lt(a)&&"chain"in a)||!!a.chain,P=cn(e);return Ir(d,function(R){var j=n[R];e[R]=j,P&&(e.prototype[R]=function(){var V=this.__chain__;if(E||V){var k=e(this.__wrapped__),J=k.__actions__=cr(this.__actions__);return J.push({func:j,args:arguments,thisArg:e}),k.__chain__=V,k}return j.apply(e,wn([this.value()],arguments))})}),e}function l_(){return Te._===this&&(Te._=jp),this}function wc(){}function h_(e){return e=be(e),Se(function(n){return hl(n,e)})}var f_=Xa(st),d_=Xa(Cu),p_=Xa(Ia);function Nh(e){return sc(e)?Sa(Qr(e)):Vg(e)}function g_(e){return function(n){return e==null?r:Hn(e,n)}}var y_=$l(),m_=$l(!0);function Ec(){return[]}function Ic(){return!1}function v_(){return{}}function __(){return""}function b_(){return!0}function w_(e,n){if(e=be(e),e<1||e>X)return[];var a=Z,u=Kt(e,Z);n=le(n),e-=Z;for(var d=Pa(u,n);++a<e;)n(a);return d}function E_(e){return _e(e)?st(e,Qr):mr(e)?[e]:cr(Jl(Le(e)))}function I_(e){var n=++Dp;return Le(e)+n}var S_=oo(function(e,n){return e+n},0),O_=Za("ceil"),x_=oo(function(e,n){return e/n},1),P_=Za("floor");function T_(e){return e&&e.length?Zs(e,hr,Ma):r}function N_(e,n){return e&&e.length?Zs(e,le(n,2),Ma):r}function R_(e){return Uu(e,hr)}function A_(e,n){return Uu(e,le(n,2))}function C_(e){return e&&e.length?Zs(e,hr,Ha):r}function $_(e,n){return e&&e.length?Zs(e,le(n,2),Ha):r}var D_=oo(function(e,n){return e*n},1),U_=Za("round"),j_=oo(function(e,n){return e-n},0);function L_(e){return e&&e.length?xa(e,hr):0}function M_(e,n){return e&&e.length?xa(e,le(n,2)):0}return b.after=o0,b.ary=oh,b.assign=G0,b.assignIn=bh,b.assignInWith=bo,b.assignWith=W0,b.at=J0,b.before=ah,b.bind=hc,b.bindAll=e_,b.bindKey=ch,b.castArray=v0,b.chain=nh,b.chunk=Py,b.compact=Ty,b.concat=Ny,b.cond=t_,b.conforms=r_,b.constant=vc,b.countBy=Lm,b.create=Q0,b.curry=uh,b.curryRight=lh,b.debounce=hh,b.defaults=Y0,b.defaultsDeep=X0,b.defer=a0,b.delay=c0,b.difference=Ry,b.differenceBy=Ay,b.differenceWith=Cy,b.drop=$y,b.dropRight=Dy,b.dropRightWhile=Uy,b.dropWhile=jy,b.fill=Ly,b.filter=qm,b.flatMap=Hm,b.flatMapDeep=Bm,b.flatMapDepth=Vm,b.flatten=Zl,b.flattenDeep=My,b.flattenDepth=qy,b.flip=u0,b.flow=i_,b.flowRight=s_,b.fromPairs=Fy,b.functions=sv,b.functionsIn=ov,b.groupBy=km,b.initial=Hy,b.intersection=By,b.intersectionBy=Vy,b.intersectionWith=ky,b.invert=cv,b.invertBy=uv,b.invokeMap=Gm,b.iteratee=_c,b.keyBy=Wm,b.keys=qt,b.keysIn=lr,b.map=po,b.mapKeys=hv,b.mapValues=fv,b.matches=o_,b.matchesProperty=a_,b.memoize=yo,b.merge=dv,b.mergeWith=wh,b.method=c_,b.methodOf=u_,b.mixin=bc,b.negate=mo,b.nthArg=h_,b.omit=pv,b.omitBy=gv,b.once=l0,b.orderBy=Jm,b.over=f_,b.overArgs=h0,b.overEvery=d_,b.overSome=p_,b.partial=fc,b.partialRight=fh,b.partition=Qm,b.pick=yv,b.pickBy=Eh,b.property=Nh,b.propertyOf=g_,b.pull=Jy,b.pullAll=th,b.pullAllBy=Qy,b.pullAllWith=Yy,b.pullAt=Xy,b.range=y_,b.rangeRight=m_,b.rearg=f0,b.reject=Zm,b.remove=Zy,b.rest=d0,b.reverse=uc,b.sampleSize=t0,b.set=vv,b.setWith=_v,b.shuffle=r0,b.slice=em,b.sortBy=s0,b.sortedUniq=am,b.sortedUniqBy=cm,b.split=Hv,b.spread=p0,b.tail=um,b.take=lm,b.takeRight=hm,b.takeRightWhile=fm,b.takeWhile=dm,b.tap=Tm,b.throttle=g0,b.thru=fo,b.toArray=mh,b.toPairs=Ih,b.toPairsIn=Sh,b.toPath=E_,b.toPlainObject=_h,b.transform=bv,b.unary=y0,b.union=pm,b.unionBy=gm,b.unionWith=ym,b.uniq=mm,b.uniqBy=vm,b.uniqWith=_m,b.unset=wv,b.unzip=lc,b.unzipWith=rh,b.update=Ev,b.updateWith=Iv,b.values=_i,b.valuesIn=Sv,b.without=bm,b.words=Ph,b.wrap=m0,b.xor=wm,b.xorBy=Em,b.xorWith=Im,b.zip=Sm,b.zipObject=Om,b.zipObjectDeep=xm,b.zipWith=Pm,b.entries=Ih,b.entriesIn=Sh,b.extend=bh,b.extendWith=bo,bc(b,b),b.add=S_,b.attempt=Th,b.camelCase=Tv,b.capitalize=Oh,b.ceil=O_,b.clamp=Ov,b.clone=_0,b.cloneDeep=w0,b.cloneDeepWith=E0,b.cloneWith=b0,b.conformsTo=I0,b.deburr=xh,b.defaultTo=n_,b.divide=x_,b.endsWith=Nv,b.eq=Lr,b.escape=Rv,b.escapeRegExp=Av,b.every=Mm,b.find=Fm,b.findIndex=Yl,b.findKey=Z0,b.findLast=zm,b.findLastIndex=Xl,b.findLastKey=ev,b.floor=P_,b.forEach=ih,b.forEachRight=sh,b.forIn=tv,b.forInRight=rv,b.forOwn=nv,b.forOwnRight=iv,b.get=gc,b.gt=S0,b.gte=O0,b.has=av,b.hasIn=yc,b.head=eh,b.identity=hr,b.includes=Km,b.indexOf=zy,b.inRange=xv,b.invoke=lv,b.isArguments=kn,b.isArray=_e,b.isArrayBuffer=x0,b.isArrayLike=ur,b.isArrayLikeObject=Et,b.isBoolean=P0,b.isBuffer=Tn,b.isDate=T0,b.isElement=N0,b.isEmpty=R0,b.isEqual=A0,b.isEqualWith=C0,b.isError=dc,b.isFinite=$0,b.isFunction=cn,b.isInteger=dh,b.isLength=vo,b.isMap=ph,b.isMatch=D0,b.isMatchWith=U0,b.isNaN=j0,b.isNative=L0,b.isNil=q0,b.isNull=M0,b.isNumber=gh,b.isObject=lt,b.isObjectLike=vt,b.isPlainObject=Ki,b.isRegExp=pc,b.isSafeInteger=F0,b.isSet=yh,b.isString=_o,b.isSymbol=mr,b.isTypedArray=vi,b.isUndefined=z0,b.isWeakMap=H0,b.isWeakSet=B0,b.join=Ky,b.kebabCase=Cv,b.last=Tr,b.lastIndexOf=Gy,b.lowerCase=$v,b.lowerFirst=Dv,b.lt=V0,b.lte=k0,b.max=T_,b.maxBy=N_,b.mean=R_,b.meanBy=A_,b.min=C_,b.minBy=$_,b.stubArray=Ec,b.stubFalse=Ic,b.stubObject=v_,b.stubString=__,b.stubTrue=b_,b.multiply=D_,b.nth=Wy,b.noConflict=l_,b.noop=wc,b.now=go,b.pad=Uv,b.padEnd=jv,b.padStart=Lv,b.parseInt=Mv,b.random=Pv,b.reduce=Ym,b.reduceRight=Xm,b.repeat=qv,b.replace=Fv,b.result=mv,b.round=U_,b.runInContext=U,b.sample=e0,b.size=n0,b.snakeCase=zv,b.some=i0,b.sortedIndex=tm,b.sortedIndexBy=rm,b.sortedIndexOf=nm,b.sortedLastIndex=im,b.sortedLastIndexBy=sm,b.sortedLastIndexOf=om,b.startCase=Bv,b.startsWith=Vv,b.subtract=j_,b.sum=L_,b.sumBy=M_,b.template=kv,b.times=w_,b.toFinite=un,b.toInteger=be,b.toLength=vh,b.toLower=Kv,b.toNumber=Nr,b.toSafeInteger=K0,b.toString=Le,b.toUpper=Gv,b.trim=Wv,b.trimEnd=Jv,b.trimStart=Qv,b.truncate=Yv,b.unescape=Xv,b.uniqueId=I_,b.upperCase=Zv,b.upperFirst=mc,b.each=ih,b.eachRight=sh,b.first=eh,bc(b,function(){var e={};return Wr(b,function(n,a){qe.call(b.prototype,a)||(e[a]=n)}),e}(),{chain:!1}),b.VERSION=s,Ir(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){b[e].placeholder=b}),Ir(["drop","take"],function(e,n){Pe.prototype[e]=function(a){a=a===r?1:jt(be(a),0);var u=this.__filtered__&&!n?new Pe(this):this.clone();return u.__filtered__?u.__takeCount__=Kt(a,u.__takeCount__):u.__views__.push({size:Kt(a,Z),type:e+(u.__dir__<0?"Right":"")}),u},Pe.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),Ir(["filter","map","takeWhile"],function(e,n){var a=n+1,u=a==S||a==ne;Pe.prototype[e]=function(d){var E=this.clone();return E.__iteratees__.push({iteratee:le(d,3),type:a}),E.__filtered__=E.__filtered__||u,E}}),Ir(["head","last"],function(e,n){var a="take"+(n?"Right":"");Pe.prototype[e]=function(){return this[a](1).value()[0]}}),Ir(["initial","tail"],function(e,n){var a="drop"+(n?"":"Right");Pe.prototype[e]=function(){return this.__filtered__?new Pe(this):this[a](1)}}),Pe.prototype.compact=function(){return this.filter(hr)},Pe.prototype.find=function(e){return this.filter(e).head()},Pe.prototype.findLast=function(e){return this.reverse().find(e)},Pe.prototype.invokeMap=Se(function(e,n){return typeof e=="function"?new Pe(this):this.map(function(a){return Fi(a,e,n)})}),Pe.prototype.reject=function(e){return this.filter(mo(le(e)))},Pe.prototype.slice=function(e,n){e=be(e);var a=this;return a.__filtered__&&(e>0||n<0)?new Pe(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),n!==r&&(n=be(n),a=n<0?a.dropRight(-n):a.take(n-e)),a)},Pe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Pe.prototype.toArray=function(){return this.take(Z)},Wr(Pe.prototype,function(e,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),u=/^(?:head|last)$/.test(n),d=b[u?"take"+(n=="last"?"Right":""):n],E=u||/^find/.test(n);d&&(b.prototype[n]=function(){var P=this.__wrapped__,R=u?[1]:arguments,j=P instanceof Pe,V=R[0],k=j||_e(P),J=function(Oe){var Ne=d.apply(b,wn([Oe],R));return u&&ee?Ne[0]:Ne};k&&a&&typeof V=="function"&&V.length!=1&&(j=k=!1);var ee=this.__chain__,ce=!!this.__actions__.length,he=E&&!ee,Ee=j&&!ce;if(!E&&k){P=Ee?P:new Pe(this);var fe=e.apply(P,R);return fe.__actions__.push({func:fo,args:[J],thisArg:r}),new Or(fe,ee)}return he&&Ee?e.apply(this,R):(fe=this.thru(J),he?u?fe.value()[0]:fe.value():fe)})}),Ir(["pop","push","shift","sort","splice","unshift"],function(e){var n=Ms[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);b.prototype[e]=function(){var d=arguments;if(u&&!this.__chain__){var E=this.value();return n.apply(_e(E)?E:[],d)}return this[a](function(P){return n.apply(_e(P)?P:[],d)})}}),Wr(Pe.prototype,function(e,n){var a=b[n];if(a){var u=a.name+"";qe.call(di,u)||(di[u]=[]),di[u].push({name:n,func:a})}}),di[so(r,ue).name]=[{name:"wrapper",func:r}],Pe.prototype.clone=Xp,Pe.prototype.reverse=Zp,Pe.prototype.value=eg,b.prototype.at=Nm,b.prototype.chain=Rm,b.prototype.commit=Am,b.prototype.next=Cm,b.prototype.plant=Dm,b.prototype.reverse=Um,b.prototype.toJSON=b.prototype.valueOf=b.prototype.value=jm,b.prototype.first=b.prototype.head,$i&&(b.prototype[$i]=$m),b},li=Ap();wt?((wt.exports=li)._=li,We._=li):Te._=li}).call(es)})(fu,fu.exports);var Ux=Object.defineProperty,jx=Object.defineProperties,Lx=Object.getOwnPropertyDescriptors,Wf=Object.getOwnPropertySymbols,Mx=Object.prototype.hasOwnProperty,qx=Object.prototype.propertyIsEnumerable,Jf=(i,t,r)=>t in i?Ux(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,Oo=(i,t)=>{for(var r in t||(t={}))Mx.call(t,r)&&Jf(i,r,t[r]);if(Wf)for(var r of Wf(t))qx.call(t,r)&&Jf(i,r,t[r]);return i},Fx=(i,t)=>jx(i,Lx(t));function Rn(i,t,r){var s;const o=Ox(i);return((s=t.rpcMap)==null?void 0:s[o.reference])||`${Dx}?chainId=${o.namespace}:${o.reference}&projectId=${r}`}function Zn(i){return i.includes(":")?i.split(":")[1]:i}function op(i){return i.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function zx(i,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(i));if(!r.length)return[];const s=[];return r.forEach(o=>{const c=t.namespaces[o].accounts;s.push(...c)}),s}function Hx(i={},t={}){const r=Qf(i),s=Qf(t);return fu.exports.merge(r,s)}function Qf(i){var t,r,s,o;const c={};if(!Px(i))return c;for(const[f,v]of Object.entries(i)){const O=Nu(f)?[f]:v.chains,g=v.methods||[],w=v.events||[],T=v.rpcMap||{},A=ns(f);c[A]=Fx(Oo(Oo({},c[A]),v),{chains:Fc(O,(t=c[A])==null?void 0:t.chains),methods:Fc(g,(r=c[A])==null?void 0:r.methods),events:Fc(w,(s=c[A])==null?void 0:s.events),rpcMap:Oo(Oo({},T),(o=c[A])==null?void 0:o.rpcMap)})}return c}function Bx(i){return i.includes(":")?i.split(":")[2]:i}function Vx(i){const t={};for(const[r,s]of Object.entries(i)){const o=s.methods||[],c=s.events||[],f=s.accounts||[],v=Nu(r)?[r]:s.chains?s.chains:op(s.accounts);t[r]={chains:v,methods:o,events:c,accounts:f}}return t}function zc(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):i.includes(":")?Number(i.split(":")[1]):Number(i)}const ap={},ot=i=>ap[i],Hc=(i,t)=>{ap[i]=t};class kx{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=Zn(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Rn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yn(new An(s,ot("disableProviderPing")))}}class Kx{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Rn(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yn(new An(s,ot("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=parseInt(Zn(r));t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let o=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class Gx{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=Zn(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Rn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yn(new An(s,ot("disableProviderPing")))}}class Wx{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=Zn(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Rn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yn(new An(s,ot("disableProviderPing")))}}class Jx{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),o=Zn(r);t[o]=this.createHttpProvider(o,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yn(new An(s,ot("disableProviderPing")))}}class Qx{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=Zn(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Rn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yn(new An(s,ot("disableProviderPing")))}}class Yx{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=Zn(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Rn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yn(new An(s,ot("disableProviderPing")))}}class Xx{constructor(t){this.name="near",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Rn(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Rn(t,this.namespace);return typeof s>"u"?void 0:new yn(new An(s,ot("disableProviderPing")))}}var Zx=Object.defineProperty,eP=Object.defineProperties,tP=Object.getOwnPropertyDescriptors,Yf=Object.getOwnPropertySymbols,rP=Object.prototype.hasOwnProperty,nP=Object.prototype.propertyIsEnumerable,Xf=(i,t,r)=>t in i?Zx(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,xo=(i,t)=>{for(var r in t||(t={}))rP.call(t,r)&&Xf(i,r,t[r]);if(Yf)for(var r of Yf(t))nP.call(t,r)&&Xf(i,r,t[r]);return i},Bc=(i,t)=>eP(i,tP(t));class Ru{constructor(t){this.events=new gu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:t?.logger||Kf})),this.disableProviderPing=t?.disableProviderPing||!1}static async init(t){const r=new Ru(t);return await r.initialize(),r}async request(t,r){const[s,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:xo({},t),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(o=>r(null,o)).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:zf("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=Vx(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==ip)throw c;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Hf(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Ex.init({logger:this.providerOpts.logger||Kf,relayUrl:this.providerOpts.relayUrl||Ax,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>ns(r)))];Hc("client",this.client),Hc("events",this.events),Hc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=zx(r,this.session),o=op(s),c=Hx(this.namespaces,this.optionalNamespaces),f=Bc(xo({},c[r]),{accounts:s,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new Kx({namespace:f});break;case"solana":this.rpcProviders[r]=new Gx({namespace:f});break;case"cosmos":this.rpcProviders[r]=new Wx({namespace:f});break;case"polkadot":this.rpcProviders[r]=new kx({namespace:f});break;case"cip34":this.rpcProviders[r]=new Jx({namespace:f});break;case"elrond":this.rpcProviders[r]=new Qx({namespace:f});break;case"multiversx":this.rpcProviders[r]=new Yx({namespace:f});break;case"near":this.rpcProviders[r]=new Xx({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const o=s.data;o&&Hf(o)&&this.events.emit("accountsChanged",o.map(Bx))}else if(s.name==="chainChanged"){const o=r.chainId,c=r.event.data,f=ns(o),v=zc(o)!==zc(c)?`${f}:${zc(c)}`:o;this.onChainChanged(v)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:o}=r,c=(s=this.client)==null?void 0:s.session.get(t);this.session=Bc(xo({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Bc(xo({},zf("USER_DISCONNECTED")),{data:t.topic}))}),this.on(mn.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:o}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=t?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(f=>ns(f)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const o=ns(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[o,c]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(c),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Gf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Gf}/${t}`)}}const iP=Ru,sP="wc",oP="ethereum_provider",aP=`${sP}@2:${oP}:`,cP="https://rpc.walletconnect.com/v1/",du=["eth_sendTransaction","personal_sign"],uP=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],pu=["chainChanged","accountsChanged"],lP=["chainChanged","accountsChanged","message","disconnect","connect"];var hP=Object.defineProperty,fP=Object.defineProperties,dP=Object.getOwnPropertyDescriptors,Zf=Object.getOwnPropertySymbols,pP=Object.prototype.hasOwnProperty,gP=Object.prototype.propertyIsEnumerable,ed=(i,t,r)=>t in i?hP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,is=(i,t)=>{for(var r in t||(t={}))pP.call(t,r)&&ed(i,r,t[r]);if(Zf)for(var r of Zf(t))gP.call(t,r)&&ed(i,r,t[r]);return i},td=(i,t)=>fP(i,dP(t));function Lo(i){return Number(i[0].split(":")[1])}function Vc(i){return`0x${i.toString(16)}`}function yP(i){const{chains:t,optionalChains:r,methods:s,optionalMethods:o,events:c,optionalEvents:f,rpcMap:v}=i;if(!Kc(t))throw new Error("Invalid chains");const O={chains:t,methods:s||du,events:c||pu,rpcMap:is({},t.length?{[Lo(t)]:v[Lo(t)]}:{})},g=c?.filter(q=>!pu.includes(q)),w=s?.filter(q=>!du.includes(q));if(!r&&!f&&!o&&!(g!=null&&g.length)&&!(w!=null&&w.length))return{required:t.length?O:void 0};const T=g?.length&&w?.length||!r,A={chains:[...new Set(T?O.chains.concat(r||[]):r)],methods:[...new Set(O.methods.concat(o!=null&&o.length?o:uP))],events:[...new Set(O.events.concat(f!=null&&f.length?f:lP))],rpcMap:v};return{required:t.length?O:void 0,optional:r.length?A:void 0}}class Au{constructor(){this.events=new Cr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=aP,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Au;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=yP(this.rpc);try{const o=await new Promise(async(f,v)=>{var O;this.rpc.showQrModal&&((O=this.modal)==null||O.subscribeModal(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),v(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(td(is({namespaces:is({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t?.pairingTopic})).then(g=>{f(g)}).catch(g=>{v(new Error(g.message))})});if(!o)return;const c=gb(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:Vc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Vc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",td(is({},mb("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Vc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,o]=t.split(":");return{chainId:`${r}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const o=(r=t?.chains)!=null?r:[],c=(s=t?.optionalChains)!=null?s:[],f=o.concat(c);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const v=o.length?t?.methods||du:[],O=o.length?t?.events||pu:[],g=t?.optionalMethods||[],w=t?.optionalEvents||[],T=t?.rpcMap||this.buildRpcMap(f,t.projectId),A=t?.qrModalOptions||void 0;return{chains:o?.map(q=>this.formatChainId(q)),optionalChains:c.map(q=>this.formatChainId(q)),methods:v,events:O,optionalMethods:g,optionalEvents:w,rpcMap:T,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:A,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Lo(this.rpc.chains):Lo(this.rpc.optionalChains),this.signer=await iP.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await Z_(()=>import("./index.a_JM-Yf8.js").then(o=>o.i),__vite__mapDeps([0,1,2]));r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(is({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:o}=t;r&&Kc(r)&&(this.rpc.chains=r.map(c=>this.formatChainId(c)),r.forEach(c=>{this.rpc.rpcMap[c]=o?.[c]||this.getRpcUrl(c)})),s&&Kc(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s?.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=o?.[c]||this.getRpcUrl(c)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${cP}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r?.accounts),this.setAccounts(r?.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const MP=Au;export{MP as EthereumProvider,lP as OPTIONAL_EVENTS,uP as OPTIONAL_METHODS,pu as REQUIRED_EVENTS,du as REQUIRED_METHODS,Au as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["_astro/index.a_JM-Yf8.js","_astro/mint.Rz8Ab1_Y.js","_astro/index.LFf77hJu.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}